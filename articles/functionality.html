<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Basic Functionality ‚Ä¢ eprscope</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Basic Functionality">
<!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eprscope</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.15</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/datasets.html">Package Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/firstSteps.html">First Steps with R Language</a></li>
    <li><a class="dropdown-item" href="../articles/functionality.html">Basic Functionality</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jatanrt/eprscope/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Basic Functionality</h1>
            <h3 data-toc-skip class="subtitle">Processing and Analysis of the Wuster‚Äôs Blue EPR Spectrum</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jatanrt/eprscope/blob/master/vignettes/functionality.Rmd" class="external-link"><code>vignettes/functionality.Rmd</code></a></small>
      <div class="d-none name"><code>functionality.Rmd</code></div>
    </div>

    
    
<p><span class="math inline">\(\require{mhchem}\)</span></p>
<div class="section level2" number="1">
<h2 id="introduction">
<span class="header-section-number">1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <em>Wuster‚Äôs</em> reagent got its name according to <em>C. Wuster</em> who discovered the oxidation products of <em>p</em>-phenylenediamine derivatives <span class="citation">(<a href="#ref-GramppGpda2005">1</a>)</span>. It is a suitable compound to demonstrate the feasibility of Electron paramagnetic resonance (EPR) combined with the <em>in situ</em> electrochemistry/voltammetry because of the one-electron oxidation <span class="citation">(<a href="#ref-PetrAse1996">2</a>)</span>:</p>
<p><span class="math display" id="eq:tmpdoxid">\[\begin{equation}
\small \ce{TMPD &lt;=&gt;[-e^-] TMPD^{.+}}
\tag{1.1}
\end{equation}\]</span></p>
<p>where the <span class="math inline">\(\small \ce{TMPD}\)</span> stands for <em>N,N,N‚Äô,N‚Äô</em>-tetramethyl-<em>p</em>-phenylenediamine (Wuster‚Äôs reagent) abbreviation. The second oxidation step into di-cationic structure (not depicted in Equation <a href="#eq:tmpdoxid">(1.1)</a>) takes place far (<span class="math inline">\(\small \approx (0.5-0.6)\,\mathrm{V}\)</span>) from the first one <span class="citation">(<a href="#ref-Dadpou2018">3</a>)</span>. Therefore, upon the first oxidation step, it changes its state from diamagnetic (not visible by EPR) to paramagnetic (with one unpaired electron) observable by a characteristic EPR spectrum, as shown below. Such change is not only visible by the ‚Äúmagic‚Äù where the nicely structured EPR spectrum rises from the noisy background upon oxidation, however, it is also associated with an exciting color change from almost colorless to violet-blue. Accordingly and unsurprisingly, <strong>the radical cation of <em>N,N,N‚Äô,N‚Äô</em>-tetramethyl-<em>p</em>-phenylenediamine is</strong> described as <strong><em>Wuster‚Äôs</em></strong> <strong>blue</strong>. Such example will demonstrate the main workflow to process and analyse EPR spectra by the <a href="https://jatanrt.github.io/eprscope/">eprscope</a> üì¶ . The <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> was generated electrochemically by potentiostatic electrolysis at 0.308 V (<em>vs</em> Ag-<em>quasiref.</em> electrode) of the corresponding <span class="math inline">\(\small 1\,\mathrm{mM}\)</span> <span class="math inline">\(\small \ce{TMPD}\)</span> solution in <span class="math inline">\(\small 0.3\,\mathrm{M}\,\,\ce{TBAPF6}/\ce{DMSO}\)</span>.</p>
</div>
<div class="section level2" number="2">
<h2 id="drawing-of-molecular-structures">
<span class="header-section-number">2</span> Drawing of Molecular Structures<a class="anchor" aria-label="anchor" href="#drawing-of-molecular-structures"></a>
</h2>
<p>Structure of the investigated compound can be depicted by the <code><a href="../reference/draw_molecule_by_rcdk.html">draw_molecule_by_rcdk()</a></code> based on function coming from <a href="https://cdk-r.github.io/cdkr/" class="external-link">{rcdk}</a> üì¶ (see also <span class="citation">(<a href="#ref-GuhaRrcdk2007">4</a>)</span>) which is an <img src="RcoreLogo.png" width="16" height="12"> toolbox of the <a href="https://cdk.github.io/" class="external-link">Chemistry Development Kit</a>, an open source modular java library for chemoinformatics <span class="citation">(<a href="#ref-WillighagenCDK2017">5</a>)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># radical cation Wuster's Reagent equivalent</span></span>
<span><span class="co"># to N,N,N',N'-tetramethyl-p-phenylenediamine (TMPD) radical cation</span></span>
<span><span class="co"># from 'SMILES' origin on "cob" ("color on black") canvas, without</span></span>
<span><span class="co"># suppressing the hydrogen atoms</span></span>
<span><span class="fu"><a href="../reference/draw_molecule_by_rcdk.html">draw_molecule_by_rcdk</a></span><span class="op">(</span></span>
<span>  molecule <span class="op">=</span> <span class="st">"CN(C)[C+]1C([H])=C([H])[C.]([N](C)C)C([H])=C1[H]"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"smiles"</span>,</span>
<span>  style <span class="op">=</span> <span class="st">"cob"</span>,</span>
<span>  mol.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">TMPD</span><span class="op">^</span><span class="op">+</span><span class="va">.</span> <span class="op">~</span> <span class="st">"("</span> <span class="op">~</span> <span class="va">Wuster</span> <span class="op">*</span> <span class="st">"'"</span> <span class="op">*</span> <span class="va">s</span> <span class="op">~</span> <span class="va">Blue</span> <span class="op">~</span> <span class="st">")"</span><span class="op">)</span>,</span>
<span>  mol.label.color <span class="op">=</span> <span class="st">"yellow"</span>,</span>
<span>  suppressh <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="functionality_files/figure-html/draw-molecule-1.png"><!-- --></p>
<p>This function belongs to the package family/section <code>Visualizations and Graphics</code> and enables to create image of molecular structures either by <a href="https://chem.libretexts.org/Courses/Fordham_University/Chem1102%3A_Drug_Discovery_-_From_the_Laboratory_to_the_Clinic/05%3A_Organic_Molecules/5.08%3A_Line_Notation_(SMILES_and_InChI)" class="external-link">SMILES and SMART codes</a> or by loading a <strong>S</strong>tructure <strong>D</strong>ata <strong>F</strong>ile (<code>.sdf</code>) <span class="citation">(<a href="#ref-Sakari2022">6</a>)</span>.</p>
</div>
<div class="section level2" number="3">
<h2 id="reading-files-and-writing-data-frames">
<span class="header-section-number">3</span> Reading Files and Writing Data Frames<a class="anchor" aria-label="anchor" href="#reading-files-and-writing-data-frames"></a>
</h2>
<p>The <a href="https://jatanrt.github.io/eprscope/">eprscope</a> reads and converts pure (except the <code>.mat</code> format) text files. Therefore, to read the instrumental data files, recorded EPR spectra must be first converted into the ASCII format at the spectrometer. If the conversion option is not available, one can also try a free online converter by <em>Leland B. Gee</em> <span class="citation">(<a href="#ref-xepr2gfac2023">7</a>)</span>. To process the EPR spectral data, it is important not only to read the files with <em>Intensity vs.¬†B</em> (usually in <code>.asc</code>, <code>.txt</code>, <code>.csv</code> format) but also associated files like those containing the instrumental parameters used to record the EPR spectra (usually in <code>.DSC</code> , <code>.dsc</code> or <code>.par</code> format). The information including in these files is required to e.g.¬†normalize the Intensity (like <span class="math inline">\(\small \mathrm{d}I_{\mathrm{EPR}}~/~\mathrm{d}B\)</span> in the derivative spectral form) or to evaluate the <span class="math inline">\(g\)</span>-factor (position of the spectrum) as well as for simulations of the EPR spectra and to evaluate the kinetic parameters of the radical reactions.</p>
<p>Reading of the instrumental parameters from <code>.DSC</code> / <code>.dsc</code> or <code>.par</code> files (corresponding to acquisition software ‚Äúxenon‚Äù/‚Äúmagnetech‚Äù or ‚Äúwinepr‚Äù, respectively) is provided by several functions for different purposes e.g.¬†for kinetic measurements or simulations. The general function <code><a href="../reference/readEPR_params_tabs.html">readEPR_params_tabs()</a></code> summarizes all important parameters in a list of data frames and can be converted into individual interactive tables by <a href="https://rstudio.github.io/DT/" class="external-link">{DT}</a> package ‚û®</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># package built-in example file =&gt; "TMPD_specelchem_accu_b.par"</span></span>
<span><span class="va">tmpd.params.file</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/load_data_example.html">load_data_example</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"TMPD_specelchem_accu_b.par"</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># reading the parameter file coming from "winepr" acquisition softw.</span></span>
<span><span class="va">tmpd.params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readEPR_params_tabs.html">readEPR_params_tabs</a></span><span class="op">(</span></span>
<span>  path_to_dsc_par <span class="op">=</span> <span class="va">tmpd.params.file</span>,</span>
<span>  origin <span class="op">=</span> <span class="st">"winepr"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># the output `tmpd.params` is a list consisting</span></span>
<span><span class="co"># of the "info" data frame (contaning characters)</span></span>
<span><span class="va">tmpd.params</span><span class="op">$</span><span class="va">info</span> <span class="co"># or `tmpd.params[["info"]]`</span></span>
<span><span class="co">#&gt;                 Parameter</span></span>
<span><span class="co">#&gt; 1                Operator</span></span>
<span><span class="co">#&gt; 2                    Date</span></span>
<span><span class="co">#&gt; 3          Recording Time</span></span>
<span><span class="co">#&gt; 4                 Comment</span></span>
<span><span class="co">#&gt; 5        Experiment Title</span></span>
<span><span class="co">#&gt; 6 X Var. (e.g. B/RF) Unit</span></span>
<span><span class="co">#&gt;                                                         Information</span></span>
<span><span class="co">#&gt; 1                                                           Tarabek</span></span>
<span><span class="co">#&gt; 2                                                        08/01/2011</span></span>
<span><span class="co">#&gt; 3                                                             15:15</span></span>
<span><span class="co">#&gt; 4 Q=3500, 1mM solut. tetramethyl phenylene diamine, accu 20 spectra</span></span>
<span><span class="co">#&gt; 5                                                       field-sweep</span></span>
<span><span class="co">#&gt; 6                                                                 G</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># and the second data frame is the "params",</span></span>
<span><span class="co"># containing parameters, their values and units</span></span>
<span><span class="va">tmpd.params</span><span class="op">$</span><span class="va">params</span> <span class="co"># or `tmpd.params[["params"]]`</span></span>
<span><span class="co">#&gt;               Parameter        Value     Unit</span></span>
<span><span class="co">#&gt; 1             Frequency     9.814155      GHz</span></span>
<span><span class="co">#&gt; 2         Central Field  3499.170000        G</span></span>
<span><span class="co">#&gt; 3           Sweep Width   120.000000        G</span></span>
<span><span class="co">#&gt; 4  Modulation Amplitude     0.500000        G</span></span>
<span><span class="co">#&gt; 5       Number of Scans    20.000000 Unitless</span></span>
<span><span class="co">#&gt; 6      Number of Points  2401.000000 Unitless</span></span>
<span><span class="co">#&gt; 7                 Power     5.024000       mW</span></span>
<span><span class="co">#&gt; 8       Conversion Time     0.008000        s</span></span>
<span><span class="co">#&gt; 9            Sweep Time    19.208000        s</span></span>
<span><span class="co">#&gt; 10         Acquire Time   384.160000        s</span></span>
<span><span class="co">#&gt; 11        Time Constant     0.005120        s</span></span>
<span><span class="co">#&gt; 12          Temperature   295.068344        K</span></span>
<span><span class="co">#&gt; 13        Receiver Gain 39905.250000 Unitless</span></span></code></pre></div>
<p>Finally, conversion of the second data frame (<code>tmpd.params$params</code>) can be performed by the <code><a href="../reference/readEPR_params_tabs.html">readEPR_params_tabs()</a></code> function with the argument <code>interact = "params"</code> .</p>
<p>The <code>origin</code> argument in reading functions reflects the differences in ASCII text file structure depending on the acquisition software. Moreover, while the intensity can be automatically normalized upon spectrum recording within ‚Äúxenon‚Äù/‚Äúmagnetech‚Äù software, the ‚Äúwinepr‚Äù intensity has to be normalized after the measurement if one wants to compare the intensities of two or several EPR spectra. The reading of the <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> spectral data by <code><a href="../reference/readEPR_Exp_Specs.html">readEPR_Exp_Specs()</a></code> proceeds as follows with the output having the form of the universal <code>data frame</code> format ‚û®</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># loading package built-in example file =&gt; "TMPD_specelchem_accu_b.asc"</span></span>
<span><span class="va">tmpd.data.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_data_example.html">load_data_example</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"TMPD_specelchem_accu_b.asc"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># intensity is normalized by the Q value (sensitivity factor)</span></span>
<span><span class="co"># and the number of scans (`Nscans`). From the previous </span></span>
<span><span class="co"># parameter/info reading we know: Q = 3500 (in the `info` </span></span>
<span><span class="co"># data frame), Nscans = 20 (from `tmpd.params$params` </span></span>
<span><span class="co"># in the 5th row and the 2nd column)</span></span>
<span><span class="va">tmpd.data.norm.01</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readEPR_Exp_Specs.html">readEPR_Exp_Specs</a></span><span class="op">(</span></span>
<span>  path_to_ASC <span class="op">=</span> <span class="va">tmpd.data.file</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B_G"</span>, <span class="st">"dIepr_over_dB"</span><span class="op">)</span>,</span>
<span>  qValue <span class="op">=</span> <span class="fl">3500</span>,</span>
<span>  norm.vec.add <span class="op">=</span> <span class="va">tmpd.params</span><span class="op">$</span><span class="va">params</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>  origin <span class="op">=</span> <span class="st">"winepr"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview of the first six rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tmpd.data.norm.01</span><span class="op">)</span></span>
<span><span class="co">#&gt;          B_G dIepr_over_dB      B_mT</span></span>
<span><span class="co">#&gt;        &lt;num&gt;         &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 3439.1699 -2.8023680804 343.91699</span></span>
<span><span class="co">#&gt; 2: 3439.2200 -1.5253253348 343.92200</span></span>
<span><span class="co">#&gt; 3: 3439.2700 -1.9261109375 343.92700</span></span>
<span><span class="co">#&gt; 4: 3439.3201  0.0019604213 343.93201</span></span>
<span><span class="co">#&gt; 5: 3439.3701 -4.6310111607 343.93701</span></span>
<span><span class="co">#&gt; 6: 3439.4199 -3.5957537946 343.94199</span></span></code></pre></div>
<p>An arbitrary character string may be chosen for the column name (see <code>col.names</code> argument)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;For such reason, there are arguments &lt;code&gt;x.id&lt;/code&gt; and &lt;code&gt;Intensity.id&lt;/code&gt; , pointing to original table column indices, in order to properly pick up the corresponding variables.&lt;/p&gt;"><sup>1</sup></a>. However, a safe rule of thumb is to use notation like ‚Äúquantity_unit‚Äù as already shown above in the case of magnetic flux density <span class="math inline">\(\small B\)</span>. The name for the intensity column reads <code>dIepr_over_dB</code> (without units) because it reflects the derivative mode <span class="math inline">\(\small \mathrm{d}I_{\mathrm{EPR}}/\mathrm{d}B\)</span> in CW (continuous wave) EPR. Other intensity related column names can be used as well. The above described function <code><a href="../reference/readEPR_Exp_Specs.html">readEPR_Exp_Specs()</a></code> can automatically convert <span class="math inline">\(\small B\)</span> values by the argument <code>convertB.unit=TRUE</code> (or <code>FALSE</code>) depending on the original units ‚ÄúG‚Äù or ‚ÄúmT‚Äù. The reason is, that both units are quite often used to display the EPR spectra as well as to calculate the additional related quantities like <span class="math inline">\(\small \Delta B\)</span>, <span class="math inline">\(g\)</span> or hyperfine splitting constants <span class="math inline">\(a\)</span>. If the <code>Intensity</code> has to be normalized also by additional instrumental parameters, like <em>conversion time</em> and <em>receiver gain</em> (automatically performed within ‚ÄúXenon‚Äù software)<em>,</em> one should use the <code><a href="../reference/quantify_EPR_Norm_const.html">quantify_EPR_Norm_const()</a></code> function from the <code>Evaluations and Quantification</code> family ‚û®</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># calculation of the advanced normalization constant</span></span>
<span><span class="co"># by selected parameters from the parameter list above,</span></span>
<span><span class="co"># these parameters (WinEPR acq. spectrometer software)</span></span>
<span><span class="co"># can be also obtained by the `readEPR_param_slct()`</span></span>
<span><span class="co"># function with the codes described in the corresponding</span></span>
<span><span class="co"># documentation</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># following parameters are required (`req.params`) =&gt;</span></span>
<span><span class="co"># conversion time (RCT) in milliseconds, receiver gain (RRG) </span></span>
<span><span class="co"># unitless, sweep with (HSW) in Gauss, number of points (RES) </span></span>
<span><span class="co"># and number of scans/accumulations (JSD).</span></span>
<span><span class="co">#</span></span>
<span><span class="va">req.params</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/readEPR_param_slct.html">readEPR_param_slct</a></span><span class="op">(</span><span class="va">tmpd.params.file</span>,</span>
<span>    string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RCT"</span>, <span class="st">"RRG"</span>, <span class="st">"HSW"</span>, <span class="st">"RES"</span>, <span class="st">"JSD"</span><span class="op">)</span>,</span>
<span>    origin <span class="op">=</span> <span class="st">"winepr"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="va">adv.norm.constant</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quantify_EPR_Norm_const.html">quantify_EPR_Norm_const</a></span><span class="op">(</span></span>
<span>  conv.time.ms <span class="op">=</span> <span class="va">req.params</span><span class="op">$</span><span class="va">RCT</span>,</span>
<span>  Nscans <span class="op">=</span> <span class="va">req.params</span><span class="op">$</span><span class="va">JSD</span>,</span>
<span>  Npoints <span class="op">=</span> <span class="va">req.params</span><span class="op">$</span><span class="va">RES</span>,</span>
<span>  rg <span class="op">=</span> <span class="va">req.params</span><span class="op">$</span><span class="va">RRG</span>,</span>
<span>  rg.unit <span class="op">=</span> <span class="st">"Unitless"</span>,</span>
<span>  Bsw <span class="op">=</span> <span class="va">req.params</span><span class="op">$</span><span class="va">HSW</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># therefore, the reading of the experimental</span></span>
<span><span class="co"># data file =&gt;</span></span>
<span><span class="va">tmpd.data.norm.02</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readEPR_Exp_Specs.html">readEPR_Exp_Specs</a></span><span class="op">(</span></span>
<span>  path_to_ASC <span class="op">=</span> <span class="va">tmpd.data.file</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B_G"</span>, <span class="st">"dIepr_over_dB"</span><span class="op">)</span>,</span>
<span>  qValue <span class="op">=</span> <span class="fl">3500</span>,</span>
<span>  norm.vec.add <span class="op">=</span> <span class="va">adv.norm.constant</span>,</span>
<span>  origin <span class="op">=</span> <span class="st">"winepr"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># data frame preview</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tmpd.data.norm.02</span><span class="op">)</span></span>
<span><span class="co">#&gt;          B_G  dIepr_over_dB      B_mT</span></span>
<span><span class="co">#&gt;        &lt;num&gt;          &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 3439.1699 -4.3890968e-07 343.91699</span></span>
<span><span class="co">#&gt; 2: 3439.2200 -2.3889797e-07 343.92200</span></span>
<span><span class="co">#&gt; 3: 3439.2700 -3.0166941e-07 343.92700</span></span>
<span><span class="co">#&gt; 4: 3439.3201  3.0704314e-10 343.93201</span></span>
<span><span class="co">#&gt; 5: 3439.3701 -7.2531358e-07 343.93701</span></span>
<span><span class="co">#&gt; 6: 3439.4199 -5.6317054e-07 343.94199</span></span></code></pre></div>
<p>Moreover, the <code>norm.vec.add</code> argument can involve additional normalization quantities like sample weight, concentration, number of scans (if not normalized by the spectrometer)‚Ä¶etc. If needed, all such quantities can be defined at once within the <code>norm.vec.add</code> .</p>
<p>Visualization and/or conversion of data frames (tables) into several formats like <code>.html</code> , <code>.pdf</code> , <code>.docx</code> or <code>.pptx</code>. can be provided by the most used <a href="https://rfortherestofus.com/2019/11/how-to-make-beautiful-tables-in-r/" class="external-link">‚Äútable‚Äù packages</a>. Among them, libraries/packages like <a href="https://rstudio.github.io/DT/" class="external-link">{DT}</a>, <a href="https://davidgohel.github.io/flextable/index.html" class="external-link">{flextable}</a>, <a href="https://gt.rstudio.com/" class="external-link">{gt}</a>, <a href="https://vincentarelbundock.github.io/tinytable/" class="external-link">{tinytable}</a> and <a href="https://haozhu233.github.io/kableExtra/" class="external-link">{kableExtra}</a> (see Section <a href="#hf-structure">5.3</a> below) are often used for publication ready table visualization. The last data frame previewed by the <a href="https://vincentarelbundock.github.io/tinytable/" class="external-link">tinytable</a> is shown in the following example.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># visualization of the first 10 rows by `{tinytable}` </span></span>
<span><span class="fu">tinytable</span><span class="fu">::</span><span class="fu"><a href="https://vincentarelbundock.github.io/tinytable/man/tt.html" class="external-link">tt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tmpd.data.norm.02</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<!-- preamble start -->

    <script>

      function styleCell_rrapy1m2305li10rw6b1(i, j, css_id) {
          var table = document.getElementById("tinytable_rrapy1m2305li10rw6b1");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_rrapy1m2305li10rw6b1(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_rrapy1m2305li10rw6b1");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '10', j: 0 }, { i: '10', j: 1 }, { i: '10', j: 2 },  ], css_id: 'tinytable_css_8oyhm3xhtibg9ckz0265',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 },  ], css_id: 'tinytable_css_pd4bgcwwchv4awz6mnx7',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_rrapy1m2305li10rw6b1(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script><style>
      /* tinytable css entries after */
      .table td.tinytable_css_8oyhm3xhtibg9ckz0265, .table th.tinytable_css_8oyhm3xhtibg9ckz0265 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_pd4bgcwwchv4awz6mnx7, .table th.tinytable_css_pd4bgcwwchv4awz6mnx7 { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
<div class="container">
      <table class="table table table-borderless" id="tinytable_rrapy1m2305li10rw6b1" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
<thead><tr>
<th scope="col" data-row="0" data-col="0">B_G</th>
                <th scope="col" data-row="0" data-col="1">dIepr_over_dB</th>
                <th scope="col" data-row="0" data-col="2">B_mT</th>
              </tr></thead>
<tbody>
<tr>
<td data-row="1" data-col="0">3439.1699</td>
                  <td data-row="1" data-col="1">-4.3890968e-07</td>
                  <td data-row="1" data-col="2">343.91699</td>
                </tr>
<tr>
<td data-row="2" data-col="0">3439.2200</td>
                  <td data-row="2" data-col="1">-2.3889797e-07</td>
                  <td data-row="2" data-col="2">343.92200</td>
                </tr>
<tr>
<td data-row="3" data-col="0">3439.2700</td>
                  <td data-row="3" data-col="1">-3.0166941e-07</td>
                  <td data-row="3" data-col="2">343.92700</td>
                </tr>
<tr>
<td data-row="4" data-col="0">3439.3201</td>
                  <td data-row="4" data-col="1">3.0704314e-10</td>
                  <td data-row="4" data-col="2">343.93201</td>
                </tr>
<tr>
<td data-row="5" data-col="0">3439.3701</td>
                  <td data-row="5" data-col="1">-7.2531358e-07</td>
                  <td data-row="5" data-col="2">343.93701</td>
                </tr>
<tr>
<td data-row="6" data-col="0">3439.4199</td>
                  <td data-row="6" data-col="1">-5.6317054e-07</td>
                  <td data-row="6" data-col="2">343.94199</td>
                </tr>
<tr>
<td data-row="7" data-col="0">3439.4700</td>
                  <td data-row="7" data-col="1">-7.1400107e-07</td>
                  <td data-row="7" data-col="2">343.94700</td>
                </tr>
<tr>
<td data-row="8" data-col="0">3439.5200</td>
                  <td data-row="8" data-col="1">-9.6621681e-07</td>
                  <td data-row="8" data-col="2">343.95200</td>
                </tr>
<tr>
<td data-row="9" data-col="0">3439.5701</td>
                  <td data-row="9" data-col="1">-1.3318550e-07</td>
                  <td data-row="9" data-col="2">343.95701</td>
                </tr>
<tr>
<td data-row="10" data-col="0">3439.6201</td>
                  <td data-row="10" data-col="1">8.6338939e-07</td>
                  <td data-row="10" data-col="2">343.96201</td>
                </tr>
</tbody>
</table>
</div>
<!-- hack to avoid NA insertion in last line -->
<p>In order to process data frames by other software tools, different from <img src="RcoreLogo.png" width="16" height="12"> (e.g.¬†in excel-like sheet format), they might be exported into universal <code>.csv</code> table format like by the <code>base::write.csv()</code> function ‚û®</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">tmpd.data.norm.02</span>,</span>
<span>  file <span class="op">=</span> <span class="st">"TMPD_EPR_Norm_data02.csv"</span>,</span>
<span>  row.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2" number="4">
<h2 id="visualizations-of-spectral-data">
<span class="header-section-number">4</span> Visualizations of Spectral Data<a class="anchor" aria-label="anchor" href="#visualizations-of-spectral-data"></a>
</h2>
<p>All the data related to EPR spectroscopy can be visualized by the <a href="https://ggplot2.tidyverse.org/" class="external-link">{ggplot2}</a> üì¶ and its <a href="https://exts.ggplot2.tidyverse.org/gallery/" class="external-link">extensions</a> as well as by the interactive <a href="https://plotly.com/r/" class="external-link">{plotly}</a> graphing library. While the first library/package (based on the ‚ÄúGrammar of Graphics‚Äù<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;The Grammar of Graphics&lt;/em&gt; is a concept how the graphs/plots are built. It is based on the fact that graphs may consist of several components/layers (e.g.¬†like data layer, geometry layer, aesthetic layer‚Ä¶etc) similarly to processing of a bitmap-image in a photo-editor. The term ‚Äú&lt;em&gt;grammar&lt;/em&gt;‚Äù corresponds to the structure of a sentence in language and thus it may represent a structure of graph/plot in the R programming language.&lt;/p&gt;"><sup>2</sup></a> , see also <span class="citation">(<a href="#ref-WilkinsonGG2005">8</a>)</span>) is one of the most comprehensive system for data visualization, the second one represents a valuable alternative to processing/acquisition software at EPR spectrometers. Namely, it includes tools like zooming, panning, data/values hovering and <a href="https://plotly.com/r/configuration-options/" class="external-link">much more</a>. Combination of both approaches actually represents literally endless possibilities how to visualize the data in electron paramagnetic resonance spectroscopy.</p>
<div class="section level3" number="4.1">
<h3 id="static-plots-by-ggplot2-and-patchwork">
<span class="header-section-number">4.1</span> Static Plots by <code>{ggplot2}</code> and <code>{patchwork}</code><a class="anchor" aria-label="anchor" href="#static-plots-by-ggplot2-and-patchwork"></a>
</h3>
<p>The <code><a href="../reference/plot_EPR_Specs.html">plot_EPR_Specs()</a></code> is the essential function for plotting individual EPR spectra as well as those within series (e.g.¬†time series <span class="math inline">\(\equiv\)</span> kinetic measurements). Now, by means of this function and by the <a href="https://patchwork.data-imaginist.com/" class="external-link">{patchwork}</a> üì¶ , we can compare the EPR spectra with the basic and ‚Äúadvanced‚Äù normalization ‚û®</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># plotting the spectrum with basic normalization,</span></span>
<span><span class="co"># the B-axis can be presented either </span></span>
<span><span class="co"># in "mT" (default) or "G" plot title is added </span></span>
<span><span class="co"># by `ggtitle()` function from `{ggplot2}` package</span></span>
<span><span class="va">tmpd.plot.norm.01</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/plot_EPR_Specs.html">plot_EPR_Specs</a></span><span class="op">(</span>data.spectra <span class="op">=</span> <span class="va">tmpd.data.norm.01</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Basic Normalization"</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="va">tmpd.plot.norm.01</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:spectral-data-norm01-visual"></span>
<img src="functionality_files/figure-html/spectral-data-norm01-visual-1.png" alt="EPR spectrum of $\small \ce{TMPD^{.+}}$ in $\small 0.3\,\mathrm{M}~\ce{TBAPF6}/\ce{DMSO}$ after potentiostatic oxidative electrolysis at $\small 0.308\,\mathrm{V}$ vs Ag-quasiref. Intensity normalized by number of scans, 'Nscans', and by sensitivity Q-factor, 'qValue'."><p class="caption">
Figure 4.1: EPR spectrum of <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> in <span class="math inline">\(\small 0.3\,\mathrm{M}~\ce{TBAPF6}/\ce{DMSO}\)</span> after potentiostatic oxidative electrolysis at <span class="math inline">\(\small 0.308\,\mathrm{V}\)</span> vs Ag-quasiref. Intensity normalized by number of scans, ‚ÄòNscans‚Äô, and by sensitivity Q-factor, ‚ÄòqValue‚Äô.
</p>
</div>
<p>Comparison of both spectra with different normalization ‚û®</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># spectrum with the "advanced" normalization</span></span>
<span><span class="va">tmpd.plot.norm.02</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/plot_EPR_Specs.html">plot_EPR_Specs</a></span><span class="op">(</span>data.spectra <span class="op">=</span> <span class="va">tmpd.data.norm.02</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Advanced Normalization"</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># both spectra together side-by-side by `{patchwork}` package,</span></span>
<span><span class="co"># see https://patchwork.data-imaginist.com/articles/guides/layout.html</span></span>
<span><span class="va">tmpd.plot.norm.0102</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">tmpd.plot.norm.01</span> <span class="op">+</span></span>
<span>  <span class="va">tmpd.plot.norm.02</span> <span class="op">+</span></span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span></span>
<span>    ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    axis_titles <span class="op">=</span> <span class="st">"collect"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview of EPR spectra with different intensities</span></span>
<span><span class="va">tmpd.plot.norm.0102</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:spectral-data-norm0102-visual"></span>
<img src="functionality_files/figure-html/spectral-data-norm0102-visual-1.png" alt="Comparison of $\small \ce{TMPD^{.+}}$ EPR spectra with different intensity normalization."><p class="caption">
Figure 4.2: Comparison of <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> EPR spectra with different intensity normalization.
</p>
</div>
<p>If one wants to save the previous Figure <a href="#fig:spectral-data-norm0102-visual">4.2</a>, the function <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggplot2::ggsave()</a></code> can be applied ‚û®</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># to save the plot `tmpd.plot.norm.0102` with the size</span></span>
<span><span class="co"># of (7 x 5) inches and the resolution of dpi = 200</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"TMPD_EPR_Norm_compar.png"</span>,</span>
<span>  plot <span class="op">=</span> <span class="va">tmpd.plot.norm.0102</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  units <span class="op">=</span> <span class="st">"in"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># other image formats like `.pdf`, `.tex`,`.jpeg`, `.eps`,</span></span>
<span><span class="co"># `.bmp`, `.svg` or `.tiff` can be used as well</span></span></code></pre></div>
</div>
<div class="section level3" number="4.2">
<h3 id="interactive-plots-by-plotly">
<span class="header-section-number">4.2</span> Interactive Plots by <code>{plotly}</code><a class="anchor" aria-label="anchor" href="#interactive-plots-by-plotly"></a>
</h3>
<p>In order to explore the EPR spectrum in details (to read values, zoom or save the spectrum), functions like <code><a href="../reference/plot_EPR_Specs2D_interact.html">plot_EPR_Specs2D_interact()</a></code> or <code><a href="../reference/plot_eval_ExpSim_app.html">plot_eval_ExpSim_app()</a></code> are applied (consult the corresponding examples in the function documentation). Additionally, it can be also used for a series of EPR spectra, in overlay mode, similarly to <code><a href="../reference/plot_EPR_Specs.html">plot_EPR_Specs()</a></code>. Additional interactive 3D-plotting of EPR spectra, especially those recorded as time series, like during kinetic or variable temperature experiments, are provided by the <code><a href="../reference/plot_EPR_Specs3D_interact.html">plot_EPR_Specs3D_interact()</a></code> function.</p>
<p><img src="epr_spectr_interactive.gif" width="654"></p>
</div>
</div>
<div class="section level2" number="5">
<h2 id="basic-epr-spectral-characteristics">
<span class="header-section-number">5</span> Basic EPR Spectral Characteristics<a class="anchor" aria-label="anchor" href="#basic-epr-spectral-characteristics"></a>
</h2>
<p>There are four basic parameters to characterize the EPR spectrum ‚û®</p>
<ol style="list-style-type: decimal">
<li><p>Spectrum position expressed by the <span class="math inline">\(g_{\mathrm{iso}}\)</span>-value</p></li>
<li><p>Linewidth, for derivative line form expressed by the <span class="math inline">\(\small \Delta B_{\mathrm{pp}}\)</span>, that is the difference between <span class="math inline">\(\small B_{\mathrm{max}}\)</span> and <span class="math inline">\(\small B_{\mathrm{min}}\)</span> corresponding to position of maximum and minimum intensity, respectively. For the integrated spectral form, the linewidth is expressed by the <span class="math inline">\(\small FWHM\)</span> (‚Äúfull width at half-maximum‚Äù or ‚Äúfull width at half-height‚Äù).</p></li>
<li><p>Hyperfine splitting, <span class="math inline">\(a\)</span> (in <span class="math inline">\(\mathrm{m \small T}\)</span> or <span class="math inline">\(\small \mathrm{G}\)</span>) which is the distance between the individual lines corresponding to interaction of the unpaired electron with the group of surrounding equivalent nuclei.</p></li>
<li><p>Single or double integral depending on the original spectral line form ‚û® either integrated or derivative. This is directly proportional to the number of paramagnetic species/radicals.</p></li>
</ol>
<div class="section level3" number="5.1">
<h3 id="finding-the-giso-value">
<span class="header-section-number">5.1</span> Finding the <em>g</em><sub>iso</sub>-Value<a class="anchor" aria-label="anchor" href="#finding-the-giso-value"></a>
</h3>
<p>The parameter is defined by the following Equation <a href="#eq:gfactor">(5.1)</a>:</p>
<p><span class="math display" id="eq:gfactor">\[\begin{equation}
\small g_{\mathrm{iso}} = \frac{h\,\nu}{\mu_{\mathrm{B}}\,B_0}
\tag{5.1}
\end{equation}\]</span></p>
<p>where the <span class="math inline">\(h\)</span> and <span class="math inline">\(\mu_{\mathrm{B}}\)</span> are Plank‚Äôs and Bohr magneton constants, respectively. Therefore, it is determined only by the microwave frequency (<span class="math inline">\(\nu\)</span>) and the magnetic flux density (<span class="math inline">\(\small B_0\)</span>) of the spectrum mid-point where <span class="math inline">\(\small \mathrm{d}I_{\mathrm{EPR}}/\mathrm{d}B = 0\)</span> (in the case of CW EPR spectra, see also function <code><a href="../reference/eval_gFactor_Spec.html">eval_gFactor_Spec()</a></code>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># reading the microwave frequency ("MF") from the `.par` file</span></span>
<span><span class="va">tmpd.mw.freq</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/readEPR_param_slct.html">readEPR_param_slct</a></span><span class="op">(</span><span class="va">tmpd.params.file</span>,</span>
<span>    string <span class="op">=</span> <span class="st">"MF"</span>,</span>
<span>    origin <span class="op">=</span> <span class="st">"winepr"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># B region (349.677, 350.457) mT, including </span></span>
<span><span class="co"># the B mid-point, to calculate the g-value, </span></span>
<span><span class="co"># is obtained from the interactive plot above</span></span>
<span><span class="va">tmpd.g.iso.spec</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/eval_gFactor_Spec.html">eval_gFactor_Spec</a></span><span class="op">(</span><span class="va">tmpd.data.norm.02</span>,</span>
<span>    nu.GHz <span class="op">=</span> <span class="va">tmpd.mw.freq</span>,</span>
<span>    B <span class="op">=</span> <span class="st">"B_mT"</span>,</span>
<span>    B.unit <span class="op">=</span> <span class="st">"mT"</span>,</span>
<span>    Blim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">349.677</span>, <span class="fl">350.457</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># value preview</span></span>
<span><span class="va">tmpd.g.iso.spec</span></span>
<span><span class="co">#&gt; [1] 2.00304</span></span></code></pre></div>
<p>Function <code><a href="../reference/plot_eval_ExpSim_app.html">plot_eval_ExpSim_app()</a></code> represents an alternative way how to figure out the <em>g</em>-value. Within a simple UI (<strong>u</strong>ser <strong>i</strong>nterface), based on <a href="https://shiny.posit.co/r/gallery/" class="external-link"><em>R</em> Shiny</a>, one can interactively display the EPR spectrum as well as its corresponding instrumental parameters. If the <strong>‚ÄúMicrowave frequency (GHz)‚Äù</strong> is available (the function automatically reads the right frequency by loading the ‚Äúparameter‚Äù file with <code>.par</code> or <code>.dsc</code>/ <code>.DSC</code> extensions), by activating the <strong>‚ÄúShow g-Values‚Äù</strong>. Immediately after that, the EPR spectrum abscissa is automatically converted from <em>B</em> into <em>g</em> (see Figure <a href="#fig:g-value-shiny-app">5.1</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:g-value-shiny-app"></span>
<img src="TMPD_EPR_gVal_interact_App.png" alt="Screenshot of the interactive Shiny app, showing how to display g-values for the $\small \ce{TMPD^{.+}}$ EPR spectrum." width="648"><p class="caption">
Figure 5.1: Screenshot of the interactive Shiny app, showing how to display g-values for the <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> EPR spectrum.
</p>
</div>
<p>The above (from the EPR spectrum)-obtained <span class="math inline">\(g_{\mathrm{iso}}\)</span>-value may be compared with that computed by the Density Functional Theory (DFT) quantum chemical calculations of <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span>, namely by PBE0/EPR-II/CPCM-DMSO//B3LYP/6-31+G(d,p) (see also <a href="https://gaussian.com/dft/" class="external-link">Gaussian DFT Methods</a> and <a href="https://gaussian.com/basissets/" class="external-link">Basis Sets</a>). The extraction of <span class="math inline">\(g_{\mathrm{iso}}\)</span>-value from the <em>Gaussian</em> (or from the <a href="https://www.orcasoftware.de/tutorials_orca/index.html" class="external-link">ORCA quantum chemical package</a>) output file is provided by the ‚Äú<code><a href="../reference/eval_gFactor_QCHcomp.html">eval_gFactor_QCHcomp()</a></code> function ‚û®</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># package built-in example file =&gt; </span></span>
<span><span class="co"># "TMPDAradCatEPRa.inp.log.zip"</span></span>
<span><span class="co"># which is a `.zip` of the Gaussian output file</span></span>
<span><span class="va">gauss.tmpd.load</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/load_data_example.html">load_data_example</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"TMPDAradCatEPRa.inp.log.zip"</span><span class="op">)</span></span>
<span><span class="va">gauss.tmpd.output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">gauss.tmpd.load</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># giso-value is automatically calculated as the mean</span></span>
<span><span class="co"># of its principal components (g1,g2,g3) </span></span>
<span><span class="co"># summarized in the output file</span></span>
<span><span class="va">tmpd.g.iso.dft</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/eval_gFactor_QCHcomp.html">eval_gFactor_QCHcomp</a></span><span class="op">(</span><span class="va">gauss.tmpd.output</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="va">tmpd.g.iso.dft</span></span>
<span><span class="co">#&gt; [1] 2.00317</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># comparison of both theoretical and experimental g-values</span></span>
<span><span class="co"># within the tolerance of 1e-3, to illustrate the automatic</span></span>
<span><span class="co"># comparison of two values in R language, the function </span></span>
<span><span class="co"># `all.equal()`can be applied</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">tmpd.g.iso.spec</span>, <span class="va">tmpd.g.iso.dft</span>, tolerance <span class="op">=</span> <span class="fl">1e-3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>The <code>TRUE</code> value represents a perfect agreement between the theoretically (<code>2.00317</code>) and the experimentally (<code>2.00304</code>) determined <span class="math inline">\(g_{\mathrm{iso}}\)</span>-values, thus supporting the structure of <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span>. Its difference from the free electron <span class="math inline">\(g_{\mathrm{e}}\approx \small 2.00232\)</span> is a consequence of <a href="https://chem.libretexts.org/Bookshelves/Physical_and_Theoretical_Chemistry_Textbook_Maps/Electron_Paramagnetic_Resonance_(Jenschke)/03%3A_Electron_Zeeman_Interaction/3.01%3A_Physical_origin_of_the_(g)_shift" class="external-link">spin-orbit coupling (SOC)</a> of the unpaired electron within the radical cation. Namely, it tells how the individual atomic orbitals contribute to single occupied molecular orbital (SOMO), i.e.¬†the orbital characterizing the unpaired electronic state. Therefore, for <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> the SOC is not so pronounced because of the small difference from <span class="math inline">\(g_{\mathrm{e}}\)</span>. However, for heavy atoms (e.g.¬†central atoms in metal complexes) the difference is often large and indicates larger SOC than for organic radicals like for the one mentioned above <span class="citation">(<a href="#ref-Weilepr2007">9</a>)</span>.</p>
</div>
<div class="section level3" number="5.2">
<h3 id="linewidth-ùö´bpp-determination">
<span class="header-section-number">5.2</span> Linewidth, ùö´<em>B</em><sub>pp</sub> Determination<a class="anchor" aria-label="anchor" href="#linewidth-%F0%9D%9A%ABbpp-determination"></a>
</h3>
<p>The linewidth in <span class="math inline">\(\mathrm{m\small T}\)</span> can be determined from several spectral lines/regions from the interactive plots above and by the <code><a href="../reference/eval_DeltaXpp_Spec.html">eval_DeltaXpp_Spec()</a></code> function ‚û®</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># calculate Delta Bpp from several regions</span></span>
<span><span class="co"># =&gt; list of three selected elements/regions</span></span>
<span><span class="va">B.regions.mT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">349.677</span>, <span class="fl">349.977</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">349.177</span>, <span class="fl">349.492</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">350.822</span>, <span class="fl">351.072</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># all Delta Bpp as vector, created by the iteration </span></span>
<span><span class="co"># through all elements (with the help of </span></span>
<span><span class="co"># the `sapply()` function) of `B.regions.mT`</span></span>
<span><span class="va">tmpd.delta.Bpp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>  <span class="va">B.regions.mT</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/eval_DeltaXpp_Spec.html">eval_DeltaXpp_Spec</a></span><span class="op">(</span><span class="va">tmpd.data.norm.02</span>,</span>
<span>      xlim <span class="op">=</span> <span class="va">b</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># mean value of all three linewidths in mT</span></span>
<span><span class="va">tmpd.delta.Bpp.mean</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tmpd.delta.Bpp</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># value preview</span></span>
<span><span class="va">tmpd.delta.Bpp.mean</span></span>
<span><span class="co">#&gt; [1] 0.05</span></span></code></pre></div>
</div>
<div class="section level3" number="5.3">
<h3 id="hf-structure">
<span class="header-section-number">5.3</span> Hyperfine (HF) Structure and Simulations<a class="anchor" aria-label="anchor" href="#hf-structure"></a>
</h3>
<p>The <strong>HF</strong> structure represents one of the most important characteristic of EPR spectra because it reflects the distribution of unpaired electron density within the radical/paramagnetic molecule. At least some of the hyperfine splitting constants (<span class="math inline">\(a\)</span>, HFSCs, distance between the main lines within the pattern) may be estimated from the interactive EPR spectrum above. For the subsequent simulation of the EPR spectrum these are simply converted by the <code><a href="../reference/convert_a_mT_2A.html">convert_a_mT_2A()</a></code> into hyperfine coupling constants in <span class="math inline">\(\mathrm{\small{MH}z}\)</span> (<span class="math inline">\(\small A\)</span>, HFCCs) using the following relation (Equation <a href="#eq:hfatoA">(5.2)</a>) ‚û®</p>
<p><span class="math display" id="eq:hfatoA">\[\begin{equation}
\small A = \frac{a\,g\,\mu_{\mathrm{B}}}{h}
\tag{5.2}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># two visible distances or HFSCs (a in mT)</span></span>
<span><span class="co"># from the interactive EPR spectrum above</span></span>
<span><span class="va">a1.guess.mT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">350.042</span> <span class="op">-</span> <span class="fl">349.342</span><span class="op">)</span></span>
<span><span class="va">a2.guess.mT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">349.147</span> <span class="op">-</span> <span class="fl">349.342</span><span class="op">)</span></span>
<span><span class="co"># both values into vector</span></span>
<span><span class="va">a.guess.mT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a1.guess.mT</span>, <span class="va">a2.guess.mT</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># conversion into A (in MHz) incl. g.iso value</span></span>
<span><span class="co"># (`tmpd.g.iso.spec`) from the calculation above</span></span>
<span><span class="va">A.guess.MHz</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>    <span class="va">a.guess.mT</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="../reference/convert_a_mT_2A.html">convert_a_mT_2A</a></span><span class="op">(</span></span>
<span>        a.mT <span class="op">=</span> <span class="va">x</span>,</span>
<span>        g.val <span class="op">=</span> <span class="va">tmpd.g.iso.spec</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># `A.guess.MHz` preview</span></span>
<span><span class="va">A.guess.MHz</span></span>
<span><span class="co">#&gt; [1] 19.62  5.47</span></span></code></pre></div>
<p>According to literature <span class="citation">(<a href="#ref-GramppGpda2005">1</a>)</span> and the <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> structure (see also Figure <a href="#fig:dft-tmpd-structure">5.2</a> with the DFT-optimized geometry), one can recognize three interacting groups of equivalent nuclei : <span class="math inline">\(\small 2\,\times\,\ce{^{14}N}\)</span>, <span class="math inline">\(\small 4\,\times\,\ce{^1H}\)</span> (aromatic protons) and <span class="math inline">\(\small 12\,\times\,\ce{^1H}\)</span> (methyl protons). DFT calculations may provide all <span class="math inline">\(\small A\)</span> (HFCCs) as shown below.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dft-tmpd-structure"></span>
<img src="TMPD_EPR_DFT_radCat_ab.png" alt="DFT optimized structure of TMPD radical cation with atom numbering inherited from the Gaussian 16 output file." width="691"><p class="caption">
Figure 5.2: DFT optimized structure of TMPD radical cation with atom numbering inherited from the Gaussian 16 output file.
</p>
</div>
<p>In order to compare the theoretical and experimental HFCCs, the function <code><a href="../reference/rearrange_aAiso_QCHorgau.html">rearrange_aAiso_QCHorgau()</a></code> extracts the <span class="math inline">\(\small A\)</span> values from the Gaussian or <a href="https://www.orcasoftware.de/tutorials_orca/index.html" class="external-link">ORCA</a> output files and calculates the mean values corresponding to selected groups of equivalent nuclei which are defined by the <code>nuclei.list.slct</code> argument. Therefore, according to numbering shown in Figure <a href="#fig:dft-tmpd-structure">5.2</a> ‚û®</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># The same package built-in example file </span></span>
<span><span class="co"># (`TMPDAradCatEPRa.inp.log.zip`)</span></span>
<span><span class="co"># as for the extraction of g-values is (see above).</span></span>
<span><span class="va">symmetry.As.df</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/rearrange_aAiso_QCHorgau.html">rearrange_aAiso_QCHorgau</a></span><span class="op">(</span><span class="va">gauss.tmpd.output</span>,</span>
<span>    N.nuclei <span class="op">=</span> <span class="fl">28</span>,</span>
<span>    nuclei.list.slct <span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span>, <span class="co"># 2 x 14N</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span><span class="op">)</span>, <span class="co"># 4 x 1H (aromatic)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>          <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>,</span>
<span>          <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">23</span>, <span class="fl">24</span>,</span>
<span>          <span class="fl">25</span>, <span class="fl">26</span>, <span class="fl">27</span>, <span class="fl">28</span></span>
<span>      <span class="op">)</span> <span class="co"># 12 x 1H (methyls)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># data frame presentation by `{kableExtra}` package</span></span>
<span><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span><span class="va">symmetry.As.df</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span></span>
<span>    bootstrap_options <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"striped"</span>,</span>
<span>        <span class="st">"hover"</span>,</span>
<span>        <span class="st">"condensed"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
NuclearGroup
</th>
<th style="text-align:right;">
Aiso_MHz_QCH
</th>
<th style="text-align:right;">
aiso_mT_QCH
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
12 x 1H (17,18,19,20,21,22,23,24,25,26,27,28)
</td>
<td style="text-align:right;">
20.25
</td>
<td style="text-align:right;">
0.72
</td>
</tr>
<tr>
<td style="text-align:left;">
2 x 14N (7,8)
</td>
<td style="text-align:right;">
17.52
</td>
<td style="text-align:right;">
0.63
</td>
</tr>
<tr>
<td style="text-align:left;">
4 x 1H (13,14,15,16)
</td>
<td style="text-align:right;">
5.24
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
</tbody>
</table>
<p>The previous analysis reveals that the highest HF-coupling/splitting constants are related to the interaction of unpaired electron with the nitrogen and methyl-proton nuclei. Therefore the highest spin density is located on the ‚Äúperiphery‚Äù of the <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> molecule. This may be also supported by the simulation (theoretical calculation) of the EPR spectrum (which is computed by the <code><a href="../reference/eval_sim_EPR_iso.html">eval_sim_EPR_iso()</a></code> function), taking into account the following parameters ‚û®</p>
<ul>
<li><p>position of the EPR spectrum (<span class="math inline">\(g_{\mathrm{iso}}\)</span>-value) ‚û® <code>g.iso</code></p></li>
<li><p>spectral linewidth corresponding to Gaussian and/or Lorentzian lineshape ‚û® <code>lineGL.DeltaB</code></p></li>
<li><p>content of the Gaussian lineshape in the overall linear combination of both Gaussian and Lorenztian theoretical spectral forms (so called pseudo-Voigt lineshape) ‚û® <code>lineG.content</code></p></li>
<li><p>additional instrumental parameters like central field ‚û® <code>Bcf</code>, sweep width ‚û® <code>Bsw</code>, microwave frequency ‚û® <code>mwGHz</code> and number of points (spectral resolution) ‚û® <code>Npoints</code>.</p></li>
</ul>
<p>Required arguments of the <code><a href="../reference/eval_sim_EPR_iso.html">eval_sim_EPR_iso()</a></code> function are presented after the arrows. The estimated linewidth <code>tmpd.delta.Bpp.mean</code> (<span class="math inline">\(\small 0.5\,\mathrm{G}\)</span>, see above) as well as the HFCCs, either directly taken from the spectrum (<code>A.guess.MHz</code>) or from the quantum chemical calculations (<code>symmetry.As.df</code>) and/or from the literature <span class="citation">(<a href="#ref-GramppGpda2005">1</a>)</span>, can be used to simulate the EPR spectrum of <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> as follows ‚û®</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># isotropic simulation of the TMPD radical cation where</span></span>
<span><span class="co"># the instrumental parameters are taken from </span></span>
<span><span class="co"># the corresponding `.par` file: `tmpd.params.file` :</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span> <span class="co"># time (in s) reserved for the simulation processing</span></span>
<span><span class="va">sim.tmpd.iso</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/eval_sim_EPR_iso.html">eval_sim_EPR_iso</a></span><span class="op">(</span></span>
<span>    g.iso <span class="op">=</span> <span class="va">tmpd.g.iso.spec</span>,</span>
<span>    instrum.params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    path_to_dsc_par <span class="op">=</span> <span class="va">tmpd.params.file</span>,</span>
<span>    origin <span class="op">=</span> <span class="st">"winepr"</span>,</span>
<span>    B.unit <span class="op">=</span> <span class="st">"mT"</span>,</span>
<span>    nuclear.system <span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"14N"</span>, <span class="fl">2</span>, <span class="fl">18.6</span><span class="op">)</span>, <span class="co"># A(2 x 14N) = 18.6 MHz</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"1H"</span>, <span class="fl">4</span>, <span class="fl">5.5</span><span class="op">)</span>, <span class="co"># A(4 x 1H) = 5.5 MHz</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"1H"</span>, <span class="fl">12</span>, <span class="fl">19.6</span><span class="op">)</span> <span class="co"># A(12 x 1H) = 19.6 MHz</span></span>
<span>      <span class="op">)</span>, </span>
<span>    <span class="co"># Gauss (G) &amp; Lorentz (L) linewidth (mT):</span></span>
<span>    lineGL.DeltaB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>    <span class="co"># pseudo-Voigt line shape with 0.5 G + 0.5 L:</span></span>
<span>    lineG.content <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.102   0.000   0.101</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># output is either interactive spectrum plot</span></span>
<span><span class="co"># or list of plot and the simulated </span></span>
<span><span class="co"># spectrum data frame.</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># data frame preview</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim.tmpd.iso</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Bsim_G Bsim_mT   Bsim_T dIeprSim_over_dB</span></span>
<span><span class="co">#&gt; 1 3439.17 343.917 0.343917    9.6281321e-07</span></span>
<span><span class="co">#&gt; 2 3439.22 343.922 0.343922    9.6721842e-07</span></span>
<span><span class="co">#&gt; 3 3439.27 343.927 0.343927    9.7169711e-07</span></span>
<span><span class="co">#&gt; 4 3439.32 343.932 0.343932    9.7625349e-07</span></span>
<span><span class="co">#&gt; 5 3439.37 343.937 0.343937    9.8089217e-07</span></span>
<span><span class="co">#&gt; 6 3439.42 343.942 0.343942    9.8561824e-07</span></span></code></pre></div>
<p>Afterwards, the simulated EPR spectrum can be presented/compared with the experimental one by the <code><a href="../reference/present_EPR_Sim_Spec.html">present_EPR_Sim_Spec()</a></code> function (Figure <a href="#fig:tmpd-radcat-sim-expr-compar">5.3</a>), which is essentially based on <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> package and therefore can be combined with the <a href="https://ggplot2.tidyverse.org/reference/index.html" class="external-link">additional {ggplot2} functions</a> . Such simulation of the <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> EPR spectrum can be also performed by an interactive manner using the above-mentioned <code><a href="../reference/plot_eval_ExpSim_app.html">plot_eval_ExpSim_app()</a></code> . One can ‚Äúplay‚Äù with all the simulation parameters defined above and the simulated EPR spectrum is instantaneously updated and compared with the experimental one like depicted on Figure <a href="#fig:simulation-shiny-app">5.4</a>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># intesinty of the simulated spectrum</span></span>
<span><span class="co"># is automatically scalled onto </span></span>
<span><span class="co"># the experimental one.</span></span>
<span><span class="fu"><a href="../reference/present_EPR_Sim_Spec.html">present_EPR_Sim_Spec</a></span><span class="op">(</span></span>
<span>  data.spectr.expr <span class="op">=</span> <span class="va">tmpd.data.norm.02</span>,</span>
<span>  data.spectr.sim <span class="op">=</span> <span class="va">sim.tmpd.iso</span><span class="op">$</span><span class="va">df</span>,</span>
<span>  B.unit <span class="op">=</span> <span class="st">"mT"</span>,</span>
<span>  Blim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">345</span>,<span class="fl">355</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># `plot_theme_NoY_ticks` theme from `{eprscope}`</span></span>
<span>  <span class="fu"><a href="../reference/plot_theme_NoY_ticks.html">plot_theme_NoY_ticks</a></span><span class="op">(</span>legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:tmpd-radcat-sim-expr-compar"></span>
<img src="functionality_files/figure-html/tmpd-radcat-sim-expr-compar-1.png" alt="Comparison of simulated and experiental EPR spectrum of $\small \ce{TMPD^{.+}}$."><p class="caption">
Figure 5.3: Comparison of simulated and experiental EPR spectrum of <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span>.
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:simulation-shiny-app"></span>
<img src="TMPD_EPR_Sim_interact_App.png" alt="Screenshot of the Shiny app, showing an interactive simulation of the $\small \ce{TMPD^{.+}}$ EPR spectrum." width="651"><p class="caption">
Figure 5.4: Screenshot of the Shiny app, showing an interactive simulation of the <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> EPR spectrum.
</p>
</div>
<p>Even though the simulated <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> EPR spectrum is quite close to the experimental one, there are still some apparent differences. Therefore, the fitting/optimization functions like <code><a href="../reference/eval_sim_EPR_isoFit.html">eval_sim_EPR_isoFit()</a></code> and/or <code><a href="../reference/eval_sim_EPR_isoFit_space.html">eval_sim_EPR_isoFit_space()</a></code> can be applied to get a more accurate simulated spectrum. Particularly, the latter can explore a broad range of initial simulation parameters in order to fit and analyze an isotropic EPR spectrum, like the <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> one, described in the following example.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># runnig parallel processing </span></span>
<span><span class="co"># to fit the EPR spectrum of the TMPD </span></span>
<span><span class="co"># radical cation + zoom the spectrum output </span></span>
<span><span class="co"># by `Blim` argument, refer to the documentation </span></span>
<span><span class="co"># of `eval-sim_EPR_isoFit_space`</span></span>
<span><span class="va">tmpd.epr.iso.fit</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/eval_sim_EPR_isoFit_space.html">eval_sim_EPR_isoFit_space</a></span><span class="op">(</span></span>
<span>    data.spectr.expr <span class="op">=</span> <span class="va">tmpd.data.norm.01</span>,</span>
<span>    nu.GHz <span class="op">=</span> <span class="va">tmpd.params</span><span class="op">$</span><span class="va">params</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>    nuclear.system.noA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"14N"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># 2 x 14N</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"1H"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="co"># 4 x 1H</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"1H"</span>, <span class="fl">12</span><span class="op">)</span> <span class="co"># 12 x 1H</span></span>
<span>    <span class="op">)</span>,</span>
<span>    optim.params.init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fl">2.0030</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0</span>, </span>
<span>      <span class="fl">1.25e4</span>, <span class="fl">20.0</span>, <span class="fl">5.5</span>, <span class="fl">19</span></span>
<span>    <span class="op">)</span>,</span>
<span>    optim.params.init.dvary <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0002</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0</span>,</span>
<span>        <span class="fl">2e3</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="co"># or NULL</span></span>
<span>    <span class="co"># Nmax.evals = 256, </span></span>
<span>    <span class="co"># default number of evaluations:</span></span>
<span>    <span class="co"># N.points.space = 16,</span></span>
<span>    <span class="co"># total number of iterations: 256 x 16 = 4096</span></span>
<span>    lineG.content <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>    lineG.content.dvary <span class="op">=</span> <span class="fl">0.15</span>,<span class="co"># or NULL</span></span>
<span>    <span class="co"># optim.method = "neldermead",</span></span>
<span>    processing <span class="op">=</span> <span class="st">"parallel"</span>,<span class="co"># or "sequential"</span></span>
<span>    Blim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3455</span>,<span class="fl">3545</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span></code></pre></div>
<p>Such processing (with the elapsed time of <span class="math inline">\(\approx 220\,\mathrm{s}\)</span> on 10-years old 4-core-CPU/16GB-RAM workstation/running on two cores) will not only return the above-defined list (<code>tmpd.epr.iso.fit</code> , see also documentation of the <code><a href="../reference/eval_sim_EPR_isoFit_space.html">eval_sim_EPR_isoFit_space()</a></code>), however also an animation, showing the progress of simulated EPR spectrum fit at each <code>Evaluation</code> :</p>
<p><img src="TMPD_fitting_of_sim_EPR.gif" width="640"></p>
<p>Animation corresponds to the following optimization of EPR simulation parameters:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">tmpd.epr.iso.fit</span><span class="op">$</span><span class="va">plot.optim.space</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># the best `lineG.content` parameter:</span></span>
<span><span class="va">tmpd.epr.iso.fit</span><span class="op">$</span><span class="va">best.lineG.content</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tmpd-isoFit-space-params-plot"></span>
<img src="TMPD_fitting_of_sim_EPR_plot.png" alt="Progress of the EPR simulation parameter optimization for the $\small \ce{TMPD^{.+}}$ experimental spectrum, corresponding to above-depicted animation." width="98%"><p class="caption">
Figure 5.5: Progress of the EPR simulation parameter optimization for the <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> experimental spectrum, corresponding to above-depicted animation.
</p>
</div>
<p>Gaussian-line content, corresponding to RSS minimum: 0.27</p>
</div>
<div class="section level3" number="5.4">
<h3 id="integration-of-the-epr-spectrum">
<span class="header-section-number">5.4</span> Integration of the EPR Spectrum<a class="anchor" aria-label="anchor" href="#integration-of-the-epr-spectrum"></a>
</h3>
<p>Integration process in the analysis of EPR spectra is undoubtedly an important operation because it mirrors the amount of paramagnetic centers/radicals within the sample (see also <code><a href="../reference/quantify_EPR_Abs.html">quantify_EPR_Abs()</a></code>). However, it is heavily dependent on the initial form of the EPR spectrum, i.e.¬†whether it is present either in derivative (usually in CW EPR) or already integrated (usually in 1D pulsed EPR) form/shape. Hence, the spectrum has to be integrated either twice or only once, respectively. The core-function used for the integration is based on the cumulative trapezoidal approximation, available from the <a href="https://github.com/cran/pracma" class="external-link">{pracma}</a> üì¶ <code><a href="https://rdrr.io/pkg/pracma/man/trapz.html" class="external-link">pracma::cumtrapz()</a></code> <span class="citation">(<a href="#ref-Rpracma2023">10</a>‚Äì<a href="#ref-epperson2013intro">13</a>)</span>.</p>
<p>The relative error of the cumulative trapezoidal integration is minimal, usually falling into the range of <span class="math inline">\(\small \langle 1-5\rangle\,\%\)</span> or even lower depending on the spectrum resolution <span class="citation">(<a href="#ref-LibreMath2023">11</a>, <a href="#ref-epperson2013intro">13</a>)</span>. If the initial EPR spectrum displays low signal-to-noise ratio, the integral required for the quantitative analysis looses its sigmoid-shape ( see below an example of such shape). Therefore, in such case, the best option is to simulate the EPR spectrum and to evaluate the integral from that spectrum (see e.g.¬†the <code><a href="../reference/quantify_EPR_Sim_series.html">quantify_EPR_Sim_series()</a></code> function). The big advantage of this method consists in graphical representation of the corresponding integrals, i.e.¬†the integration process may be visually controlled in the same manner like within the EPR spectrometer acquisitions/processing software (see also the <code><a href="../reference/plot_EPR_Specs_integ.html">plot_EPR_Specs_integ()</a></code> function below). The integration of the EPR spectral data is essentially provided by the <code><a href="../reference/eval_integ_EPR_Spec.html">eval_integ_EPR_Spec()</a></code> and its application to the experimental <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> spectrum is documented by the following scripts ‚û®</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># basic integration without baseline correction</span></span>
<span><span class="co"># during the first integration.</span></span>
<span><span class="va">tmpd.data.norm.02.integ</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/eval_integ_EPR_Spec.html">eval_integ_EPR_Spec</a></span><span class="op">(</span></span>
<span>    data.spectr <span class="op">=</span> <span class="va">tmpd.data.norm.02</span>,</span>
<span>    B <span class="op">=</span> <span class="st">"B_mT"</span>,</span>
<span>    B.unit <span class="op">=</span> <span class="st">"mT"</span>,</span>
<span>    sigmoid.integ <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># integration returns the original data frame</span></span>
<span><span class="co"># with the additional integrals </span></span>
<span><span class="co"># `single_Integ` + `sigmoid_Integ`</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tmpd.data.norm.02.integ</span><span class="op">)</span></span>
<span><span class="co">#&gt;          B_G  dIepr_over_dB      B_mT  single_Integ sigmoid_Integ</span></span>
<span><span class="co">#&gt;        &lt;num&gt;          &lt;num&gt;     &lt;num&gt;         &lt;num&gt;         &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 3439.1699 -4.3890968e-07 343.91699 2.0128171e-06 0.0000000e+00</span></span>
<span><span class="co">#&gt; 2: 3439.2200 -2.3889797e-07 343.92200 1.9958553e-06 1.0031502e-07</span></span>
<span><span class="co">#&gt; 3: 3439.2700 -3.0166941e-07 343.92700 1.9823278e-06 1.9986707e-07</span></span>
<span><span class="co">#&gt; 4: 3439.3201  3.0704314e-10 343.93201 1.9747866e-06 2.9888990e-07</span></span>
<span><span class="co">#&gt; 5: 3439.3701 -7.2531358e-07 343.93701 1.9566436e-06 3.9727197e-07</span></span>
<span><span class="co">#&gt; 6: 3439.4199 -5.6317054e-07 343.94199 1.9245572e-06 4.9392357e-07</span></span></code></pre></div>
<p>Both integrals, within the entire <span class="math inline">\(\small B\)</span>-range, can be visualized by the <code><a href="../reference/plot_EPR_Specs_integ.html">plot_EPR_Specs_integ()</a></code> function from <code>Visualization and Graphics</code> family:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># both integrals are presented separately</span></span>
<span><span class="co"># with their corresponding intensities automatically</span></span>
<span><span class="co"># scaled onto the `y`-axis (defined by "free_y")</span></span>
<span><span class="fu"><a href="../reference/plot_EPR_Specs_integ.html">plot_EPR_Specs_integ</a></span><span class="op">(</span></span>
<span>  <span class="va">tmpd.data.norm.02.integ</span>,</span>
<span>  slct.integs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"single_Integ"</span>,</span>
<span>    <span class="st">"sigmoid_Integ"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  B <span class="op">=</span> <span class="st">"B_mT"</span>,</span>
<span>  B.unit <span class="op">=</span> <span class="st">"mT"</span>,</span>
<span>  separate.integs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  separate.integ.scales <span class="op">=</span> <span class="st">"free_y"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:tmpd-basic-epr-integ-visual"></span>
<img src="functionality_files/figure-html/tmpd-basic-epr-integ-visual-1.png" alt="Single (`single_Integ`) and double (`sigmoid_Integ`) integrated EPR spectrum of $\small \ce{TMPD^{.+}}$."><p class="caption">
Figure 5.6: Single (<code>single_Integ</code>) and double (<code>sigmoid_Integ</code>) integrated EPR spectrum of <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span>.
</p>
</div>
<p>Obviously, the baseline of the single and double integrated <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> EPR spectrum is somewhat distorted and must be corrected. To fix the baseline distortion, the <code><a href="../reference/eval_integ_EPR_Spec.html">eval_integ_EPR_Spec()</a></code> function contains corresponding arguments which control the baseline approximation, under the complex peak, by a polynomial fit and provide its subtraction from the single integrated spectrum to evaluate the double/sigmoid integral more accurately ‚û®</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># correction of the TMPD^{.+} EPR spectrum single</span></span>
<span><span class="co"># integral by the 3rd degree polynomial</span></span>
<span><span class="va">tmpd.data.norm.02.integCorr</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/eval_integ_EPR_Spec.html">eval_integ_EPR_Spec</a></span><span class="op">(</span></span>
<span>    data.spectr <span class="op">=</span> <span class="va">tmpd.data.norm.02</span>,</span>
<span>    B <span class="op">=</span> <span class="st">"B_mT"</span>,</span>
<span>    B.unit <span class="op">=</span> <span class="st">"mT"</span>,</span>
<span>    correct.integ <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co"># peak region to correct the baseline:</span></span>
<span>    BpeaKlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">344.5</span>, <span class="fl">355.5</span><span class="op">)</span>,</span>
<span>    <span class="co"># polynomial degree to fit baseline </span></span>
<span>    <span class="co"># under the peak region:</span></span>
<span>    poly.degree <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    sigmoid.integ <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview of the integrals,</span></span>
<span><span class="co"># data frame column of corrected integral</span></span>
<span><span class="co"># is denoted as `single_Integ_correct`</span></span>
<span><span class="fu"><a href="../reference/plot_EPR_Specs_integ.html">plot_EPR_Specs_integ</a></span><span class="op">(</span></span>
<span>  <span class="va">tmpd.data.norm.02.integCorr</span>,</span>
<span>  slct.integs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"single_Integ_correct"</span>,</span>
<span>    <span class="st">"sigmoid_Integ"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  B <span class="op">=</span> <span class="st">"B_mT"</span>,</span>
<span>  B.unit <span class="op">=</span> <span class="st">"mT"</span>,</span>
<span>  separate.integs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  separate.integ.scales <span class="op">=</span> <span class="st">"free_y"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:tmpd-correct-epr-integ"></span>
<img src="functionality_files/figure-html/tmpd-correct-epr-integ-1.png" alt="Corrected single and double integrated EPR spectrum of $\small \ce{TMPD^{.+}}$ (see also Figure \@ref(fig:tmpd-basic-epr-integ-visual))."><p class="caption">
Figure 5.7: Corrected single and double integrated EPR spectrum of <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> (see also Figure <a href="#fig:tmpd-basic-epr-integ-visual">5.6</a>).
</p>
</div>
<p>Maximum value of the double/sigmoid integral 0.0024 can be used for the estimation of <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> amount within the sample.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body">
<div id="ref-GramppGpda2005" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">GRAMPP, G√ºnter, KELTERER, Anne-Marie, LANDGRAF, Stephan, SACHER, Michael, NIETHAMMER, Dominique, TELO, Jo√£o P., DIAS, Rui M. B. and VIEIRA, Abel J. S. C. <span>ESR</span> and <span>ENDOR Investigations</span> on <span>Various Wurster</span>‚Äôs <span>Radical Cations</span> in <span>Solution</span>. <span>Experimental Results</span>, <span>Theoretical Ab Initio</span>, and <span>DFT Calculations</span>. <em>Monatsh. Chem.</em> 2005. Vol.¬†136, no.¬†4, p.¬†519‚Äì536. DOI¬†<a href="https://doi.org/10.1007/s00706-004-0224-4" class="external-link">10.1007/s00706-004-0224-4</a>. </div>
</div>
<div id="ref-PetrAse1996" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">PETR, Andreas, DUNSCH, Lothar and NEUDECK, Andreas. In situ uv-vis esr spectroelectrochemistry. <em>J. Electroanal. Chem.</em> 1996. Vol.¬†412, no.¬†1, p.¬†153‚Äì158. DOI¬†<a href="https://doi.org/10.1016/0022-0728(96)04582-2" class="external-link">10.1016/0022-0728(96)04582-2</a>. </div>
</div>
<div id="ref-Dadpou2018" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">DADPOU, Bita, NEMATOLLAHI, Davood and SHARAFI-KOLKESHVANDI, Mahnaz. Solvent effect on the electrochemical oxidation of <span>N</span>,<span>N</span>,<span>N</span><span><span class="math inline">\({'}\)</span></span>,<span>N</span><span><span class="math inline">\({'}\)</span></span>-tetramethyl-1,4-phenylenediamine. <span>New</span> insights into the correlation of electron transfer kinetics with dynamic solvent effects. <em>J. Mol. Liq.</em> 2018. Vol.¬†253, p.¬†127‚Äì135. DOI¬†<a href="https://doi.org/10.1016/j.molliq.2017.12.151" class="external-link">10.1016/j.molliq.2017.12.151</a>. </div>
</div>
<div id="ref-GuhaRrcdk2007" class="csl-entry">
<div class="csl-left-margin">4. </div>
<div class="csl-right-inline">GUHA, Rajarshi. Chemical informatics functionality in r. <em>J. Stat. Softw.</em> 2007. Vol.¬†18, no.¬†6. </div>
</div>
<div id="ref-WillighagenCDK2017" class="csl-entry">
<div class="csl-left-margin">5. </div>
<div class="csl-right-inline">WILLIGHAGEN, Egon L., MAYFIELD, Jonathan, John W.and Alvarsson, BERG, Arvid, CARLSSON, Lars, JELIAZKOVA, Nina, KUHN, Stefan, PLUSKAL, Tom√°≈°, ROJAS-CHERT√ì, Miquel, SPJUTH, Ola, TORRANCE, Gilleain, EVELO, Chris T., GUHA, Rajarshi and STEINBECK, Christoph. The chemistry development kit (CDK) v2.0: Atom typing, depiction, molecular formulas, and substructure searching. <em>J. Cheminformatics</em>. 2017. Vol.¬†9, no.¬†1, p.¬†33. DOI¬†<a href="https://doi.org/10.1186/s13321-017-0220-4" class="external-link">10.1186/s13321-017-0220-4</a>. </div>
</div>
<div id="ref-Sakari2022" class="csl-entry">
<div class="csl-left-margin">6. </div>
<div class="csl-right-inline">L√ÑTTI, Sakari T., NIINIVEHMAS, Sanna and PENTIK√ÑINEN, Olli T. Sdfconf: A novel, flexible, and robust molecular data management tool. <em>J. Chem. Inf. Model.</em> 2022. Vol.¬†62, no.¬†1, p.¬†9‚Äì15. DOI¬†<a href="https://doi.org/10.1021/acs.jcim.1c01051" class="external-link">10.1021/acs.jcim.1c01051</a>. </div>
<div class="csl-right-inline">PMID: 34932340</div>
</div>
<div id="ref-xepr2gfac2023" class="csl-entry">
<div class="csl-left-margin">7. </div>
<div class="csl-right-inline">GEE, Leland B. <em>Xepr2gfac data upload and conversion</em>. 2023. <a href="https://www.spectra.tools/bin/controller.pl?body=Xepr2gfac" class="external-link uri">https://www.spectra.tools/bin/controller.pl?body=Xepr2gfac</a>. </div>
</div>
<div id="ref-WilkinsonGG2005" class="csl-entry">
<div class="csl-left-margin">8. </div>
<div class="csl-right-inline">WILKINSON, Leland, WILLS, D., ROPE, D., NORTON, A. and DUBBS, R. <em>The <span>Grammar</span> of <span>Graphics</span></em>. 2nd edition. <span>New York</span>¬†: <span>Springer</span>, 2005. ISBN¬†978-0-387-24544-7. </div>
</div>
<div id="ref-Weilepr2007" class="csl-entry">
<div class="csl-left-margin">9. </div>
<div class="csl-right-inline">WEIL, John A. and BOLTON, James R. <em>Electron <span>Paramagnetic Resonance</span>: <span>Elementary Theory</span> and <span>Practical Applications</span></em>. <span>John Wiley &amp; Sons</span>, 2007. ISBN¬†978-0-470-08497-7. </div>
</div>
<div id="ref-Rpracma2023" class="csl-entry">
<div class="csl-left-margin">10. </div>
<div class="csl-right-inline">HANS W. BORCHERS. <em>Pracma: Practical numerical math functions.</em> [online]. 2023. Available from: <a href="https://cran.r-project.org/web/packages/pracma/index.html" class="external-link">https://cran.r-project.org/web/packages/pracma/index.html</a>
</div>
<div class="csl-right-inline">R package version 2.4.4</div>
</div>
<div id="ref-LibreMath2023" class="csl-entry">
<div class="csl-left-margin">11. </div>
<div class="csl-right-inline">SEEBURGER, Paul. <em><span class="nocase">Numerical Integration - Midpoint, Trapezoid, Simpson‚Äôs rule.</span></em> 2023. <a href="http://tinyurl.com/trapz-integral" class="external-link uri">http://tinyurl.com/trapz-integral</a>. </div>
</div>
<div id="ref-Math24net2023" class="csl-entry">
<div class="csl-left-margin">12. </div>
<div class="csl-right-inline">SVIRIN, Alex. <em><span class="nocase">Calculus, Integration of Functions-Trapezoidal Rule</span></em>. 2023. <a href="https://math24.net/trapezoidal-rule.html" class="external-link uri">https://math24.net/trapezoidal-rule.html</a>. </div>
</div>
<div id="ref-epperson2013intro" class="csl-entry">
<div class="csl-left-margin">13. </div>
<div class="csl-right-inline">EPPERSON, J. F. <em>An introduction to numerical methods and analysis</em> [online]. Wiley &amp; Sons, 2013. ISBN¬†9781118367599. Available from: <a href="https://books.google.cz/books?id=310lAgAAQBAJ" class="external-link">https://books.google.cz/books?id=310lAgAAQBAJ</a>
</div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by J√°n Tar√°bek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
