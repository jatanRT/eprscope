<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>First Steps with R Language ‚Ä¢ eprscope</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="First Steps with R Language">
<!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eprscope</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/datasets.html">Package Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/firstSteps.html">First Steps with R Language</a></li>
    <li><a class="dropdown-item" href="../articles/functionality.html">Basic Functionality</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jatanrt/eprscope/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>First Steps with R Language</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jatanrt/eprscope/blob/master/vignettes/firstSteps.Rmd" class="external-link"><code>vignettes/firstSteps.Rmd</code></a></small>
      <div class="d-none name"><code>firstSteps.Rmd</code></div>
    </div>

    
    
<p><span class="math inline">\(\require{mhchem}\)</span></p>
<p>This article/vignette deals with essential syntax and/or basic commands to run the <a href="https://jatanrt.github.io/eprscope/">eprscope</a> functions. For details or more advanced programming experience, please refer to the resources in <a href="https://jatanrt.github.io/eprscope/index.html"><em>README</em> file/Homepage</a>. Sections, discussing the basics of plotting (several plots will be already presented) and operations with strings will be added in the upcoming package versions.</p>
<div class="section level2" number="1">
<h2 id="variablefunction-names-and-assignment">
<span class="header-section-number">1</span> Variable/Function Names and Assignment<a class="anchor" aria-label="anchor" href="#variablefunction-names-and-assignment"></a>
</h2>
<p>Any name, even the complex one (see vide infra), can be applied to assign the variable/function. It is common to use complex names with the parts separated either by underscore <code>..._...</code> or by dot, like stated in the examples below. Both assignment operators (<code>&lt;-</code> and <code>=</code>) can be used in <img src="RcoreLogo.png" width="16" height="12"> language. However, the application of the first one is preferred, due to the fact that the <code>=</code> is a pure assignment operator and it does not necessarily initialize a variable in the namespace (e.g.¬†as arguments in a function, see below). Whereas, the <code>&lt;-</code> always creates a variable <span class="citation">(<a href="#ref-assignR2018">1</a>‚Äì<a href="#ref-wickham2019">4</a>)</span>. In order to improve the code readability, comments may be included, starting the line with the hash symbol <code>#</code> like shown in the following code chunks.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Q value (EPR sensitivity instrumental factor) assignment:</span></span>
<span><span class="va">Q_value</span> <span class="op">&lt;-</span> <span class="fl">3500</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># loading package built-in example file/data =&gt; "TMPD_specelchem_accu_b.asc",</span></span>
<span><span class="co"># which corresponds to the EPR spectrum of Wuster's blue:</span></span>
<span><span class="va">tmpd.data.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_data_example.html">load_data_example</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"TMPD_specelchem_accu_b.asc"</span><span class="op">)</span></span>
<span><span class="co"># where `file` is the argument of the `load_data_example` function</span></span></code></pre></div>
<p>The <code>file</code> within the parentheses represents an <strong>argument of the function</strong> <code><a href="../reference/load_data_example.html">load_data_example()</a></code> and <strong>its assignment must be solely provided by the <code>=</code> operator.</strong> If several arguments are defined, they have to be separated by <code>,</code> (‚Äúcomma‚Äù).</p>
</div>
<div class="section level2" number="2">
<h2 id="functions-and-packages">
<span class="header-section-number">2</span> Functions and Packages<a class="anchor" aria-label="anchor" href="#functions-and-packages"></a>
</h2>
<p>Packages are fundamental units of shareable code. They may bundle functions, sample code, datasets, documentation and tests <span class="citation">(<a href="#ref-GfG2023">5</a>, <a href="#ref-wickham2023">6</a>)</span>. By default, during the <img src="RcoreLogo.png" width="16" height="12"> installation, only a couple of packages are set up (e.g.¬†<code>{base}</code> , <code>{datasets}</code> , <code>{graphics}</code> , <code>{grdevices}</code> , <code>{stats}</code> , <code>{utils}</code> ). These are also immediately available, once you start the <img src="RcoreLogo.png" width="16" height="12"> console or <em>Rstudio</em> IDE (Integrated Development Environment). Additional packages must by installed and loaded explicitly in order to be utilized. To load such packages, the function <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code> has to be executed. It actually refers to the (default) place (folder) where the üì¶ is stored on your computer, such as loading the collection of essential data science packages called <a href="https://www.tidyverse.org/" class="external-link">{tidyverse}</a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ‚îÄ‚îÄ <span style="font-weight: bold;">Attaching core tidyverse packages</span> ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">‚úî</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">‚úî</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">‚úî</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">‚úî</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">‚úî</span> <span style="color: #0000BB;">lubridate</span> 1.9.4     <span style="color: #00BB00;">‚úî</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">‚úî</span> <span style="color: #0000BB;">purrr    </span> 1.0.4     <span style="color: #00BB00;">‚úî</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; ‚îÄ‚îÄ <span style="font-weight: bold;">Conflicts</span> ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">‚úñ</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">plotly</span>::filter(), <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">‚úñ</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span></code></pre></div>
<p>Sometimes a function/dataset/object from a certain üì¶ is called via ‚Äúspecial‚Äù syntax like <code>package::function()</code>. The double colon <code>::</code> actually points to selection from the package <code>NAMESPACE</code> in order to prevent collisions when functions/datasets/objects from different packages possess the same name (e.g.¬†<code><a href="https://rdrr.io/r/stats/filter.html" class="external-link">stats::filter()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter()</a></code> , see also the massage after <a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a> loading, above)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;On the rare occasions you may also come across the triple colon &lt;code&gt;:::&lt;/code&gt; which calls the ‚Äúhidden‚Äù objects from the package (e.g.¬†installation of several &lt;span class="math inline"&gt;\(\LaTeX\)&lt;/span&gt; packages under the &lt;img src="RcoreLogo.png" width="16" height="12"&gt;&lt;code&gt;tinytex&lt;/code&gt; distribution: &lt;code&gt;tinytex:::install_yihui_pkgs()&lt;/code&gt; , see also &lt;a href="https://yihui.org/tinytex/" class="external-link uri"&gt;https://yihui.org/tinytex/&lt;/a&gt;)&lt;/p&gt;'><sup>1</sup></a>. However, in most cases, one does not need to call each function like this and it is enough if <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library(package)</a></code> command is executed at the beginning of the entire <img src="RcoreLogo.png" width="16" height="12"> script (which is also the case for the <a href="https://jatanrt.github.io/eprscope/">eprscope</a> üì¶).</p>
</div>
<div class="section level2" number="3">
<h2 id="vectors-mats">
<span class="header-section-number">3</span> Vectors and Matrices<a class="anchor" aria-label="anchor" href="#vectors-mats"></a>
</h2>
<p>In order to hold multiple data values of the same type (e.g.¬†numeric, character or logical) the <img src="RcoreLogo.png" width="16" height="12"> language uses the vector object, which is created by the <code>c(...)</code> command/function (the ‚Äúc‚Äù stands for ‚Äúcombine‚Äù or ‚Äúconcatenate‚Äù) like:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># creating a vector of EPR intensity </span></span>
<span><span class="co"># normalization constant names</span></span>
<span><span class="va">str.norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NumberOfScans"</span>,<span class="st">"Concentration"</span>,<span class="st">"QValue"</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...and their corresponding values</span></span>
<span><span class="va">value.norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>,<span class="fl">1e-3</span>,<span class="fl">3500</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview of both vectors</span></span>
<span><span class="va">str.norm</span></span>
<span><span class="co">#&gt; [1] "NumberOfScans" "Concentration" "QValue"</span></span>
<span><span class="va">value.norm</span></span>
<span><span class="co">#&gt; [1] 2.4e+01 1.0e-03 3.5e+03</span></span></code></pre></div>
<p>The combination of different types automatically turns the vector components into character:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># combination/concatenation of both</span></span>
<span><span class="co"># vectors created above</span></span>
<span><span class="va">comb.norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">str.norm</span>,<span class="va">value.norm</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="va">comb.norm</span></span>
<span><span class="co">#&gt; [1] "NumberOfScans" "Concentration" "QValue"        "24"           </span></span>
<span><span class="co">#&gt; [5] "0.001"         "3500"</span></span></code></pre></div>
<p>To avoid such behavior one has to define a <code>list</code> as shown below. The length of a vector can be figured out by the <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code> function, counting the number of vector components:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># dermine the vector length (`comb.norm`)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">comb.norm</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<p>Performing operations on individual elements requires indexing (vectors in <img src="RcoreLogo.png" width="16" height="12"> are 1 based indexing unlike the normal <em>C</em> or <em>Python</em>), which is quite simple and demonstrated by the following examples:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># select the third element</span></span>
<span><span class="va">comb.norm</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "QValue"</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># select the last element</span></span>
<span><span class="va">comb.norm</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">comb.norm</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "3500"</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># remove the second and the fifth  element</span></span>
<span><span class="va">comb.norm</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "NumberOfScans" "QValue"        "24"            "3500"</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...or the same selection </span></span>
<span><span class="co"># by logical operations:</span></span>
<span><span class="va">comb.norm</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "NumberOfScans" "QValue"        "24"            "3500"</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># replace the fourth element</span></span>
<span><span class="va">comb.norm</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">50</span> <span class="co"># or "50"</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># the actual `comb.norm` vector</span></span>
<span><span class="co"># (with replacement of the 4th element)</span></span>
<span><span class="va">comb.norm</span></span>
<span><span class="co">#&gt; [1] "NumberOfScans" "Concentration" "QValue"        "50"           </span></span>
<span><span class="co">#&gt; [5] "0.001"         "3500"</span></span></code></pre></div>
<p>The basic arithmetic operations on vectors are also performed element-wise:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># create vector of 10 numeric values,</span></span>
<span><span class="co"># repeating `0.1` 10-times</span></span>
<span><span class="va">vec.01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,times <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># vector of B_{central} (magnetic flux density) </span></span>
<span><span class="co"># in Gauss to calculate the g_{iso} values</span></span>
<span><span class="va">B.central.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">3485.22</span>,<span class="fl">3490.47</span>,<span class="fl">3491.78</span>,<span class="fl">3488.35</span>,<span class="fl">3492.55</span>,</span>
<span>  <span class="fl">3489.21</span>,<span class="fl">3491.99</span>,<span class="fl">3491.47</span>,<span class="fl">3492.50</span>,<span class="fl">3490.23</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># addition (+ preview)</span></span>
<span><span class="va">add.vec</span> <span class="op">&lt;-</span> <span class="va">vec.01</span> <span class="op">+</span> <span class="va">B.central.vec</span></span>
<span><span class="va">add.vec</span></span>
<span><span class="co">#&gt;  [1] 3485.32 3490.57 3491.88 3488.45 3492.65 3489.31 3492.09 3491.57 3492.60</span></span>
<span><span class="co">#&gt; [10] 3490.33</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># multiplication (+ preview, values in mT) </span></span>
<span><span class="va">multiple.vec</span> <span class="op">&lt;-</span> <span class="va">vec.01</span> <span class="op">*</span> <span class="va">B.central.vec</span></span>
<span><span class="va">multiple.vec</span></span>
<span><span class="co">#&gt;  [1] 348.522 349.047 349.178 348.835 349.255 348.921 349.199 349.147 349.250</span></span>
<span><span class="co">#&gt; [10] 349.023</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># microwave frequency to calculate the g_{iso}</span></span>
<span><span class="va">nu.GHz</span> <span class="op">&lt;-</span> <span class="fl">9.892546</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># operation (calculate g_{iso}) in a loop, iteration</span></span>
<span><span class="co"># through all elements (i) of the `B.central.vec`</span></span>
<span><span class="va">vec.g.iso.a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>  <span class="va">B.central.vec</span>, <span class="op">{</span><span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> </span>
<span>    <span class="fu"><a href="../reference/eval_gFactor.html">eval_gFactor</a></span><span class="op">(</span></span>
<span>      nu.val <span class="op">=</span> <span class="va">nu.GHz</span>,</span>
<span>      B.val <span class="op">=</span> <span class="va">i</span>,</span>
<span>      B.unit <span class="op">=</span> <span class="st">"G"</span></span>
<span>    <span class="op">)</span><span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># such operation is an equivalent </span></span>
<span><span class="co"># (simplification of) to `for` loop</span></span>
<span><span class="va">vec.g.iso.b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">B.central.vec</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">vec.g.iso.b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eval_gFactor.html">eval_gFactor</a></span><span class="op">(</span></span>
<span>    nu.val <span class="op">=</span> <span class="va">nu.GHz</span>,</span>
<span>    B.val <span class="op">=</span> <span class="va">B.central.vec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    B.unit <span class="op">=</span> <span class="st">"G"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># preview (comparison)</span></span>
<span><span class="va">vec.g.iso.a</span></span>
<span><span class="co">#&gt;  [1] 2.02799 2.02494 2.02418 2.02617 2.02374 2.02567 2.02406 2.02436 2.02377</span></span>
<span><span class="co">#&gt; [10] 2.02508</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">vec.g.iso.a</span>,<span class="va">vec.g.iso.b</span><span class="op">)</span> <span class="co"># Are these vectors identical ?</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Previous examples show, how the vectors can be created by <code>loops</code> . However in to order to calculate the <em>g</em><sub>iso</sub>-values, one can just simply use the <code><a href="../reference/eval_gFactor.html">eval_gFactor()</a></code> function on the entire <code>B.central.vec</code> like:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">vec.g.iso.c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eval_gFactor.html">eval_gFactor</a></span><span class="op">(</span></span>
<span>  nu.val <span class="op">=</span> <span class="va">nu.GHz</span>,</span>
<span>  B.val <span class="op">=</span> <span class="va">B.central.vec</span>,</span>
<span>  B.unit <span class="op">=</span> <span class="st">"G"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># preview</span></span>
<span><span class="va">vec.g.iso.c</span></span>
<span><span class="co">#&gt;  [1] 2.02799 2.02494 2.02418 2.02617 2.02374 2.02567 2.02406 2.02436 2.02377</span></span>
<span><span class="co">#&gt; [10] 2.02508</span></span></code></pre></div>
<p>Matrices can be created from vectors as demonstrated by the following example:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># define vector (sequence) of hypothetical g-values</span></span>
<span><span class="va">mat.01.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2.001</span>,<span class="fl">2.009</span>,length.out <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># create 3 x 3 matrix with `mat.01.vec` </span></span>
<span><span class="co"># elements arranged in rows</span></span>
<span><span class="va">mat.01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">mat.01.vec</span>,<span class="fl">3</span>,<span class="fl">3</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="va">mat.01</span></span>
<span><span class="co">#&gt;       [,1]  [,2]  [,3]</span></span>
<span><span class="co">#&gt; [1,] 2.001 2.002 2.003</span></span>
<span><span class="co">#&gt; [2,] 2.004 2.005 2.006</span></span>
<span><span class="co">#&gt; [3,] 2.007 2.008 2.009</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># 3 x 3 diagonal identity matrix</span></span>
<span><span class="va">mat.02</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">3</span>,ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="va">mat.02</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    1</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># create matrix from the vectors </span></span>
<span><span class="co"># bound into columns (see the next operation)</span></span>
<span><span class="va">mat.02.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.0033</span>,<span class="fl">2.0034</span><span class="op">)</span></span>
<span><span class="va">mat.03.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.0035</span>,<span class="fl">2.0036</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...and the corresponding matrix</span></span>
<span><span class="va">mat.03</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="co"># "c" for column</span></span>
<span>  <span class="va">mat.02.vec</span>,</span>
<span>  <span class="va">mat.03.vec</span>,</span>
<span>  deparse.level <span class="op">=</span> <span class="fl">0</span> <span class="co"># no labels</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># similarly, the matrix can be also created</span></span>
<span><span class="co"># using vectors bound into rows</span></span>
<span><span class="co"># by the `rbind()` function</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview of `mat.03`</span></span>
<span><span class="va">mat.03</span></span>
<span><span class="co">#&gt;        [,1]   [,2]</span></span>
<span><span class="co">#&gt; [1,] 2.0033 2.0035</span></span>
<span><span class="co">#&gt; [2,] 2.0034 2.0036</span></span></code></pre></div>
<p>Selection of elements is similar to that of vectors with additional second dimension:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># select element in the 2nd row</span></span>
<span><span class="co"># and the 3rd column within `mat.01`</span></span>
<span><span class="va">mat.01</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 2.006</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># subset 2 x 2 matrix from</span></span>
<span><span class="co"># the `mat.01`</span></span>
<span><span class="va">mat.01</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt;       [,1]  [,2]</span></span>
<span><span class="co">#&gt; [1,] 2.001 2.002</span></span>
<span><span class="co">#&gt; [2,] 2.004 2.005</span></span></code></pre></div>
<p>Transpose the <code>mat.01</code> matrix:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># `mat.01` transposition</span></span>
<span><span class="va">mat.01.t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mat.01</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="va">mat.01.t</span></span>
<span><span class="co">#&gt;       [,1]  [,2]  [,3]</span></span>
<span><span class="co">#&gt; [1,] 2.001 2.004 2.007</span></span>
<span><span class="co">#&gt; [2,] 2.002 2.005 2.008</span></span>
<span><span class="co">#&gt; [3,] 2.003 2.006 2.009</span></span></code></pre></div>
<p>Inverse matrix (<span class="math inline">\(\small A^{-1}\)</span>) can be obtained by the <code><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve()</a></code> (<code>{base}</code> package) function, where <span class="math inline">\(\small A^{-1}\,A = A\,A^{-1}\,=\mathrm{1}\)</span> (identity matrix):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># a 3 x 3 matrix of magnetic flux density</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">B.central.vec</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># inverse matrix</span></span>
<span><span class="va">A_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="va">A_1</span></span>
<span><span class="co">#&gt;             [,1]        [,2]        [,3]</span></span>
<span><span class="co">#&gt; [1,] -0.16467456 -0.01321007  0.17785669</span></span>
<span><span class="co">#&gt; [2,] -0.01056158  0.22803653 -0.21740924</span></span>
<span><span class="co">#&gt; [3,]  0.17519223 -0.21461436  0.03967075</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># check if A_1 * A = 1 (identity matrix),</span></span>
<span><span class="co"># by matrix multiplication (A_1 %*% A)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">3</span>,ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="co"># identity matrix</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">A_1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">A</span>,digits <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="co"># rounding to 8 decim. places</span></span>
<span><span class="op">)</span> <span class="co"># Are matrices identical ?</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>The inverse matrix calculation requires following condition:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># determinat of A matrix must be different from 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isFALSE</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/det.html" class="external-link">det</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level2" number="4">
<h2 id="data-frames">
<span class="header-section-number">4</span> Data Frames and the Pipe Operator<a class="anchor" aria-label="anchor" href="#data-frames"></a>
</h2>
<p>Data frame is one of most important structures/objects in <img src="RcoreLogo.png" width="16" height="12"> statistical language to store the tabular data/dataset. It is similar to matrix (because it is a 2-dimensional scheme), but unlike the matrices it can take different data types in list (vide infra) of vectors with the equal lengths, corresponding <strong>to columns/variables</strong>. The second dimension is defined by the <strong>rows/observations</strong>, consisting of vector elements with equal indices (from all columns). As an example we may construct a data frame directly by the <code><a href="../reference/readEPR_Exp_Specs.html">readEPR_Exp_Specs()</a></code> function from <a href="https://jatanrt.github.io/eprscope/">eprscope</a> üì¶:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># read the EPR spectrum from the already </span></span>
<span><span class="co"># defined path `tmpd.data.file`</span></span>
<span><span class="va">df.example.01</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readEPR_Exp_Specs.html">readEPR_Exp_Specs</a></span><span class="op">(</span></span>
<span>  <span class="va">tmpd.data.file</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B_G"</span>,<span class="st">"dIepr_over_dB"</span><span class="op">)</span>,</span>
<span>  qValue <span class="op">=</span> <span class="va">Q_value</span>, <span class="co"># defined above</span></span>
<span>  <span class="co"># instrumental EPR origin:</span></span>
<span>  origin <span class="op">=</span> <span class="st">"winepr"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview (first 6 rows)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">)</span></span>
<span><span class="co">#&gt;          B_G dIepr_over_dB      B_mT</span></span>
<span><span class="co">#&gt;        &lt;num&gt;         &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 3439.1699 -56.047361607 343.91699</span></span>
<span><span class="co">#&gt; 2: 3439.2200 -30.506506697 343.92200</span></span>
<span><span class="co">#&gt; 3: 3439.2700 -38.522218750 343.92700</span></span>
<span><span class="co">#&gt; 4: 3439.3201   0.039208426 343.93201</span></span>
<span><span class="co">#&gt; 5: 3439.3701 -92.620223214 343.93701</span></span>
<span><span class="co">#&gt; 6: 3439.4199 -71.915075893 343.94199</span></span></code></pre></div>
<p>The previous data frame consists of the following columns/variables represented by their headers:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># headers for 2D schemes like matrices or data frames</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "B_G"           "dIepr_over_dB" "B_mT"</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...or in general</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "B_G"           "dIepr_over_dB" "B_mT"</span></span></code></pre></div>
<p>These column names are referred to the following vectors:</p>
<ol style="list-style-type: decimal">
<li><p>Magnetic flux density <span class="math inline">\(\small B\)</span> in Gauss (<code>B_G</code>)</p></li>
<li><p>Derivative EPR intensity (<code>dIepr_over_dB</code>) in p.d.u. (procedure defined units <span class="citation">(<a href="#ref-HansIUPAC2019">7</a>)</span>)</p></li>
<li><p>Magnetic flux density <span class="math inline">\(\small B\)</span> in millitesla (<code>B_mT</code>)</p></li>
</ol>
<p>One can preview the <strong>str</strong>ucture of data frame by the <code><a href="https://rdrr.io/r/utils/str.html" class="external-link">str()</a></code> function from the <code>{utils}</code> üì¶:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classes 'data.table' and 'data.frame':   2401 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ B_G          : num  3439 3439 3439 3439 3439 ...</span></span>
<span><span class="co">#&gt;  $ dIepr_over_dB: num  -56.0474 -30.5065 -38.5222 0.0392 -92.6202 ...</span></span>
<span><span class="co">#&gt;  $ B_mT         : num  344 344 344 344 344 ...</span></span>
<span><span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt;</span></span></code></pre></div>
<div class="section level3" number="4.1">
<h3 id="operations-with-columns-and-rows">
<span class="header-section-number">4.1</span> Operations with Columns and Rows<a class="anchor" aria-label="anchor" href="#operations-with-columns-and-rows"></a>
</h3>
<p>From the previous output we can immediately recognize that all three columns of <code>df.example.01</code> are <strong>num</strong>eric and the dimension (which can be also figured out by the <code><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim()</a></code> function) reads 2401 (rows/observations) <span class="math inline">\(\small \times\)</span> 3 (variables/columns). The dollar sign <code>$</code> in front of each column vector represents an operator to select the column (variable) of a data frame, namely:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># vector of magnetic flux density in Gauss</span></span>
<span><span class="va">vec.B.G.a</span> <span class="op">&lt;-</span> <span class="va">df.example.01</span><span class="op">$</span><span class="va">B_G</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview of the first 12 values</span></span>
<span><span class="va">vec.B.G.a</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] 3439.1699 3439.2200 3439.2700 3439.3201 3439.3701 3439.4199 3439.4700</span></span>
<span><span class="co">#&gt;  [8] 3439.5200 3439.5701 3439.6201 3439.6699 3439.7200</span></span></code></pre></div>
<p>Similarly, the same vector/column can be also selected by double square brackets <code>[[]]</code> , like:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">vec.B.G.b</span> <span class="op">&lt;-</span> <span class="va">df.example.01</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co"># or</span></span>
<span><span class="va">vec.B.G.c</span> <span class="op">&lt;-</span> <span class="va">df.example.01</span><span class="op">[[</span><span class="st">"B_G"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview of the first 12 values</span></span>
<span><span class="va">vec.B.G.b</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] 3439.1699 3439.2200 3439.2700 3439.3201 3439.3701 3439.4199 3439.4700</span></span>
<span><span class="co">#&gt;  [8] 3439.5200 3439.5701 3439.6201 3439.6699 3439.7200</span></span>
<span><span class="va">vec.B.G.c</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] 3439.1699 3439.2200 3439.2700 3439.3201 3439.3701 3439.4199 3439.4700</span></span>
<span><span class="co">#&gt;  [8] 3439.5200 3439.5701 3439.6201 3439.6699 3439.7200</span></span></code></pre></div>
<p>In order to select/convert a data frame row into vector, one has to, first of all, <code><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist()</a></code> the row (because it possesses the form of a data frame) and finally remove the names (if the named vector is not desired):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># first row of data frame</span></span>
<span><span class="va">df.example.01</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;          B_G dIepr_over_dB      B_mT</span></span>
<span><span class="co">#&gt;        &lt;num&gt;         &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 3439.1699    -56.047362 343.91699</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># convert the row data frame </span></span>
<span><span class="co"># into the vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3439.169922  -56.047362  343.916992</span></span></code></pre></div>
<p>Selection/Subset by single square brackets results in data frame structure, even with one row or column/variable, which is kind of similar to matrices, as already depicted above. An alternative way would be the usage of <code><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset()</a></code> function from the <code>{base}</code> üì¶. Both ways are documented by the following code:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># select the first column,</span></span>
<span><span class="co"># resulting in data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">[</span> ,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;          B_G</span></span>
<span><span class="co">#&gt;        &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 3439.1699</span></span>
<span><span class="co">#&gt; 2: 3439.2200</span></span>
<span><span class="co">#&gt; 3: 3439.2700</span></span>
<span><span class="co">#&gt; 4: 3439.3201</span></span>
<span><span class="co">#&gt; 5: 3439.3701</span></span>
<span><span class="co">#&gt; 6: 3439.4199</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># select the 4th row of the original</span></span>
<span><span class="co"># data frame and extract the `B_mT` value</span></span>
<span><span class="va">df.example.01</span><span class="op">[</span><span class="fl">4</span>, <span class="op">]</span><span class="op">[[</span><span class="st">"B_mT"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 343.93201</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># select and/or subset data frame</span></span>
<span><span class="co"># with magnetic flux density `B_G` &lt;= `Bcf`,</span></span>
<span><span class="co"># which is the central field (or `median(B_G)`)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">[</span><span class="va">df.example.01</span><span class="op">$</span><span class="va">B_G</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">$</span><span class="va">B_G</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;          B_G dIepr_over_dB      B_mT</span></span>
<span><span class="co">#&gt;        &lt;num&gt;         &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 3439.1699 -56.047361607 343.91699</span></span>
<span><span class="co">#&gt; 2: 3439.2200 -30.506506697 343.92200</span></span>
<span><span class="co">#&gt; 3: 3439.2700 -38.522218750 343.92700</span></span>
<span><span class="co">#&gt; 4: 3439.3201   0.039208426 343.93201</span></span>
<span><span class="co">#&gt; 5: 3439.3701 -92.620223214 343.93701</span></span>
<span><span class="co">#&gt; 6: 3439.4199 -71.915075893 343.94199</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># the same with `subset()`</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">df.example.01</span>,<span class="va">B_G</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">B_G</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          B_G dIepr_over_dB      B_mT</span></span>
<span><span class="co">#&gt;        &lt;num&gt;         &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 3439.1699 -56.047361607 343.91699</span></span>
<span><span class="co">#&gt; 2: 3439.2200 -30.506506697 343.92200</span></span>
<span><span class="co">#&gt; 3: 3439.2700 -38.522218750 343.92700</span></span>
<span><span class="co">#&gt; 4: 3439.3201   0.039208426 343.93201</span></span>
<span><span class="co">#&gt; 5: 3439.3701 -92.620223214 343.93701</span></span>
<span><span class="co">#&gt; 6: 3439.4199 -71.915075893 343.94199</span></span></code></pre></div>
<p>To create or delete a column/variable one may use:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># create g-value column (`g_Val`)</span></span>
<span><span class="va">df.example.01</span><span class="op">$</span><span class="va">g_Val</span> <span class="op">&lt;-</span> <span class="co"># or `df.example.01[["g_Val"]] &lt;-`</span></span>
<span>  <span class="fu"><a href="../reference/eval_gFactor.html">eval_gFactor</a></span><span class="op">(</span></span>
<span>    nu.val <span class="op">=</span> <span class="va">nu.GHz</span>,</span>
<span>    B.val <span class="op">=</span> <span class="va">df.example.01</span><span class="op">$</span><span class="va">B_mT</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...right after that, delete</span></span>
<span><span class="co"># the `B_mT` column/variable</span></span>
<span><span class="va">df.example.01</span><span class="op">$</span><span class="va">B_mT</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...the same operation can be done</span></span>
<span><span class="co"># by: `df.example.01[,-3]` or </span></span>
<span><span class="co"># `subset(df.example.01,select = -B_mT)`</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># data frame preview</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">)</span></span>
<span><span class="co">#&gt;          B_G dIepr_over_dB   g_Val</span></span>
<span><span class="co">#&gt;        &lt;num&gt;         &lt;num&gt;   &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 3439.1699 -56.047361607 2.05515</span></span>
<span><span class="co">#&gt; 2: 3439.2200 -30.506506697 2.05512</span></span>
<span><span class="co">#&gt; 3: 3439.2700 -38.522218750 2.05509</span></span>
<span><span class="co">#&gt; 4: 3439.3201   0.039208426 2.05506</span></span>
<span><span class="co">#&gt; 5: 3439.3701 -92.620223214 2.05503</span></span>
<span><span class="co">#&gt; 6: 3439.4199 -71.915075893 2.05500</span></span></code></pre></div>
<p>A data frame can be also created, by the definition (see above), using the equally long vectors (refer to the vector definitions in Section <a href="#vectors-mats">3</a>), like:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># create a data frame by the `data.frame()` base </span></span>
<span><span class="co"># function using the vectors already defined above</span></span>
<span><span class="va">normalization.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  norm_names <span class="op">=</span> <span class="va">str.norm</span>,</span>
<span>  norm_values <span class="op">=</span> <span class="va">value.norm</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="va">normalization.df</span></span>
<span><span class="co">#&gt;      norm_names norm_values</span></span>
<span><span class="co">#&gt; 1 NumberOfScans     2.4e+01</span></span>
<span><span class="co">#&gt; 2 Concentration     1.0e-03</span></span>
<span><span class="co">#&gt; 3        QValue     3.5e+03</span></span></code></pre></div>
</div>
<div class="section level3" number="4.2">
<h3 id="descriptive-statistics-of-data-frames">
<span class="header-section-number">4.2</span> Descriptive Statistics of Data Frames<a class="anchor" aria-label="anchor" href="#descriptive-statistics-of-data-frames"></a>
</h3>
<p>The basic statistical measures of a data frame (its columns) are available by the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> command/function:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">)</span></span>
<span><span class="co">#&gt;       B_G         dIepr_over_dB           g_Val       </span></span>
<span><span class="co">#&gt;  Min.   :3439.2   Min.   :-41226.32   Min.   :1.9859  </span></span>
<span><span class="co">#&gt;  1st Qu.:3469.2   1st Qu.:  -834.00   1st Qu.:2.0027  </span></span>
<span><span class="co">#&gt;  Median :3499.2   Median :   -15.31   Median :2.0199  </span></span>
<span><span class="co">#&gt;  Mean   :3499.2   Mean   :     0.00   Mean   :2.0201  </span></span>
<span><span class="co">#&gt;  3rd Qu.:3529.2   3rd Qu.:   777.53   3rd Qu.:2.0374  </span></span>
<span><span class="co">#&gt;  Max.   :3559.2   Max.   : 43423.41   Max.   :2.0551</span></span></code></pre></div>
<p>Additionally, for each column one can also obtain measures of dispersion (by using a loop <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply()</a></code> ) ‚û® the <a href="https://www.r-tutor.com/elementary-statistics/numerical-measures/variance" class="external-link">sample variance</a> and the <a href="https://www.r-tutor.com/elementary-statistics/numerical-measures/standard-deviation" class="external-link">standard deviation</a>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># variance (var) for each column </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">df.example.01</span>, FUN <span class="op">=</span> <span class="va">var</span><span class="op">)</span></span>
<span><span class="co">#&gt;           B_G dIepr_over_dB         g_Val </span></span>
<span><span class="co">#&gt; 1.2015004e+03 8.0284563e+07 4.0053978e-04</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># standard deviation (sd) for each column</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">df.example.01</span>, FUN <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span><span class="co">#&gt;           B_G dIepr_over_dB         g_Val </span></span>
<span><span class="co">#&gt;   34.66266611 8960.16535130    0.02001349</span></span>
<span></span>
<span><span class="co"># where sd(x) = sqrt(var(x))</span></span></code></pre></div>
<p>In order to figure out whether there is a relationship between the variables/columns of a data frame, we may use two characteristic measures: <a href="https://www.r-tutor.com/elementary-statistics/numerical-measures/covariance" class="external-link">covariance</a> and <a href="https://www.r-tutor.com/elementary-statistics/numerical-measures/correlation-coefficient" class="external-link">correlation</a>. Both check to which extend those variables vary linearly. In the first case, the covariance indicates the direction of the linear relationship:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># covariance for the entire data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">)</span></span>
<span><span class="co">#&gt;                          B_G  dIepr_over_dB          g_Val</span></span>
<span><span class="co">#&gt; B_G            1201.50042153 -2.3754939e+03 -0.69369368725</span></span>
<span><span class="co">#&gt; dIepr_over_dB -2375.49394004  8.0284563e+07  1.36802521979</span></span>
<span><span class="co">#&gt; g_Val            -0.69369369  1.3680252e+00  0.00040053978</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># it returns the `ncol(df.example.01) x ncol(df.example.01)`</span></span>
<span><span class="co"># (or in this case 3 x 3) matrix</span></span></code></pre></div>
<p>For example, it can be immediately recognized that there is an negative relationship between <code>g_Val</code> and <code>B_G</code> (they are indirectly/inversely proportional), as it is already expected from <span class="math inline">\(\small g = h\,\nu\,/\,\mu_{\mathrm{B}}\,B\)</span> . Additionally, each of the <code>var</code> <em>vs</em> <code>var</code> pair (such as <code>B_G</code> <em>vs</em> <code>B_G</code>) corresponds to variance (compare it with output of the previous code chunk). If the covariance <span class="math inline">\(\small \approx 0\)</span>, there is no relationship between the variables. However, the main problem of the <strong>cov</strong>ariance is, that it is not delimited and depends on the unit of measures. Therefore, to solve this issue a <strong>cor</strong>relation is defined as a ratio between the covariance and the product of the individual standard deviations of variables/columns, which in addition to direction, provides the strength of the relationship:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># correlation for the entire data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         B_G dIepr_over_dB         g_Val</span></span>
<span><span class="co">#&gt; B_G            1.0000000000 -0.0076484942 -0.9999607427</span></span>
<span><span class="co">#&gt; dIepr_over_dB -0.0076484942  1.0000000000  0.0076287828</span></span>
<span><span class="co">#&gt; g_Val         -0.9999607427  0.0076287828  1.0000000000</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># the same result we may obtain by</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">df.example.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         B_G dIepr_over_dB         g_Val</span></span>
<span><span class="co">#&gt; B_G            1.0000000000 -0.0076484942 -0.9999607427</span></span>
<span><span class="co">#&gt; dIepr_over_dB -0.0076484942  1.0000000000  0.0076287828</span></span>
<span><span class="co">#&gt; g_Val         -0.9999607427  0.0076287828  1.0000000000</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># check also the definition of correlation</span></span>
<span><span class="co"># by the variance and the standard deviation for `B_G`</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">df.example.01</span>, FUN <span class="op">=</span> <span class="va">var</span><span class="op">)</span><span class="op">[</span><span class="st">"B_G"</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">df.example.01</span>, FUN <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">[</span><span class="st">"B_G"</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>Consequently, the correlation standardizes the covariance results and thus it is comparable across different units as well as different datasets. If the <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor()</a></code> returns <span class="math inline">\(\small \pm 1\)</span>, it implies a perfect positive or negative relationship, respectively. Of course, the diagonal elements <code>var</code> <em>vs</em> <code>var</code> (e. g. <code>g_Val</code> <em>vs</em> <code>g_Val</code>) always correspond to <span class="math inline">\(\small 1\)</span>. Similarly as for the covariance, the <span class="math inline">\(\small 0\)</span> indicates no correlation between variables. The default correlation is calculated by the <em>Pearson</em> method, however additional methods like <em>Kendall</em> or <em>Spearman</em> are available as well (please, refer to the <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">stats::cor()</a></code> function documentation).</p>
</div>
<div class="section level3" number="4.3">
<h3 id="the-pipe-operator">
<span class="header-section-number">4.3</span> The Pipe Operator<a class="anchor" aria-label="anchor" href="#the-pipe-operator"></a>
</h3>
<p><strong>Pipe Operator(s) <code>%&gt;%</code> (or <code>|&gt;</code>) in</strong> <img src="RcoreLogo.png" width="16" height="12"><strong>Programming Language</strong></p>
<p>In order to understand where does these operators come from and why they are used, we may start with a brief historical background <span class="citation">(<a href="#ref-dataCamp2022pipe">8</a>)</span>. The basic principle can be actually found in mathematics. If two functions (e.g.¬†<span class="math inline">\(\small f : B \rightarrow C\)</span> and <span class="math inline">\(\small g : A\rightarrow B\)</span>) are linked together into an operational chain, the output from one (<span class="math inline">\(\small g\)</span>) serves as the input for the other (<span class="math inline">\(\small f\)</span>), resulting in <span class="math inline">\(\small f(g(x))\)</span>, where <span class="math inline">\(\small x\equiv A\)</span>, <span class="math inline">\(\small g(x)\equiv B\)</span> and <span class="math inline">\(\small f(g(x))\equiv C\)</span>. Broad range of pipe applications actually started in 2013-2014 by development of the <a href="https://magrittr.tidyverse.org/" class="external-link">{magrittr}</a> and <a href="https://dplyr.tidyverse.org/" class="external-link">{dplyr}</a> packages in order to express sequences of operations in a readable and concise way. <strong>For beginners in programming, one might imagine the ‚Äúpipe‚Äù as a command (or narrator), saying: ‚Äú‚Ä¶and then‚Ä¶‚Äù where in the background it takes the result on its left-hand side and passes it as a first argument to the function on its right-hand side</strong> (see examples below)<strong>. This allows users to avoid creation of intermediate variables, makes the code easier to follow and finally also reduces the likelihood of a bug appearence.</strong> The pipe operator is also well known in other programming languages (e.g.¬†in <em>Python</em> or <em>Julia</em> ) and/or in the <em>Shell</em>/<em>Terminal</em>. However, it may possess a different syntax in comparison to <img src="RcoreLogo.png" width="16" height="12"><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;One may come across symbols like &lt;code&gt;.&lt;/code&gt; , &lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt; , &lt;code&gt;|&amp;gt;&lt;/code&gt; or &lt;code&gt;|&lt;/code&gt;&lt;/p&gt;"><sup>2</sup></a>.</p>
<p>For the simple cases, both <code>%&gt;%</code> and <code>|&gt;</code> (the latter also known as a native pipe operator) behave identically. However, they differ in the origin as well as in a couple of situations:</p>
<ol style="list-style-type: decimal">
<li>The native pipe operator <code>|&gt;</code> is automatically loaded when starting the <img src="RcoreLogo.png" width="16" height="12"> console/<em>Rstudio</em> IDE and does not require any additional üì¶. Whereas, the <code>%&gt;%</code> is included in the <a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a> (or <a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a> bundle) and therefore these packages must be loaded before their use. <strong>However, please notice that the native <code>|&gt;</code> can only be used with the <img src="RcoreLogo.png" width="16" height="12"> version</strong> <span class="math inline">\(\small &gt; 4.1\)</span> <strong>!</strong>
</li>
<li>The <code>|&gt;</code> requires parentheses for the right-hand side functions, whereas the <a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a> operator does not:</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># take the `vec.B.G.b(c)` vector from above,</span></span>
<span><span class="co"># round it (for 2 decimal places) </span></span>
<span><span class="co"># and find the mean value</span></span>
<span><span class="va">vec.B.G.b</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="va">mean</span></span>
<span><span class="co">#&gt; [1] 3499.17</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># however, the same operations for native</span></span>
<span><span class="co"># `|&gt;` pipe operator without the `mean`</span></span>
<span><span class="co"># parenthesis gives an error:</span></span>
<span><span class="co"># vec.B.G.c |&gt; round(digits = 2) |&gt; mean</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># therefore, parenthesis must be included</span></span>
<span><span class="co"># in the `mean` function call, like</span></span>
<span><span class="va">vec.B.G.c</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3499.17</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Pipe operators differ in placeholders (like <code>.</code> or <code>_</code> ) call, where one doesn‚Äôt need to repeat the argument of a function (see also below ):</li>
</ol>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># recreate and add B in mT, i.e. `B_mT` column</span></span>
<span><span class="va">df.example.01</span> <span class="op">|&gt;</span> </span>
<span>  <span class="va">_</span><span class="op">$</span><span class="va">B_mT</span> <span class="op">&lt;-</span> <span class="va">df.example.01</span><span class="op">$</span><span class="va">B_G</span> <span class="op">*</span> <span class="fl">0.1</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># plot simple epr spectrum</span></span>
<span><span class="va">df.example.01</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>    <span class="va">.</span><span class="op">$</span><span class="va">B_mT</span>,</span>
<span>    <span class="va">.</span><span class="op">$</span><span class="va">dIepr_over_dB</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"l"</span>, <span class="co"># l = "line"</span></span>
<span>    <span class="co"># axis labels:</span></span>
<span>    xlab <span class="op">=</span> <span class="st">"B (mT)"</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">"dIepr / dB (p.d.u.)"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="firstSteps_files/figure-html/pipe-operator-placeholder-1.png"><!-- --></p>
<p>where <code>_</code> works with <code>|&gt;</code> and the <code>.</code> placeholder is to be used with ‚Äúmagrittr‚Äù pipe <code>%&gt;%</code> . However, one could also apply the ‚Äúdot‚Äù placeholder with the native pipe operator with a few tricks <span class="citation">(<a href="#ref-velasquez2022">9</a>)</span>.</p>
<p>The pipe operator has its own keyboard shortcut: <code>ctrl(cmd)</code> + <code>shift</code> + <code>m</code> depending on the settings. Within the Rstudio go to <code>Tools</code> ‚ûù <code>Global Options...</code> ‚ûù <code>Code</code> (left-hand panel) and finally activate or deactivate the check box ‚Äú<strong>Use native pipe operator, |&gt; (requires R 4.1+)</strong>‚Äù like depicted in Figure <a href="#fig:rstudio-pipe-setup">4.1</a>.</p>
<div class="figure">
<span style="display:block;" id="fig:rstudio-pipe-setup"></span>
<img src="Rstudio_pipe_setup_a.png" alt="Pipe operator setup within the Rstudio Options." width="91%"><p class="caption">
Figure 4.1: Pipe operator setup within the Rstudio Options.
</p>
</div>
<p>Due to the above-mentioned reasons (mainly due to the compatibility) the <a href="https://jatanrt.github.io/eprscope/">eprscope</a> primarily uses the <a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a> type operator, even though the native one can be applied as well, keeping in mind its limitations. If the <a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a> üì¶ bundle is already installed and loaded, we may perform the above-described data frame operations by the included packages (mainly by <a href="https://dplyr.tidyverse.org/index.html" class="external-link">{dplyr}</a>) as shown below.</p>
<p>Create a vector from the column of a data frame:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># selecting column (`B_G`) from data </span></span>
<span><span class="co"># frame by pipe and `$` operators</span></span>
<span><span class="va">vec.B.G.d</span> <span class="op">&lt;-</span> <span class="va">df.example.01</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">B_G</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview of the first 10 values</span></span>
<span><span class="va">vec.B.G.d</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] 3439.1699 3439.2200 3439.2700 3439.3201 3439.3701 3439.4199 3439.4700</span></span>
<span><span class="co">#&gt;  [8] 3439.5200 3439.5701 3439.6201</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...similar operation by the `{dplyr}`</span></span>
<span><span class="co"># `select()` function where the output</span></span>
<span><span class="co"># corresponds to data frame, therefore</span></span>
<span><span class="va">vec.B.G.e</span> <span class="op">&lt;-</span> <span class="va">df.example.01</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">B_G</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="va">unlist</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="va">as.vector</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview of the first 10 values</span></span>
<span><span class="va">vec.B.G.e</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] 3439.1699 3439.2200 3439.2700 3439.3201 3439.3701 3439.4199 3439.4700</span></span>
<span><span class="co">#&gt;  [8] 3439.5200 3439.5701 3439.6201</span></span></code></pre></div>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code> function can be also applied to drop columns as well as to select columns, resulting in data frame, by specific conditions or with specific names (see the related <a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">documentation</a>).</p>
<p>Create a new column by the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> function:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># create a new `B_T` column</span></span>
<span><span class="va">df.example.02</span> <span class="op">&lt;-</span> <span class="va">df.example.01</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>B_T <span class="op">=</span> <span class="va">B_G</span> <span class="op">*</span> <span class="fl">1e-4</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df.example.02</span><span class="op">)</span></span>
<span><span class="co">#&gt;          B_G dIepr_over_dB   g_Val      B_mT        B_T</span></span>
<span><span class="co">#&gt;        &lt;num&gt;         &lt;num&gt;   &lt;num&gt;     &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 3439.1699 -56.047361607 2.05515 343.91699 0.34391699</span></span>
<span><span class="co">#&gt; 2: 3439.2200 -30.506506697 2.05512 343.92200 0.34392200</span></span>
<span><span class="co">#&gt; 3: 3439.2700 -38.522218750 2.05509 343.92700 0.34392700</span></span>
<span><span class="co">#&gt; 4: 3439.3201   0.039208426 2.05506 343.93201 0.34393201</span></span>
<span><span class="co">#&gt; 5: 3439.3701 -92.620223214 2.05503 343.93701 0.34393701</span></span>
<span><span class="co">#&gt; 6: 3439.4199 -71.915075893 2.05500 343.94199 0.34394199</span></span></code></pre></div>
<p>Basic filtering by the <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter()</a></code> , where either <code>|&gt;</code> or <code>%&gt;%</code> can be applied:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># filter the `B_G`/`B_mT` </span></span>
<span><span class="co"># values &lt;= central field</span></span>
<span><span class="va">df.example.03</span> <span class="op">&lt;-</span> <span class="va">df.example.02</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">B_G</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">B_G</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="va">df.example.03</span></span>
<span><span class="co">#&gt;             B_G  dIepr_over_dB   g_Val      B_mT        B_T</span></span>
<span><span class="co">#&gt;           &lt;num&gt;          &lt;num&gt;   &lt;num&gt;     &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt;    1: 3439.1699 -5.6047362e+01 2.05515 343.91699 0.34391699</span></span>
<span><span class="co">#&gt;    2: 3439.2200 -3.0506507e+01 2.05512 343.92200 0.34392200</span></span>
<span><span class="co">#&gt;    3: 3439.2700 -3.8522219e+01 2.05509 343.92700 0.34392700</span></span>
<span><span class="co">#&gt;    4: 3439.3201  3.9208426e-02 2.05506 343.93201 0.34393201</span></span>
<span><span class="co">#&gt;    5: 3439.3701 -9.2620223e+01 2.05503 343.93701 0.34393701</span></span>
<span><span class="co">#&gt;   ---                                                      </span></span>
<span><span class="co">#&gt; 1197: 3498.9700 -3.0236329e+04 2.02002 349.89700 0.34989700</span></span>
<span><span class="co">#&gt; 1198: 3499.0200 -2.8497177e+04 2.01999 349.90200 0.34990200</span></span>
<span><span class="co">#&gt; 1199: 3499.0701 -2.6060546e+04 2.01997 349.90701 0.34990701</span></span>
<span><span class="co">#&gt; 1200: 3499.1201 -2.3374619e+04 2.01994 349.91201 0.34991201</span></span>
<span><span class="co">#&gt; 1201: 3499.1699 -1.9964416e+04 2.01991 349.91699 0.34991699</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># find the `B_mT` corresponding</span></span>
<span><span class="co"># to the maximum of `dIepr_over_dB` intensity</span></span>
<span><span class="va">df.example.02</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dIepr_over_dB</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">dIepr_over_dB</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">B_mT</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 350.04199</span></span></code></pre></div>
<p>Filter values within a specific <code>g_Val</code> <strong>range</strong> (see the function <code><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">dplyr::between()</a></code>) and <strong>rename</strong> the column:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df.example.04</span> <span class="op">&lt;-</span> <span class="va">df.example.03</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="va">g_Val</span>,<span class="fl">2.0548</span>,<span class="fl">2.0550</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># rename syntax: "new name = old name":</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>g_Fac <span class="op">=</span> <span class="va">g_Val</span><span class="op">)</span> </span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="va">df.example.04</span></span>
<span><span class="co">#&gt;          B_G dIepr_over_dB   g_Fac      B_mT        B_T</span></span>
<span><span class="co">#&gt;        &lt;num&gt;         &lt;num&gt;   &lt;num&gt;     &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 3439.4199    -71.915076 2.05500 343.94199 0.34394199</span></span>
<span><span class="co">#&gt; 2: 3439.4700    -91.175652 2.05497 343.94700 0.34394700</span></span>
<span><span class="co">#&gt; 3: 3439.5200   -123.382795 2.05494 343.95200 0.34395200</span></span>
<span><span class="co">#&gt; 4: 3439.5701    -17.007363 2.05491 343.95701 0.34395701</span></span>
<span><span class="co">#&gt; 5: 3439.6201    110.252063 2.05488 343.96201 0.34396201</span></span>
<span><span class="co">#&gt; 6: 3439.6699    155.386643 2.05485 343.96699 0.34396699</span></span>
<span><span class="co">#&gt; 7: 3439.7200     12.876637 2.05482 343.97200 0.34397200</span></span></code></pre></div>
</div>
<div class="section level3" number="4.4">
<h3 id="sec-tidy-and-messy-data">
<span class="header-section-number">4.4</span> Tidy and Messy Data<a class="anchor" aria-label="anchor" href="#sec-tidy-and-messy-data"></a>
</h3>
<p>Last example of data handling (see below), using the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> and the pipe operator, will show the processing and analysis of EPR time series (kinetics). In the first step, the ‚Äúkinetic‚Äù data must be loaded from the <code>.zip</code> file :</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># loading the package built-in example file/data </span></span>
<span><span class="co"># kinetics -&gt; "Triarylamine_radCat_decay_series",</span></span>
<span><span class="co"># file with instrumental parameters</span></span>
<span><span class="va">triarylam.decay.series.dsc.path</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/load_data_example.html">load_data_example</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="st">"Triarylamine_radCat_decay_series.DSC"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ascii table in the form of `.zip`</span></span>
<span><span class="va">triarylam.decay.series.asc.path</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/load_data_example.html">load_data_example</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="st">"Triarylamine_radCat_decay_series.zip"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># unzip the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span></span>
<span>  <span class="va">triarylam.decay.series.asc.path</span>,</span>
<span>  exdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Finally, the data is transformed into the data frame by the <code><a href="../reference/readEPR_Exp_Specs_kin.html">readEPR_Exp_Specs_kin()</a></code> function:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># reading the data and correcting</span></span>
<span><span class="co"># the recording time for each CW EPR spectrum</span></span>
<span><span class="va">triarylam.decay.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readEPR_Exp_Specs_kin.html">readEPR_Exp_Specs_kin</a></span><span class="op">(</span></span>
<span>  name.root <span class="op">=</span> <span class="st">"Triarylamine_radCat_decay_series"</span>,</span>
<span>  dir_ASC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dir_dsc_par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,package <span class="op">=</span> <span class="st">"eprscope"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">triarylam.decay.dat</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;    index       B_G time_s  dIepr_over_dB      B_mT</span></span>
<span><span class="co">#&gt;    &lt;int&gt;     &lt;num&gt;  &lt;num&gt;          &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     1 3390.0000      6  1.3629316e-05 339.00000</span></span>
<span><span class="co">#&gt; 2:     2 3390.0833      6 -1.0134169e-06 339.00833</span></span>
<span><span class="co">#&gt; 3:     3 3390.1667      6 -1.9794802e-05 339.01667</span></span>
<span><span class="co">#&gt; 4:     4 3390.2500      6 -2.9826537e-05 339.02500</span></span>
<span><span class="co">#&gt; 5:     5 3390.3333      6 -1.6870754e-05 339.03333</span></span>
<span><span class="co">#&gt; 6:     6 3390.4167      6  2.5629187e-06 339.04167</span></span></code></pre></div>
<p>Such ‚Äúcomplex‚Äù loading and reading is required because the kinetic data is relatively large and therefore in a compressed form stored within the package. Otherwise, all one has to do is just to define the file path for both parameter as well as ASCII table files (see also documentation of the <code><a href="../reference/readEPR_Exp_Specs_kin.html">readEPR_Exp_Specs_kin()</a></code>). Because the <code>triarylam.decay.dat</code> is list (see below), it consists of two components: the data frame <code>df</code> and the vector of corrected <code>time</code> at which the middle of CW EPR spectrum appears. It can be figured out that the <code>df</code> -structure actually inherits that of the original ASCII data file coming from the EPR spectrometer. Moreover, such structure corresponds to <strong>‚Äútidy‚Äù data</strong> because each column represents a variable and each row represents an observation <span class="citation">(<a href="#ref-RfDSWickham2023">10</a>, <a href="#ref-tidyWickham2014">11</a>)</span>. Tidy data provides a standardized way how to link the structure of a dataset (the physical layout) with its semantics (meaning). If the data frame would possess the form of <strong>‚Äúmessy‚Äù data</strong> (any other data form, different from ‚Äútidy‚Äù), each spectrum (its <code>dIepr_over_dB</code> intensity), at a certain time, would correspond to one column. As an example of ‚Äúmessy‚Äù dataset we may transform the above-mentioned ‚Äútidy‚Äù one using the <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">tidyr::pivot_wider()</a></code> :</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">triarylam.decay.dat.wide</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">triarylam.decay.dat</span><span class="op">$</span><span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># remove `index` column</span></span>
<span>  <span class="co"># in order to work with `pivot_wider`:</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">index</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">time_s</span>,</span>
<span>    <span class="co"># define column headers:</span></span>
<span>    names_prefix <span class="op">=</span> <span class="st">"time_s_"</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">dIepr_over_dB</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">triarylam.decay.dat.wide</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 √ó 102</span></span></span>
<span><span class="co">#&gt;     B_G  B_mT    time_s_6   time_s_21   time_s_36  time_s_51 time_s_66 time_s_81</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="text-decoration: underline;">3</span>390   339   0.000<span style="text-decoration: underline;">013</span>6  0.000<span style="text-decoration: underline;">024</span>7   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">005</span><span style="color: #BB0000;">61</span>   -<span style="color: #BB0000;">2.52</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   1.33<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>  -<span style="color: #BB0000;">6.53</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="text-decoration: underline;">3</span>390.  339. -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">001</span><span style="color: #BB0000;">01</span> 0.000<span style="text-decoration: underline;">024</span>0    0.000<span style="text-decoration: underline;">003</span>48   -<span style="color: #BB0000;">2.85</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>  -<span style="color: #BB0000;">2.12</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   1.06<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="text-decoration: underline;">3</span>390.  339. -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">019</span><span style="color: #BB0000;">8</span>  0.000<span style="text-decoration: underline;">015</span>0    0.000<span style="text-decoration: underline;">005</span>77   -<span style="color: #BB0000;">1.52</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>  -<span style="color: #BB0000;">1.58</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   6.11<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="text-decoration: underline;">3</span>390.  339. -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">029</span><span style="color: #BB0000;">8</span>  0.000<span style="text-decoration: underline;">000</span>904  0.000<span style="text-decoration: underline;">006</span>33    2.26<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   1.59<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>  -<span style="color: #BB0000;">1.43</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> <span style="text-decoration: underline;">3</span>390.  339. -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">016</span><span style="color: #BB0000;">9</span>  0.000<span style="text-decoration: underline;">013</span>7    0.000<span style="text-decoration: underline;">011</span>6     9.32<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>  -<span style="color: #BB0000;">3.76</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   6.16<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> <span style="text-decoration: underline;">3</span>390.  339.  0.000<span style="text-decoration: underline;">002</span>56 0.000<span style="text-decoration: underline;">024</span>9    0.000<span style="text-decoration: underline;">027</span>4    -<span style="color: #BB0000;">4.11</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>  -<span style="color: #BB0000;">2.24</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   3.71<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ‚Ñπ 94 more variables: time_s_95 &lt;dbl&gt;, time_s_110 &lt;dbl&gt;, time_s_125 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   time_s_140 &lt;dbl&gt;, time_s_155 &lt;dbl&gt;, time_s_170 &lt;dbl&gt;, time_s_184 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   time_s_199 &lt;dbl&gt;, time_s_214 &lt;dbl&gt;, time_s_229 &lt;dbl&gt;, time_s_244 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   time_s_259 &lt;dbl&gt;, time_s_274 &lt;dbl&gt;, time_s_288 &lt;dbl&gt;, time_s_303 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   time_s_318 &lt;dbl&gt;, time_s_333 &lt;dbl&gt;, time_s_348 &lt;dbl&gt;, time_s_363 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   time_s_378 &lt;dbl&gt;, time_s_392 &lt;dbl&gt;, time_s_407 &lt;dbl&gt;, time_s_422 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   time_s_437 &lt;dbl&gt;, time_s_452 &lt;dbl&gt;, time_s_467 &lt;dbl&gt;, time_s_482 &lt;dbl&gt;, ‚Ä¶</span></span></span></code></pre></div>
<p>Even at the first sight, such data structure might look more organized, they are not. Especially, the high number of columns makes it a little bit cluttered in comparison to <code>triarylam.decay.dat$df</code> . Additionally, all those columns actually represent only one variable, which is the derivative EPR intensity <code>dIepr_over_dB</code> . Now, in order to filter, plot and/or analyze the EPR spectra at different times we would need a different strategies how to do it. For example, to filter/select and plot spectra in the time span of <span class="math inline">\(\small (200-300)\,\mathrm{s}\)</span>, we must now the names of the corresponding columns<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Instead of names like &lt;code&gt;time_s_...&lt;/code&gt; with times in seconds, we might use just numbers. However, in such case it is actually not clear what those values do correspond to. Additionally, column headers must be expressed by names/strings, not by values.&lt;/p&gt;"><sup>3</sup></a> ‚û® we have to filter/select the strings:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># 1. Which "times" between 100-300 s ?</span></span>
<span><span class="va">time.vec</span> <span class="op">&lt;-</span> <span class="va">triarylam.decay.dat</span><span class="op">$</span><span class="va">time</span> <span class="co"># this is vector</span></span>
<span><span class="va">time.span</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">time.vec</span><span class="op">[</span><span class="va">time.vec</span> <span class="op">&gt;</span> <span class="fl">200</span> <span class="op">&amp;</span> <span class="va">time.vec</span> <span class="op">&lt;</span> <span class="fl">300</span><span class="op">]</span> <span class="co"># filtering</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># 2. Create the string vector </span></span>
<span><span class="co"># of the corresponding column names.</span></span>
<span><span class="co"># This is to be performed by loop.</span></span>
<span><span class="va">time.string.vec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">time.span</span>, <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"time_s_"</span>,<span class="va">s</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># 3. Add magetic flux density column names</span></span>
<span><span class="co"># like `B_mT` and `B_G`</span></span>
<span><span class="va">time.string.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B_G"</span>,<span class="st">"B_mT"</span>,<span class="va">time.string.vec</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># 4. Data frame and preview</span></span>
<span><span class="va">triarylam.decay.filter.df.wide</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">triarylam.decay.dat.wide</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">time.string.vec</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#</span></span>
<span><span class="va">triarylam.decay.filter.df.wide</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,400 √ó 8</span></span></span>
<span><span class="co">#&gt;      B_G  B_mT time_s_214 time_s_229 time_s_244 time_s_259 time_s_274 time_s_288</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">3</span>390   339     1.28<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   -<span style="color: #BB0000;">1.87</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   -<span style="color: #BB0000;">1.39</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   -<span style="color: #BB0000;">1.67</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   -<span style="color: #BB0000;">1.93</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   -<span style="color: #BB0000;">1.38</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">3</span>390.  339.    4.55<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   -<span style="color: #BB0000;">2.20</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   -<span style="color: #BB0000;">2.01</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   -<span style="color: #BB0000;">8.38</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   -<span style="color: #BB0000;">1.04</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    2.47<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">3</span>390.  339.    6.12<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>    6.76<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   -<span style="color: #BB0000;">2.44</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    1.54<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    3.91<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   -<span style="color: #BB0000;">2.31</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">3</span>390.  339.   -<span style="color: #BB0000;">3.15</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>    8.90<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   -<span style="color: #BB0000;">8.47</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-8</span>    4.15<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>    1.67<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   -<span style="color: #BB0000;">2.28</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">3</span>390.  339.   -<span style="color: #BB0000;">1.93</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    9.59<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>    2.63<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    2.33<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   -<span style="color: #BB0000;">1.16</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    1.38<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">3</span>390.  339.   -<span style="color: #BB0000;">2.48</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   -<span style="color: #BB0000;">1.87</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    2.37<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    3.21<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>    1.62<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>    1.81<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">3</span>390.  339.   -<span style="color: #BB0000;">1.68</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    8.09<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>    1.26<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   -<span style="color: #BB0000;">2.05</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    8.50<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   -<span style="color: #BB0000;">1.62</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">3</span>391.  339.    1.73<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   -<span style="color: #BB0000;">1.95</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    2.05<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>   -<span style="color: #BB0000;">9.21</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>    2.79<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   -<span style="color: #BB0000;">3.27</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">3</span>391.  339.   -<span style="color: #BB0000;">1.46</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    3.66<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>    5.74<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   -<span style="color: #BB0000;">2.80</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    4.04<span style="color: #949494;">e</span><span style="color: #BB0000;">-7</span>   -<span style="color: #BB0000;">2.71</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">3</span>391.  339.    4.70<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>    3.12<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    4.59<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   -<span style="color: #BB0000;">1.71</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    7.41<span style="color: #949494;">e</span><span style="color: #BB0000;">-7</span>   -<span style="color: #BB0000;">9.68</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ‚Ñπ 2,390 more rows</span></span></span></code></pre></div>
<p>Plotting all those spectra at once is only possible by the ‚Äúindividual‚Äù <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">ggplot2::geom_line()</a></code> functions, like:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">triarylam.decay.filter.df.wide</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># plot base:</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">B_G</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># individual lines:</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">time_s_214</span>,color <span class="op">=</span> <span class="st">"214"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">time_s_229</span>,color <span class="op">=</span> <span class="st">"229"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">time_s_244</span>,color <span class="op">=</span> <span class="st">"244"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">time_s_259</span>,color <span class="op">=</span> <span class="st">"259"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">time_s_274</span>,color <span class="op">=</span> <span class="st">"274"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">time_s_288</span>,color <span class="op">=</span> <span class="st">"288"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labels:</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="st">"Time (s)"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"B (G)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"dIepr / dB (p.d.u.)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># plot theme:</span></span>
<span>  <span class="fu"><a href="../reference/plot_theme_In_ticks.html">plot_theme_In_ticks</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="firstSteps_files/figure-html/messy-data-anal-plot-02-1.png"><!-- --></p>
<p>Apparently, working with the ‚Äúmessy‚Äù data (particularly using the <a href="https://www.tidyverse.org/packages/" class="external-link"><code>{tidyverse}</code></a> and <a href="https://ggplot2.tidyverse.org/" class="external-link"><code>{ggplot2}</code></a> bundles) is quite complicated, even though we may transform the <code>triarylam.decay.filter.df.wide</code> back to ‚Äútidy‚Äù or long table format by <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">tidyr::pivot_longer()</a></code> :</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">triarylam.decay.dat.filter.long</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">triarylam.decay.filter.df.wide</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    <span class="co"># the following columns are not included </span></span>
<span>    <span class="co"># in transformation:</span></span>
<span>    <span class="op">!</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B_G"</span>,<span class="st">"B_mT"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co"># transformation:</span></span>
<span>    names_to <span class="op">=</span> <span class="st">"time_s"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"dIepr_over_dB"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">time_s</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># tidy data frame (long form) preview</span></span>
<span><span class="va">triarylam.decay.dat.filter.long</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14,400 √ó 4</span></span></span>
<span><span class="co">#&gt;      B_G  B_mT time_s     dIepr_over_dB</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">3</span>390   339  time_s_214    0.000<span style="text-decoration: underline;">012</span>8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">3</span>390.  339. time_s_214    0.000<span style="text-decoration: underline;">004</span>55</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">3</span>390.  339. time_s_214    0.000<span style="text-decoration: underline;">006</span>12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">3</span>390.  339. time_s_214   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">003</span><span style="color: #BB0000;">15</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">3</span>390.  339. time_s_214   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">019</span><span style="color: #BB0000;">3</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">3</span>390.  339. time_s_214   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">024</span><span style="color: #BB0000;">8</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">3</span>390.  339. time_s_214   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">016</span><span style="color: #BB0000;">8</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">3</span>391.  339. time_s_214    0.000<span style="text-decoration: underline;">001</span>73</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">3</span>391.  339. time_s_214   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">014</span><span style="color: #BB0000;">6</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">3</span>391.  339. time_s_214    0.000<span style="text-decoration: underline;">004</span>70</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ‚Ñπ 14,390 more rows</span></span></span></code></pre></div>
<p>The corresponding EPR spectra can be visualized easier than before, applying the <code>color</code> argument :</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">triarylam.decay.dat.filter.long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">B_G</span>,y <span class="op">=</span> <span class="va">dIepr_over_dB</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">time_s</span><span class="op">)</span>,linewidth <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"B (G)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"dIepr / dB (p.d.u.)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/plot_theme_In_ticks.html">plot_theme_In_ticks</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="firstSteps_files/figure-html/messy-data-anal-plot-04-1.png"><!-- --></p>
<p>By using the original ‚Äútidy‚Äù data frame (<code>triarylam.decay.dat$df</code>) one can therefore nicely perform the filtering and plotting, literally in one ‚Äúbigger‚Äù step (together with the application of pipe operator):</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">triarylam.decay.dat</span><span class="op">$</span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># filtering/time span:</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="va">time_s</span>,<span class="fl">200</span>,<span class="fl">300</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># next step required for the discrete spectra visualization</span></span>
<span>  <span class="co"># (otherwise, continuous will be displayed)</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>time_s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">time_s</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># own plot:</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">B_G</span>,y <span class="op">=</span> <span class="va">dIepr_over_dB</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">time_s</span><span class="op">)</span>,linewidth <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="fu"><a href="../reference/plot_labels_xyz.html">plot_labels_xyz</a></span><span class="op">(</span><span class="va">Time</span>,<span class="va">s</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fu"><a href="../reference/plot_labels_xyz.html">plot_labels_xyz</a></span><span class="op">(</span><span class="va">B</span>,<span class="va">G</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="../reference/plot_labels_xyz.html">plot_labels_xyz</a></span><span class="op">(</span><span class="va">d</span><span class="op">*</span><span class="fu">italic</span><span class="op">(</span><span class="va">I</span><span class="op">)</span><span class="op">[</span><span class="va">EPR</span><span class="op">]</span><span class="op">~</span><span class="st">"/"</span><span class="op">~</span><span class="va">d</span><span class="op">*</span><span class="fu">italic</span><span class="op">(</span><span class="va">B</span><span class="op">)</span>,<span class="va">p.d.u.</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/plot_theme_In_ticks.html">plot_theme_In_ticks</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="firstSteps_files/figure-html/tidy-data-anal-plot-1.png"><!-- --></p>
<div class="section level4" number="4.4.1">
<h4 id="processing-and-analysis-of-kinetic-data">
<span class="header-section-number">4.4.1</span> Processing and Analysis of Kinetic Data<a class="anchor" aria-label="anchor" href="#processing-and-analysis-of-kinetic-data"></a>
</h4>
<p>Such tidy data makes it easy for an analyst or a computer to repeatedly extract needed variables because it provides a standard and consistent way of structuring a dataset <span class="citation">(<a href="#ref-tidyWickham2014">11</a>)</span>. Finally, this data structure also helps us, relatively easily, to (double-)integrate the entire series of EPR spectra in order to figure out the basic information about the kinetics of triaryalmine radical decay:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">triarylam.decay.integs.01</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">triarylam.decay.dat</span><span class="op">$</span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># group Intensity vs B for each time point:</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">time_s</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># for each time point create double integral (column):</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      double_Integ <span class="op">=</span></span>
<span>        <span class="fu"><a href="../reference/eval_integ_EPR_Spec.html">eval_integ_EPR_Spec</a></span><span class="op">(</span></span>
<span>          <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pick.html" class="external-link">pick</a></span><span class="op">(</span><span class="va">B_G</span>,<span class="va">dIepr_over_dB</span><span class="op">)</span>,</span>
<span>          <span class="co"># correct the single integral baseline:</span></span>
<span>          correct.integ <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          <span class="co"># ...in the range of the peak:</span></span>
<span>          BpeaKlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3473.5</span>,<span class="fl">3502.5</span><span class="op">)</span>,</span>
<span>          <span class="co"># ...by the 5th order plynomial:</span></span>
<span>          poly.degree <span class="op">=</span> <span class="fl">5</span>,</span>
<span>          <span class="co"># provide double integrals:</span></span>
<span>          sigmoid.integ <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          <span class="co"># ...in the vector form:</span></span>
<span>          output.vecs <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>        <span class="op">)</span><span class="op">$</span><span class="va">sigmoid</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># summarize the sigmoid integral max. values</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>Area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">double_Integ</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># data frame preview</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">triarylam.decay.integs.01</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 √ó 2</span></span></span>
<span><span class="co">#&gt;   time_s   Area</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      6 0.018<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     21 0.019<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     36 0.018<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     51 0.020<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     66 0.021<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     81 0.018<span style="text-decoration: underline;">0</span></span></span></code></pre></div>
<p>Assuming the radical (<span class="math inline">\(\small \mathrm{R}\)</span>) recombination, forming a dimer (<span class="math inline">\(\small \mathrm{D}\)</span>):</p>
<p><span class="math display" id="eq:dimer">\[\begin{equation}
\small 2\,\ce{R -&gt;[k_1] D}
\tag{4.1}
\end{equation}\]</span></p>
<p>one can try to fit the latter <em>Area (Double Integral) vs time</em> relation, by the above-mentioned kinetic model, to estimate the kinetic rate constant <span class="math inline">\(\small k_1\)</span> <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Because the double integral is directly proportional to the concentration of radicals &lt;span class="math inline"&gt;\(\mathrm{R}\)&lt;/span&gt; for a quick preview (or comparison with other kinetic data) we can use such estimation based on integrals/areas. Consequently, the unit of the rate constant (corresponding to radical recombination) will be expressed in: &lt;span class="math inline"&gt;\([k_1] = (\mathrm{p.d.u.})^{-1}\, \mathrm{s}^{-1}\)&lt;/span&gt;.&lt;/p&gt;'><sup>4</sup></a>:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dimer.kinetics.01</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/eval_kinR_EPR_modelFit.html">eval_kinR_EPR_modelFit</a></span><span class="op">(</span></span>
<span>    <span class="co"># previous data frame:</span></span>
<span>    data.qt.expr <span class="op">=</span> <span class="va">triarylam.decay.integs.01</span>,</span>
<span>    model.react <span class="op">=</span> <span class="st">"(r=2)R --&gt; [k1] B"</span>,</span>
<span>    <span class="co"># named vector of initial kinetic parameters:</span></span>
<span>    params.guess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>qvar0R <span class="op">=</span> <span class="fl">0.02</span>, k1 <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># plot preview</span></span>
<span><span class="va">dimer.kinetics.01</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="firstSteps_files/figure-html/kinetics-fit-01-1.png"><!-- --></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#</span></span>
<span><span class="co"># kinetic parameters with statistical measures</span></span>
<span><span class="va">dimer.kinetics.01</span><span class="op">$</span><span class="va">df.coeff</span></span>
<span><span class="co">#&gt;           Estimate   Std. Error   t value      Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; qvar0R 0.019251201 0.0003640483 52.880897 7.3508015e-74</span></span>
<span><span class="co">#&gt; k1     0.020585085 0.0009419355 21.854029 1.8581164e-39</span></span></code></pre></div>
<p>Obviously, according to statistical measures of non-linear regression/fitting parameters, the second-order kinetic model is suitable for description of triarylamine radical cation decay. This is also supported by the analysis of residuals/errors of the model/fit (please, refer also to the <code><a href="../reference/plot_eval_RA_forFit.html">plot_eval_RA_forFit()</a></code> function documentation):</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dimer.kinetics.01</span><span class="op">$</span><span class="va">ra</span><span class="op">$</span><span class="va">plot.rqq</span></span></code></pre></div>
<p><img src="firstSteps_files/figure-html/kinetics-fit-01-residuals-1.png"><!-- --></p>
<p>However, it is evident that its dispersion ‚û® variance and the standard deviation of residuals are slightly high along the fitted/predicted values:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># residual sample variance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">dimer.kinetics.01</span><span class="op">$</span><span class="va">ra</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.5674959e-06</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># residuals sd</span></span>
<span><span class="va">dimer.kinetics.01</span><span class="op">$</span><span class="va">ra</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="co">#&gt; [1] 0.0012648481</span></span></code></pre></div>
<p>This is likely due to the noisy baseline in the EPR spectra as shown in the Section <a href="#sec-tidy-and-messy-data">4.4</a> and the subsequent integration. However, by the simulation and fitting of the simulated spectra onto the experimental ones, we can obtain much better results as shown by <code>Examples</code> in the <code><a href="../reference/eval_kinR_EPR_modelFit.html">eval_kinR_EPR_modelFit()</a></code> function documentation.</p>
</div>
</div>
</div>
<div class="section level2" number="5">
<h2 id="lists">
<span class="header-section-number">5</span> Lists<a class="anchor" aria-label="anchor" href="#lists"></a>
</h2>
<p>List is a generic object similar to vector (see Section <a href="#vectors-mats">3</a>), however instead of bearing homogeneous data types, it may contain heterogeneous ones. This is due to the fact that sometimes we may want to link different types of information together, while preserving their origin. Therefore, the lists elements/components can possess the form of numeric values, vectors, matrices, functions, data frames/tables, strings‚Ä¶etc. As an example, let‚Äôs check out the previous <code>dimer.kinetics.01</code> variable:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">dimer.kinetics.01</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "list"</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># alternatively, the data type can be also</span></span>
<span><span class="co"># checked by the following functions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html" class="external-link">typeof</a></span><span class="op">(</span><span class="va">dimer.kinetics.01</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "list"</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...or </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">dimer.kinetics.01</span><span class="op">)</span> <span class="co"># is it a list ?</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>The <code>dimer.kinetics.01</code> consists of the following elements:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># How many components ?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dimer.kinetics.01</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># What are their names ?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dimer.kinetics.01</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "df"        "plot"      "ra"        "df.coeffs" "N.evals"   "min.rss"  </span></span>
<span><span class="co">#&gt; [7] "abic"      "N.converg"</span></span></code></pre></div>
<p>They are described in details in documentation of the <code><a href="../reference/eval_kinR_EPR_modelFit.html">eval_kinR_EPR_modelFit()</a></code> function and in summary correspond to data frames (<code>df</code> + <code>df.coeffs</code>), plot object (<code>plot</code> , which is also a list) , additional lists (<code>ra</code> + <code>abic</code>), numeric values (<code>N.evals</code> + <code>min.rss</code>) and numeric vector (<code>N.converg</code>). Many <img src="RcoreLogo.png" width="16" height="16"> package functions return value(s) in the form of list(s).</p>
<p>As shown above (see Section <a href="#data-frames">4</a>), to select/view a specific data frame column, one can use two types of operators: <code>$</code> (dollar sign) and <code>[]</code> or <code>[[]]</code> (square brackets). The same applies for the lists as it was depicted in several code snippets/code chunks above, using the <code>$</code> operator. For example to show/select the vector, corresponding to residual sum of squares at each iteration/evaluation (for the kinetic model fit), we apply:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># select the element by `$` operator</span></span>
<span><span class="va">dimer.kinetics.01</span><span class="op">$</span><span class="va">N.converg</span></span>
<span><span class="co">#&gt; [1] 0.00109349827 0.00018752167 0.00015530650 0.00015518458 0.00015518455</span></span>
<span><span class="co">#&gt; [6] 0.00015518455</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...or select the same by </span></span>
<span><span class="co"># double-square brackets</span></span>
<span><span class="va">dimer.kinetics.01</span><span class="op">[[</span><span class="st">"N.converg"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.00109349827 0.00018752167 0.00015530650 0.00015518458 0.00015518455</span></span>
<span><span class="co">#&gt; [6] 0.00015518455</span></span></code></pre></div>
<p>To <strong>select the</strong> <code>N.converg</code> <strong>component by the</strong> <code>$</code> <strong>operator, we do not have to remember its name</strong>. In most of the IDEs, by writing the commands/scripts, there is an automatic code completion. So, once you start to put <code>$</code> operator just behind the list variable name, all list elements appear in a popup window in order to select the desired one<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The same actually applies for data frames and their columns.&lt;/p&gt;"><sup>5</sup></a>.</p>
<p>In addition to double-square brackets, one may also choose single ones. However, this does not select the ‚Äúpure‚Äù list element and instead, it shows the element together with its name (actually corresponding to list, similarly to data frames with single-square bracket selection) like:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dimer.kinetics.01</span><span class="op">[</span><span class="st">"N.converg"</span><span class="op">]</span></span>
<span><span class="co">#&gt; $N.converg</span></span>
<span><span class="co">#&gt; [1] 0.00109349827 0.00018752167 0.00015530650 0.00015518458 0.00015518455</span></span>
<span><span class="co">#&gt; [6] 0.00015518455</span></span>
<span></span>
<span><span class="co"># What does the previous command/variable correspond to ?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">dimer.kinetics.01</span><span class="op">[</span><span class="st">"N.converg"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "list"</span></span></code></pre></div>
<p>If we want to choose an element form <code>N.converg</code> (e.g.¬†the last residual square sum), we can actually apply the following commands:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># the last residual square sum</span></span>
<span><span class="va">dimer.kinetics.01</span><span class="op">$</span><span class="va">N.converg</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dimer.kinetics.01</span><span class="op">$</span><span class="va">N.converg</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.00015518455</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...or by</span></span>
<span><span class="va">dimer.kinetics.01</span><span class="op">[[</span><span class="st">"N.converg"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dimer.kinetics.01</span><span class="op">$</span><span class="va">N.converg</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.00015518455</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># compare the previous one with residual analysis (`$ra`)</span></span>
<span><span class="co"># of the `dimer.kinetics.01`</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span></span>
<span>  <span class="va">dimer.kinetics.01</span><span class="op">[[</span><span class="st">"N.converg"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dimer.kinetics.01</span><span class="op">$</span><span class="va">N.converg</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">dimer.kinetics.01</span><span class="op">$</span><span class="va">ra</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>In terms of the previous definitions and list selections, creation of list is quite straightforward. As an example we may define system of nuclei, interacting with unpaired electron to simulate the <span class="math inline">\(\small \ce{TMPD^{.+}}\)</span> EPR spectrum, having the structure already depicted in <code><a href="../articles/functionality.html">vignette("functionality")</a></code> :</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># the following nested list, without names, </span></span>
<span><span class="co"># is a combination of strings and numbers</span></span>
<span><span class="va">nuclei.system</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"14N"</span>,<span class="fl">2</span>,<span class="fl">19.77</span><span class="op">)</span>, <span class="co"># A(2 x 14N) = 19.77 MHz</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"1H"</span>,<span class="fl">4</span>,<span class="fl">5.47</span><span class="op">)</span>, <span class="co"># A(4 x 1H) = 5.47 MHz</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"1H"</span>,<span class="fl">12</span>,<span class="fl">19.43</span><span class="op">)</span> <span class="co"># A(12 x 1H) = 19.43 MHz</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># preview of the `14N` nuclei</span></span>
<span><span class="va">nuclei.system</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] "14N"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 19.77</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...and their coupling constants A(2 x 14N)</span></span>
<span><span class="va">nuclei.system</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 19.77</span></span></code></pre></div>
<p>‚Ä¶with the simulation:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># simulation also returns a list</span></span>
<span><span class="va">tmpd.sim.list</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/eval_sim_EPR_iso.html">eval_sim_EPR_iso</a></span><span class="op">(</span></span>
<span>    g.iso <span class="op">=</span> <span class="fl">2.00304</span>,</span>
<span>    instrum.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      Bcf <span class="op">=</span> <span class="fl">3499.17</span>,</span>
<span>      Bsw <span class="op">=</span> <span class="fl">120</span>,</span>
<span>      Npoints <span class="op">=</span> <span class="fl">2401</span>,</span>
<span>      mwGHz <span class="op">=</span> <span class="fl">9.814155</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># previously defined system:</span></span>
<span>    nuclear.system <span class="op">=</span> <span class="va">nuclei.system</span>,</span>
<span>    lineG.content <span class="op">=</span> <span class="fl">0.64</span>,</span>
<span>    lineGL.DeltaB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.46</span>,<span class="fl">0.46</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...consisting of data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tmpd.sim.list</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Bsim_G Bsim_mT   Bsim_T dIeprSim_over_dB</span></span>
<span><span class="co">#&gt; 1 3439.17 343.917 0.343917    6.5577394e-07</span></span>
<span><span class="co">#&gt; 2 3439.22 343.922 0.343922    6.5921705e-07</span></span>
<span><span class="co">#&gt; 3 3439.27 343.927 0.343927    6.6274743e-07</span></span>
<span><span class="co">#&gt; 4 3439.32 343.932 0.343932    6.6637206e-07</span></span>
<span><span class="co">#&gt; 5 3439.37 343.937 0.343937    6.7009875e-07</span></span>
<span><span class="co">#&gt; 6 3439.42 343.942 0.343942    6.7393625e-07</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ...and the spectrum/plot</span></span>
<span><span class="va">tmpd.sim.list</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="firstSteps_files/figure-html/epr-spec-sim-example-tmpd-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body">
<div id="ref-assignR2018" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">CHRIS. <em>Assignment in r: Slings and arrows</em>. 2018. <a href="https://www.r-bloggers.com/2018/07/assignment-in-r-slings-and-arrows/" class="external-link uri">https://www.r-bloggers.com/2018/07/assignment-in-r-slings-and-arrows/</a>. </div>
</div>
<div id="ref-assignRb" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">FAY, Colin. <em>Why do we use arrow as an assignment operator?</em> 2018. <a href="https://www.r-bloggers.com/2018/09/why-do-we-use-arrow-as-an-assignment-operator/" class="external-link uri">https://www.r-bloggers.com/2018/09/why-do-we-use-arrow-as-an-assignment-operator/</a>. </div>
</div>
<div id="ref-RPeters2020" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">PETERS, Roel. <em>The difference between &lt;- and = assignment in r</em>. 2020. <a href="https://www.roelpeters.be/the-difference-between-arrow-and-equals-assignment-in-r/" class="external-link uri">https://www.roelpeters.be/the-difference-between-arrow-and-equals-assignment-in-r/</a>. </div>
</div>
<div id="ref-wickham2019" class="csl-entry">
<div class="csl-left-margin">4. </div>
<div class="csl-right-inline">WICKHAM, Hadley. <em>Advanced r</em> [online]. 2nd edition. Chapman; Hall/CRC, 2019. ISBN¬†9780815384571. Available from: <a href="https://adv-r.hadley.nz/" class="external-link">https://adv-r.hadley.nz/</a>
</div>
</div>
<div id="ref-GfG2023" class="csl-entry">
<div class="csl-left-margin">5. </div>
<div class="csl-right-inline">GEEGSFORGEEGS. <em>Packages in r programming</em>. 2023. <a href="https://www.geeksforgeeks.org/packages-in-r-programming/" class="external-link uri">https://www.geeksforgeeks.org/packages-in-r-programming/</a>. </div>
</div>
<div id="ref-wickham2023" class="csl-entry">
<div class="csl-left-margin">6. </div>
<div class="csl-right-inline">WICKHAM, Hadley and BRYAN, Jennifer. <em>R packages (2e)</em> [online]. 2nd edition. O‚ÄôReilly Media, 2023. ISBN¬†9781098134945. Available from: <a href="https://r-pkgs.org/" class="external-link">https://r-pkgs.org/</a>
</div>
</div>
<div id="ref-HansIUPAC2019" class="csl-entry">
<div class="csl-left-margin">7. </div>
<div class="csl-right-inline">HANSEN, Young Bae Lee. Recommendations on measurement units ‚Äì why and how. <em>eJ. Int. Fed. Clin. Chem. Lab. Med. (eJIFCC)</em> [online]. 2019. Vol.¬†30, no.¬†3, p.¬†250‚Äì275. Available from: <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC6803776/" class="external-link">https://pmc.ncbi.nlm.nih.gov/articles/PMC6803776/</a>
</div>
</div>
<div id="ref-dataCamp2022pipe" class="csl-entry">
<div class="csl-left-margin">8. </div>
<div class="csl-right-inline">WILLEMS, Karlijn. <em>Pipes in r tutorial for beginners</em>. 2022. <a href="https://www.datacamp.com/tutorial/pipe-r-tutorial" class="external-link uri">https://www.datacamp.com/tutorial/pipe-r-tutorial</a>. </div>
</div>
<div id="ref-velasquez2022" class="csl-entry">
<div class="csl-left-margin">9. </div>
<div class="csl-right-inline">VEL√ÅSQUEZ, Isabella. <em>Understanding the native r pipe</em>. 2022. <a href="https://ivelasq.rbind.io/blog/understanding-the-r-pipe/index.html" class="external-link uri">https://ivelasq.rbind.io/blog/understanding-the-r-pipe/index.html</a>. </div>
</div>
<div id="ref-RfDSWickham2023" class="csl-entry">
<div class="csl-left-margin">10. </div>
<div class="csl-right-inline">WICKHAM, Hadley, CETINKAYA-RUNDEL, Mine and GROLEMUND, Garett. <em>R for data science</em> [online]. 2nd edition. O‚ÄôReilly Media, 2023. ISBN¬†9781492097402. Available from: <a href="https://r4ds.hadley.nz/data-tidy.html#sec-tidy-data" class="external-link">https://r4ds.hadley.nz/data-tidy.html#sec-tidy-data</a>
</div>
</div>
<div id="ref-tidyWickham2014" class="csl-entry">
<div class="csl-left-margin">11. </div>
<div class="csl-right-inline">WICKHAM, Hadley. Tidy data. <em>J. Stat. Soft.</em> [online]. 2014. Vol.¬†59, no.¬†10, p.¬†1‚Äì23. Available from: <a href="https://www.jstatsoft.org/article/view/v059i10" class="external-link">https://www.jstatsoft.org/article/view/v059i10</a>
</div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by J√°n Tar√°bek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
