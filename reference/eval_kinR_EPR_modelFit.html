<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fitting of the integrals/areas/concentration/...etc. vs time relation (either from experiment
   or from integration of the EPR spectral time series) in order to find the kinetic parameters
   (like rate constant, \(k\) as well as (partial) reaction order(s)) of proposed radical reaction.
   Reaction model is taken from the eval_kinR_ODE_model, while the optimization/fitting
   is provided by the differential Levenberg-Marquardt optimization method, nls.lm.
   Because the radical concentration is directly proportional to the EPR spectrum (double)
   integral (see the quantify_EPR_Abs), for a quick evaluation and/or comparison of different
   kinetic data, it is possible to obtain the rate constants (\(k\)) by the integrals/areas vs time fit.
   Therefore, the unit of \(k\) is expressed in terms of \(\text{s}^{-1}\) as well as in units of integrals/areas,
   e.g. procedure defined unit (see p.d.u.),
   depending on the order of reaction (see the params.guess argument)."><title>Radical Kinetic Models Fitted onto Experimental Data — eval_kinR_EPR_modelFit • eprscope</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Radical Kinetic Models Fitted onto Experimental Data — eval_kinR_EPR_modelFit"><meta property="og:description" content="Fitting of the integrals/areas/concentration/...etc. vs time relation (either from experiment
   or from integration of the EPR spectral time series) in order to find the kinetic parameters
   (like rate constant, \(k\) as well as (partial) reaction order(s)) of proposed radical reaction.
   Reaction model is taken from the eval_kinR_ODE_model, while the optimization/fitting
   is provided by the differential Levenberg-Marquardt optimization method, nls.lm.
   Because the radical concentration is directly proportional to the EPR spectrum (double)
   integral (see the quantify_EPR_Abs), for a quick evaluation and/or comparison of different
   kinetic data, it is possible to obtain the rate constants (\(k\)) by the integrals/areas vs time fit.
   Therefore, the unit of \(k\) is expressed in terms of \(\text{s}^{-1}\) as well as in units of integrals/areas,
   e.g. procedure defined unit (see p.d.u.),
   depending on the order of reaction (see the params.guess argument)."><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eprscope</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.13</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/datasets.html">Package Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/firstSteps.html">First Steps with R Language</a></li>
    <li><a class="dropdown-item" href="../articles/functionality.html">Basic Functionality</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jatanrt/eprscope/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Radical Kinetic Models Fitted onto Experimental Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/jatanrt/eprscope/blob/master/R/eval_kinR_EPR_modelFit.R" class="external-link"><code>R/eval_kinR_EPR_modelFit.R</code></a></small>
      <div class="d-none name"><code>eval_kinR_EPR_modelFit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fitting of the integrals/areas/concentration/...etc. <em>vs</em> time relation (either from experiment
   or from integration of the EPR spectral time series) in order to find the kinetic parameters
   (like rate constant, \(k\) as well as (partial) reaction order(s)) of proposed radical reaction.
   Reaction model is taken from the <code><a href="eval_kinR_ODE_model.html">eval_kinR_ODE_model</a></code>, while the optimization/fitting
   is provided by the differential Levenberg-Marquardt optimization method, <code><a href="https://rdrr.io/pkg/minpack.lm/man/nls.lm.html" class="external-link">nls.lm</a></code>.
   Because the radical concentration is directly proportional to the EPR spectrum (double)
   integral (see the <code><a href="quantify_EPR_Abs.html">quantify_EPR_Abs</a></code>), for a quick evaluation and/or comparison of different
   kinetic data, it is possible to obtain the rate constants (\(k\)) by the integrals/areas <em>vs</em> time fit.
   Therefore, the unit of \(k\) is expressed in terms of \(\text{s}^{-1}\) as well as in units of integrals/areas,
   e.g. <code>procedure defined unit</code> (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6803776/" class="external-link">p.d.u.</a>),
   depending on the order of reaction (see the <code>params.guess</code> argument).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eval_kinR_EPR_modelFit</span><span class="op">(</span></span>
<span>  <span class="va">data.qt.expr</span>,</span>
<span>  time.unit <span class="op">=</span> <span class="st">"s"</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"time_s"</span>,</span>
<span>  qvarR <span class="op">=</span> <span class="st">"Area"</span>,</span>
<span>  model.react <span class="op">=</span> <span class="st">"(r=1)R --&gt; [k1] B"</span>,</span>
<span>  elementary.react <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  params.guess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>qvar0R <span class="op">=</span> <span class="fl">0.001</span>, k1 <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>,</span>
<span>  params.guess.lower <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  params.guess.upper <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fit.kin.method <span class="op">=</span> <span class="st">"diff-levenmarq"</span>,</span>
<span>  solve.ode.method <span class="op">=</span> <span class="st">"lsoda"</span>,</span>
<span>  time.frame.model <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  time.correct <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  path_to_dsc_par <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  origin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-qt-expr">data.qt.expr<a class="anchor" aria-label="anchor" href="#arg-data-qt-expr"></a></dt>
<dd><p>A data frame object, containing the concentrations/integral intensities/areas under
the EPR spectra calculated using the experimental data as well as time column. These two essential
columns are described by character strings like those below (see arguments <code>time</code> and <code>qvarR</code>).</p></dd>


<dt id="arg-time-unit">time.unit<a class="anchor" aria-label="anchor" href="#arg-time-unit"></a></dt>
<dd><p>Character string, corresponding to time unit like <code>"s"</code> (<strong>default</strong>),
<code>"min"</code> or <code>"h"</code>.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Character string, pointing to <code>time</code> column/variable name in the original
<code>data.qt.expr</code> data frame. <strong>Default</strong>: <code>time = "time_s"</code>.</p></dd>


<dt id="arg-qvarr">qvarR<a class="anchor" aria-label="anchor" href="#arg-qvarr"></a></dt>
<dd><p>Character string, pointing to <code>qvarR</code> (quantitative variable related to radical) column/variable
name in the original <code>data.qt.expr</code>. <strong>Default</strong>: <code>qvarR = "Area"</code>.</p></dd>


<dt id="arg-model-react">model.react<a class="anchor" aria-label="anchor" href="#arg-model-react"></a></dt>
<dd><p>Character string, denoting a specific radical (<code>"R"</code>) reaction related to
changes in integral intensities (or any other <strong>q</strong>uantitative <strong>var</strong>iable) in EPR spectral
time series. Arrow shows direction of the reaction (<code>"--&gt;", forward</code> or <code>"&lt;==&gt;", forward + reverse</code>).
Rate constants are indicated by square brackets after the arrows. Following examples of the reaction schemes
are predefined and commonly used to describe the integral intensity and/or radical concentration/amount
changes during the EPR time series experiment (the <code>r,a,b</code> stoichiometric coefficients
may vary, see below).</p><table class="table table"><tr><td><strong>Reaction Scheme</strong></td><td><strong>model.react</strong></td></tr><tr><td>\((r=1)\text{R} \xrightarrow{k_1} \text{B}\)</td><td><code>"(r=1)R --&gt; [k1] B"</code></td></tr><tr><td>\((a=2)\text{A} \xrightarrow{k_1} (r=2)\text{R}\)</td><td><code>"(a=2)A --&gt; [k1] (r=2)R"</code></td></tr><tr><td>\((a=2)\text{A} \xrightleftharpoons[k_4]{k_1} (r=2)\text{R}
 \xrightleftharpoons[k_3]{k_2} (b=1)\text{B}\)</td><td><code>"(a=2)A &lt;==&gt; [k1] [k4] (r=2)R &lt;==&gt; [k2] [k3] (b=1)B"</code></td></tr><tr><td>\((r=1)\text{R} \xrightleftharpoons[k_2]{k_1} (b=1)\text{B}\)</td><td><code>"(r=1)R &lt;==&gt; [k1] [k2] (b=1)B"</code></td></tr><tr><td>\((a=2)\text{A} \xrightleftharpoons[k_2]{k_1} (r=2)\text{R}\)</td><td><code>"(a=2)A &lt;==&gt; [k1] [k2] (r=2)R"</code></td></tr><tr><td>\((a=1)\text{A} + (b=1)\text{B} \xrightarrow{k_1} (r=1)\text{R}\)</td><td><code>"(a=1)A + (b=1)B --&gt; [k1] (r=1)R"</code></td></tr><tr><td>\((a=1)\text{A} + (r=1)\text{R} \xrightarrow{k_1} \text{B}\)</td><td><code>"(a=1)A + (r=1)R --&gt; [k1] B"</code></td></tr></table><p>Couple of examples are also given in <code>Details</code>. The function is relatively flexible and enables
later addition of any other reaction schemes describing the EPR time series experiments
(YOU MAY ASK DEVELOPER(S) via forum/help-channels). The stoichiometric coefficient (such as <code>(r=1)</code>
or <code>(a=1)</code>) can be varied within the <code>model.react</code> character string.
Defined/Allowed values are integers, e.g. 1,2,3...etc. The space character within the <code>model.react</code>
string is not fixed and can be skipped for the sake of simplicity.
If <code>elementary.react = FALSE</code> (the model reaction is not considered as an elementary one),
a possible non-integer partial coefficients (e.g. <code>alpha</code>,<code>beta</code> or <code>gamma</code>)
must be included in <code>kin.params</code> (see also <code>kin.params</code> description). For the consecutive model reaction
presented above, it applies only to one part/step of the mechanism.</p></dd>


<dt id="arg-elementary-react">elementary.react<a class="anchor" aria-label="anchor" href="#arg-elementary-react"></a></dt>
<dd><p>Logical, if the model reaction should be considered as elementary one,
i.e. the stoichiometric coefficients equal to the partial reaction orders. Such reaction proceeds without
identifiable intermediate species forming. <strong>Default</strong>: <code>elementary.react = TRUE</code>.
If <code>elementary.react = FALSE</code>, i.e. the <code>model.react</code> cannot be considered like an elementary one,
one must include the parameterized reaction orders \(\alpha\), \(\beta\) or \(\gamma\) in
the <code>kin.params</code>, e.g <code>kin.params = c(k1 = 0.01, qvar0A = 0.05, alpha = 1.5)</code>. For the consecutive
model reaction presented above, it applies only to one part/step of the mechanism.</p></dd>


<dt id="arg-params-guess">params.guess<a class="anchor" aria-label="anchor" href="#arg-params-guess"></a></dt>
<dd><p>Named vector, initial values of <code>kin.params</code> (see <code><a href="eval_kinR_ODE_model.html">eval_kinR_ODE_model</a></code>)
ready for optimization/fitting. The <code>k1</code>-unit is eventually expressed
in terms of \(s^{-1}\) as well as in units of the applied <code>qvar</code>
(e.g. <code>c</code>, concentration) and depends on the partial reaction order(s), which power(s) the <code>qvar(s)</code>.
For example, the <code>k1</code>-unit of elementary radical recombination, evaluated by double integrals,
like <code>model.react = "(r=2)R --&gt; [k1] B"</code>, reads: \(\text{s}^{-1}\,(\text{p.d.u.})^{-1}\).</p></dd>


<dt id="arg-params-guess-lower">params.guess.lower<a class="anchor" aria-label="anchor" href="#arg-params-guess-lower"></a></dt>
<dd><p>Numeric vector of lower bounds on each parameter in <code>params.guess</code>.
If not given, the <strong>default</strong> (<code>params.guess.lower = NULL</code>) lower bound
corresponds to <code>-Inf</code> of each <code>params.guess</code> component.</p></dd>


<dt id="arg-params-guess-upper">params.guess.upper<a class="anchor" aria-label="anchor" href="#arg-params-guess-upper"></a></dt>
<dd><p>Numeric vector of upper bounds on each parameter in <code>params.guess</code>.
If not given, the <strong>default</strong> (<code>params.guess.upper = NULL</code>) upper bound
corresponds to <code>+Inf</code> of each <code>params.guess</code> component.</p></dd>


<dt id="arg-fit-kin-method">fit.kin.method<a class="anchor" aria-label="anchor" href="#arg-fit-kin-method"></a></dt>
<dd><p>Character string, pointing to optimization/fitting method. So far,
the default one (<code>fit.kin.method = "diff-levenmarq"</code>) is exclusively used (additional methods
are planned). It corresponds to differential Levenberg-Marquardt (see also <code><a href="https://rdrr.io/pkg/minpack.lm/man/nls.lm.html" class="external-link">nls.lm</a></code>)
because it is based on the numeric solution of the ordinary differential equations
and not on the common integration of rate equations.</p></dd>


<dt id="arg-solve-ode-method">solve.ode.method<a class="anchor" aria-label="anchor" href="#arg-solve-ode-method"></a></dt>
<dd><p>Character string, setting up the integrator (the <code>method</code> argument in <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></code>),
applied to find the numeric solution of ODE. <strong>Default</strong>: <code>solve.ode.method = "lsoda"</code>
(<code><a href="https://rdrr.io/pkg/deSolve/man/lsoda.html" class="external-link">lsoda</a></code>, additional methods, see the <code>ode</code> link above).</p></dd>


<dt id="arg-time-frame-model">time.frame.model<a class="anchor" aria-label="anchor" href="#arg-time-frame-model"></a></dt>
<dd><p>Numeric value, corresponding to interval time resolution, i.e. the smallest time difference
between two consecutive points. The number of points is thus defined by the <code>time.interval.model</code> argument:
$$((Interval[2] - Interval[1])\,/\,Frame) + 1$$
This argument is required to numerically solve the kinetic differential equations by the <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></code>.
For the default interval mentioned above, the <strong>default</strong> value reads <code>time.frame.model = 2</code> (in seconds).</p></dd>


<dt id="arg-time-correct">time.correct<a class="anchor" aria-label="anchor" href="#arg-time-correct"></a></dt>
<dd><p>Logical, if time of recorded series of the EPR spectra needs to be corrected.
<strong>Default</strong>: <code>time.correc = FALSE</code>, which actually assumes that time correction was done
(either by <code><a href="correct_time_Exp_Specs.html">correct_time_Exp_Specs</a></code> or by <code><a href="readEPR_Exp_Specs_kin.html">readEPR_Exp_Specs_kin</a></code> with
a subsequent integration), prior to fitting procedure. If <code>time.correct = TRUE</code>,
the <code>path</code> to file with EPR instrumental parameters (like <code>.DSC</code>/<code>.dsc</code> or <code>par</code>)
must be defined (see the <code>path_to_dsc_par</code>).</p></dd>


<dt id="arg-path-to-dsc-par">path_to_dsc_par<a class="anchor" aria-label="anchor" href="#arg-path-to-dsc-par"></a></dt>
<dd><p>Character string, path (also provided by the <code><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></code>)
to <code>.DSC/.dsc</code> or <code>.par</code> (depending on <code>origin</code> parameter)
<code>text</code> files including instrumental parameters and provided by the EPR machine.
<strong>Default</strong>: <code>path_to_dsc_par = NULL</code>.</p></dd>


<dt id="arg-origin">origin<a class="anchor" aria-label="anchor" href="#arg-origin"></a></dt>
<dd><p>Character string, corresponding to software which was used to acquire the EPR spectra,
essential to load the parameters by the <code>path_to_dsc_par</code> (see also the <code><a href="readEPR_params_slct_kin.html">readEPR_params_slct_kin</a></code>).
Two origins are available: <code>origin = "winepr"</code> or <code>origin = "xenon"</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments for <code><a href="https://rdrr.io/pkg/minpack.lm/man/nls.lm.html" class="external-link">nls.lm</a></code>, e.g. defined
by the <code>control = minpack.lm::nls.lm.control()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with the following components is available:</p><dl><dt>df</dt>
<dd><p>Data frame object with the variables/columns such as <code>time</code>,
  experimental quantitative variable like <code>sigmoid_Integ</code> (sigmoid integral) or <code>Area</code>,
  concentration <code>c_M</code> or number of radicals of the relevant EPR spectrum; the corresponding
  quantitative variable <code>fitted</code> vector values as well as residual vector (experiment - kinetic model)
  related to the <code>qvarR</code> argument.</p></dd>

  <dt>plot</dt>
<dd><p>Plot object <em>Quantitative variable</em> <em>vs</em> <em>Time</em> with the experimental
  data and the corresponding fit.</p></dd>

  <dt>ra</dt>
<dd><p>Simple residual analysis - a list consisting of 4 elements: diagnostic plots
  <code>plot.rqq</code>, <code>plot.histDens</code>; original data frame (<code>df</code>) with residuals and their corresponding
  standard deviation (<code>sd</code>). For details, please refer to the <code><a href="plot_eval_RA_forFit.html">plot_eval_RA_forFit</a></code>.</p></dd>

  <dt>df.coeffs</dt>
<dd><p>Data frame object containing the optimized (best fit) parameter values (<code>Estimates</code>),
  their corresponding <code>standard errors</code>, <code>t-</code> as well as <code>p-values</code>.</p></dd>

  <dt>N.evals</dt>
<dd><p>Total number of evaluations/iterations before the best fit is found.</p></dd>

  <dt>min.rss</dt>
<dd><p>Minimum sum of residual squares after <code>N.evals</code>.</p></dd>

  <dt>abic</dt>
<dd><p>A list consisting of Akaike and Bayesian information criteria (AIC &amp; BIC) vector (<code>abic.vec</code>)
  and <code>message</code>, denoting the probability distribution of residuals/errors, applied to evaluate
  those criteria. To be used when comparing different kinetic models. The lower the (negative) values,
  the better the fit. Please, refer to the <code><a href="eval_ABIC_forFit.html">eval_ABIC_forFit</a></code>.</p></dd>

  <dt>N.converg</dt>
<dd><p>Vector, corresponding to residual sum of squares at each iteration/evaluation.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mullen KM, Elzhov TV, Spiess A, Bolker B (2023). “minpack.lm.” <a href="https://github.com/cran/minpack.lm" class="external-link">https://github.com/cran/minpack.lm</a>.</p>
<p>Gavin HP (2024). “The Levenberg-Marquardt algorithm for nonlinear least squares curve-fitting problems.”
 <em>Department of civil and environmental engineering, Duke University</em>,
 <a href="https://people.duke.edu/~hpgavin/ce281/lm.pdf" class="external-link">https://people.duke.edu/~hpgavin/ce281/lm.pdf</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Evaluations and Quantification:
<code><a href="eval_integ_EPR_Spec.html">eval_integ_EPR_Spec</a>()</code>,
<code><a href="eval_kinR_ODE_model.html">eval_kinR_ODE_model</a>()</code>,
<code><a href="quantify_EPR_Abs.html">quantify_EPR_Abs</a>()</code>,
<code><a href="quantify_EPR_Norm_const.html">quantify_EPR_Norm_const</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## loading example data (incl. `Area` and `time` variables)</span></span></span>
<span class="r-in"><span><span class="co">## from Xenon: decay of a triarylamine radical cation</span></span></span>
<span class="r-in"><span><span class="co">## after its generation by electrochemical oxidation</span></span></span>
<span class="r-in"><span><span class="va">triaryl_radCat_path</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="load_data_example.html">load_data_example</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"Triarylamine_radCat_decay_a.txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## corresponding data (double integrated</span></span></span>
<span class="r-in"><span><span class="co">## EPR spectrum = `Area` vs `time`)</span></span></span>
<span class="r-in"><span><span class="va">triaryl_radCat_data</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="readEPR_Exp_Specs.html">readEPR_Exp_Specs</a></span><span class="op">(</span><span class="va">triaryl_radCat_path</span>,</span></span>
<span class="r-in"><span>                    header <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                    fill <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                    select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time_s"</span>,<span class="st">"Area"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    x.unit <span class="op">=</span> <span class="st">"s"</span>,</span></span>
<span class="r-in"><span>                    x.id <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                    Intensity.id <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                    qValue <span class="op">=</span> <span class="fl">1700</span>,</span></span>
<span class="r-in"><span>                    data.structure <span class="op">=</span> <span class="st">"others"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## data preview</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">triaryl_radCat_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    time_s        Area</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;num&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:   0.00 0.018741176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:  15.17 0.018117647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:  30.01 0.017617647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:  44.82 0.017194118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:  59.66 0.016511765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:  74.52 0.016347059</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## loading the `.DSC` file</span></span></span>
<span class="r-in"><span><span class="va">triaryl_radCat_dsc_path</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="load_data_example.html">load_data_example</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"Triarylamine_radCat_decay_a.DSC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## fit previous data by second order kinetics,</span></span></span>
<span class="r-in"><span><span class="co">## where the `model.react` is considered as an elementary</span></span></span>
<span class="r-in"><span><span class="co">## step (`time.correct` of the CW-sweeps is included (`TRUE`))</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_01</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">eval_kinR_EPR_modelFit</span><span class="op">(</span>data.qt.expr <span class="op">=</span> <span class="va">triaryl_radCat_data</span>,</span></span>
<span class="r-in"><span>                         model.react <span class="op">=</span> <span class="st">"(r=2)R --&gt; [k1] B"</span>,</span></span>
<span class="r-in"><span>                         elementary.react <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                         params.guess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>qvar0R <span class="op">=</span> <span class="fl">0.019</span>,</span></span>
<span class="r-in"><span>                                          k1 <span class="op">=</span> <span class="fl">0.04</span></span></span>
<span class="r-in"><span>                                         <span class="op">)</span>,</span></span>
<span class="r-in"><span>                         time.correct <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                         path_to_dsc_par <span class="op">=</span> <span class="va">triaryl_radCat_dsc_path</span>,</span></span>
<span class="r-in"><span>                         origin <span class="op">=</span> <span class="st">"xenon"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## data frame preview</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">triaryl_model_kin_fit_01</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    time_s        Area      fitted      residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;num&gt;       &lt;num&gt;       &lt;num&gt;          &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:      6 0.018741176 0.018498974  0.00024220227</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:     21 0.018117647 0.017992445  0.00012520241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:     36 0.017617647 0.017512916  0.00010473112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:     51 0.017194118 0.017058284  0.00013583347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:     66 0.016511765 0.016626659 -0.00011489474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:     81 0.016347059 0.016216338  0.00013072040</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## plot preview</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_01</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="eval_kinR_EPR_modelFit-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## coefficients/parameters table preview</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_01</span><span class="op">$</span><span class="va">df.coeffs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate    Std. Error   t value       Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> qvar0R 0.018498974 4.4370112e-05 416.92422 4.9868274e-161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k1     0.050727647 1.9521465e-04 259.85573 6.3237953e-141</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## convergence preview</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_01</span><span class="op">$</span><span class="va">N.converg</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.2424078e-04 2.8726168e-06 1.3678869e-06 1.3672908e-06 1.3672908e-06</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## simple residual analysis plots</span></span></span>
<span class="r-in"><span><span class="co">## showing the random pattern, which indicates that</span></span></span>
<span class="r-in"><span><span class="co">## kinetic model provides a decent fit to the data +</span></span></span>
<span class="r-in"><span><span class="co">## normal quantile (Q-Q) plot, indicating that residuals</span></span></span>
<span class="r-in"><span><span class="co">## are normally distributed; third plot demonstrates</span></span></span>
<span class="r-in"><span><span class="co">## the probability density with the histogram of residuals</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_01</span><span class="op">$</span><span class="va">ra</span><span class="op">$</span><span class="va">plot.rqq</span></span></span>
<span class="r-plt img"><img src="eval_kinR_EPR_modelFit-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_01</span><span class="op">$</span><span class="va">ra</span><span class="op">$</span><span class="va">plot.histDens</span></span></span>
<span class="r-plt img"><img src="eval_kinR_EPR_modelFit-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## standard deviation of residuals</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_01</span><span class="op">$</span><span class="va">ra</span><span class="op">$</span><span class="va">sd</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.00011872565</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## Akaike and Bayesian Criteria (AIC &amp; BIC)</span></span></span>
<span class="r-in"><span><span class="co">## information about the residuals +</span></span></span>
<span class="r-in"><span><span class="co">## + probability distribution</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_01</span><span class="op">$</span><span class="va">abic</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $abic.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1522.9038 -1517.8172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Information criteria evaluated using the"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "normal distribution of residuals,"         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "additionally supported by the Shapiro-Wilk"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "test."                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## take the same experimental data and perform fit</span></span></span>
<span class="r-in"><span><span class="co">## by first order kinetics where the `model.react`</span></span></span>
<span class="r-in"><span><span class="co">## is considered as an elementary step</span></span></span>
<span class="r-in"><span><span class="co">## (`time.correct` of the CW-sweeps is included (`TRUE`))</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_02</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">eval_kinR_EPR_modelFit</span><span class="op">(</span>data.qt.expr <span class="op">=</span> <span class="va">triaryl_radCat_data</span>,</span></span>
<span class="r-in"><span>    model.react <span class="op">=</span> <span class="st">"(r=1)R --&gt; [k1] B"</span>,</span></span>
<span class="r-in"><span>    elementary.react <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    params.guess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>qvar0R <span class="op">=</span> <span class="fl">0.019</span>,</span></span>
<span class="r-in"><span>                     k1 <span class="op">=</span> <span class="fl">0.0002</span></span></span>
<span class="r-in"><span>                     <span class="op">)</span>,</span></span>
<span class="r-in"><span>    time.correct <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    path_to_dsc_par <span class="op">=</span> <span class="va">triaryl_radCat_dsc_path</span>,</span></span>
<span class="r-in"><span>    origin <span class="op">=</span> <span class="st">"xenon"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## plot preview</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_02</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="eval_kinR_EPR_modelFit-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## coefficients/parameters table preview</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_02</span><span class="op">$</span><span class="va">df.coeffs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate    Std. Error   t value      Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> qvar0R 0.01654454027 1.6924636e-04 97.754187 1.6868359e-99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k1     0.00096215125 1.8497324e-05 52.015701 3.5037066e-73</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## simple residual analysis, indicating</span></span></span>
<span class="r-in"><span><span class="co">## the 1st order kinetics is less convenient</span></span></span>
<span class="r-in"><span><span class="co">## model than that of the 2nd order (based on</span></span></span>
<span class="r-in"><span><span class="co">## the decrease of EPR intensity/integral)</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_02</span><span class="op">$</span><span class="va">ra</span><span class="op">$</span><span class="va">plot.rqq</span></span></span>
<span class="r-plt img"><img src="eval_kinR_EPR_modelFit-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## standard deviation of residuals</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_02</span><span class="op">$</span><span class="va">ra</span><span class="op">$</span><span class="va">sd</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.00063538776</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## Akaike and Bayesian Criteria (AIC &amp; BIC) +</span></span></span>
<span class="r-in"><span><span class="co">## + information about the residuals</span></span></span>
<span class="r-in"><span><span class="co">## probability distribution</span></span></span>
<span class="r-in"><span><span class="va">triaryl_model_kin_fit_02</span><span class="op">$</span><span class="va">abic</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $abic.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1187.8203 -1182.7336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Information criteria evaluated using the"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "normal distribution of residuals."       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ján Tarábek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

