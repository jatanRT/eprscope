<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The peak picking expands the functionality of the basic eval_extremeX_Spec to quickly
  find extremes within several regions of the entire EPR/ENDOR Spectrum (without a need for an
  interactive plotting). The function is based on the findpeaks to find
  the local intensity maxima and/or minima by fitting the experimental EPR spectral parts/points using the shortened
  vertex form of a parabola.
  The parabola vertices actually represent the maxima or minima. Visualization of the peak picking is provided
  by the plot_EPR_Specs together with the geom_text function (see the geom_label)."><title>Peak Picking of EPR/ENDOR Spectra — eval_peakPick_Spec • eprscope</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Peak Picking of EPR/ENDOR Spectra — eval_peakPick_Spec"><meta property="og:description" content="The peak picking expands the functionality of the basic eval_extremeX_Spec to quickly
  find extremes within several regions of the entire EPR/ENDOR Spectrum (without a need for an
  interactive plotting). The function is based on the findpeaks to find
  the local intensity maxima and/or minima by fitting the experimental EPR spectral parts/points using the shortened
  vertex form of a parabola.
  The parabola vertices actually represent the maxima or minima. Visualization of the peak picking is provided
  by the plot_EPR_Specs together with the geom_text function (see the geom_label)."><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eprscope</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.13</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/datasets.html">Package Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/functionality.html">Basic Functionality</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jatanrt/eprscope/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Peak Picking of EPR/ENDOR Spectra</h1>
      <small class="dont-index">Source: <a href="https://github.com/jatanrt/eprscope/blob/master/R/eval_peakPick_Spec.R" class="external-link"><code>R/eval_peakPick_Spec.R</code></a></small>
      <div class="d-none name"><code>eval_peakPick_Spec.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The peak picking expands the functionality of the basic <code><a href="eval_extremeX_Spec.html">eval_extremeX_Spec</a></code> to quickly
  find extremes within several regions of the entire EPR/ENDOR Spectrum (without a need for an
  interactive plotting). The function is based on the <code><a href="https://rdrr.io/pkg/gsignal/man/findpeaks.html" class="external-link">findpeaks</a></code> to find
  the local intensity maxima and/or minima by fitting the experimental EPR spectral parts/points using the shortened
  <a href="https://www.radfordmathematics.com/functions/quadratic-functions-parabola/vertex-form/vertex-form-finding-equation-parabola.html" class="external-link">vertex form of a parabola</a>.
  The parabola vertices actually represent the maxima or minima. Visualization of the peak picking is provided
  by the <code><a href="plot_EPR_Specs.html">plot_EPR_Specs</a></code> together with the <code>geom_text</code> function (see the <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eval_peakPick_Spec</span><span class="op">(</span></span>
<span>  <span class="va">data.spectr</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"B_mT"</span>,</span>
<span>  x.unit <span class="op">=</span> <span class="st">"mT"</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Intensity <span class="op">=</span> <span class="st">"dIepr_over_dB"</span>,</span>
<span>  Ilim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lineSpecs.form <span class="op">=</span> <span class="st">"derivative"</span>,</span>
<span>  only.peak.pn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min.peak.height <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min.peak.dist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min.peak.width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max.peak.width <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  double.sided <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  line.color <span class="op">=</span> <span class="st">"darkviolet"</span>,</span>
<span>  peak.color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>  peak.text.angle <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  peak.text.size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  peak.point.size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  peak.point.shape <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  peak.text.overlap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-spectr">data.spectr<a class="anchor" aria-label="anchor" href="#arg-data-spectr"></a></dt>
<dd><p>Data frame object/table, containing <code>x</code>-values and the <code>Intensity</code>
(see the arguments below), from which the peaks are to be found (picked).</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Character string, pointing to \(x\)-axis/column quantity header in the original
<code>data.spectr</code> like magnetic flux density \(B\), \(g\)-Value or \(RF\) (radio frequency),
<strong>default</strong>: <code>x = "B_mT"</code>.</p></dd>


<dt id="arg-x-unit">x.unit<a class="anchor" aria-label="anchor" href="#arg-x-unit"></a></dt>
<dd><p>Character string, pointing to unit of <code>x</code>-quantity coming from the original <code>data.spectra</code>.
Units like <code>"G"</code> (Gauss), <code>"mT"</code> (millitesla), <code>"T"</code> (tesla), <code>"MHz"</code> (megahertz in case of ENDOR spectra)
or <code>"Unitless"</code> / <code>"unitless"</code> (in case of \(g\)-values) can be used. <strong>Default</strong>: <code>x.unit = "mT"</code>.</p></dd>


<dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>Numeric vector, referring to lower and upper limit of the selected \(x\)-region,
e.g. <code>xlim = c(3495.4,3595.4)</code> (\(B\) in <code>G</code>) or <code>xlim = c(12.5,21.2)</code> (\(RF\) in <code>MHz</code>)
or <code>xlim = c(2.004,2.001)</code> (dimensionless \(g\)). <strong>Default</strong>: <code>xlim = NULL</code> (actually corresponding
to the entire \(x\)-range).</p></dd>


<dt id="arg-intensity">Intensity<a class="anchor" aria-label="anchor" href="#arg-intensity"></a></dt>
<dd><p>Character string, pointing to <code>intensity column</code> name in the original <code>data.spectr</code>
if other than <code>dIepr_over_dB</code> name/label is used (e.g. for simulated or integrated spectra),
<strong>default</strong>: <code>Intesity = "dIepr_over_dB"</code>.</p></dd>


<dt id="arg-ilim">Ilim<a class="anchor" aria-label="anchor" href="#arg-ilim"></a></dt>
<dd><p>Numeric vector, corresponding to visualization limits of the selected <code>y</code> / <code>Intensity</code>
region, e.g. <code>Ilim = c(-2e-3,2e-3)</code>. <strong>Default</strong>: <code>Ilim = NULL</code> (actually corresponding
to the entire Intensity range).</p></dd>


<dt id="arg-linespecs-form">lineSpecs.form<a class="anchor" aria-label="anchor" href="#arg-linespecs-form"></a></dt>
<dd><p>Character string, describing either <code>"derivative"</code> (<strong>default</strong>)
or <code>"integrated"</code> (in such case also <code>"absorption"</code> can be used)
line form of the analyzed EPR spectrum/data.</p></dd>


<dt id="arg-only-peak-pn">only.peak.pn<a class="anchor" aria-label="anchor" href="#arg-only-peak-pn"></a></dt>
<dd><p>Character string, setting up the selection of positive (<code>Intenstity</code> &gt; 0)
and/or negative (<code>Intensity</code> &lt; 0) peaks (in the case of <code>lineSpecs.form = "derivative"</code>)
or only positive ones (in the case of <code>lineSpecs.form = "integrated"</code>
or <code>lineSpeccs.form = "absorption"</code>). <strong>Default</strong>: <code>only.peak.pn = NULL</code>,
corresponding to automatic selection of positive/negative peaks depending on <code>lineSpecs.form</code>.
In addition to <code>only.peak.pn = "positive"</code> and <code>only.peak.pn = "negative"</code> strings,
the short code like <code>only.peak.pn = "p"</code> (or <code>"P"</code>) and <code>only.peak.pn = "n"</code> (or <code>"N"</code>)
can be applied as well.</p></dd>


<dt id="arg-min-peak-height">min.peak.height<a class="anchor" aria-label="anchor" href="#arg-min-peak-height"></a></dt>
<dd><p>Numeric, setting the <code>Intensity</code> threshold (its absolute value)
in order to filter/select only those intensity values, which are taken to find to maxima and/or minima.
<strong>Default</strong>: <code>min.peak.height = NULL</code>, corresponding to \(20\,\%\) of the maximum Intensity value.</p></dd>


<dt id="arg-min-peak-dist">min.peak.dist<a class="anchor" aria-label="anchor" href="#arg-min-peak-dist"></a></dt>
<dd><p>Numeric (integer &gt; 0), pointing to minimum distance (in points) between the expected peaks,
which are constructed by parabola fits over the points. For such purpose, the shortened (vertex)
parabola (the 2nd polynomial) expression like \(a\,(x - h)^2 + k\) is applied,
where \(a\) and \(h,k\) denote the concavity and the vertex, respectively. These vertices actually
correspond to peak maxima (\(a &lt; 0\)) or minima (\(a &gt; 0\)). Peaks separated by less than this distance
are considered as a single peak. Please, also refer to documentation of the <code><a href="https://rdrr.io/pkg/gsignal/man/findpeaks.html" class="external-link">findpeaks</a></code>
function. The <strong>default</strong> distance (<code>min.peak.dist = NULL</code>) actually equals
to one-half divided by the distance between the adjacent points, rounded to the integer: e.g.
$$round(0.5\,/\,(x_2 - x_1))$$
where such formula corresponds to <code>round(0.5/(data.spectr[[x]][2] - data.spectr[[x]][1]))</code>.
This is especially useful for rather noisy EPR spectra or spectra with high resolution.
If according to <code>{ggplot2}</code> graphical representation the peak picking fails, i.e. not all peaks
are properly detected, try lower values than the <strong>default</strong> one (such as 1 or 4 or ...etc.).</p></dd>


<dt id="arg-min-peak-width">min.peak.width<a class="anchor" aria-label="anchor" href="#arg-min-peak-width"></a></dt>
<dd><p>Numeric (integer &gt; 0), setting the minimum peak-width (points) to fit the vertex
parabola expression (see also the <code>min.peak.dist</code> argument and the <code><a href="https://rdrr.io/pkg/gsignal/man/findpeaks.html" class="external-link">findpeaks</a></code>
documentation) to find the peaks. <strong>Default</strong>: <code>min.peak.width = 1</code>.</p></dd>


<dt id="arg-max-peak-width">max.peak.width<a class="anchor" aria-label="anchor" href="#arg-max-peak-width"></a></dt>
<dd><p>Numeric (integer &gt; 0), pointing to maximum peak-width (points) to find the peaks.
<strong>Default</strong>: <code>max.peak.width = Inf</code> (infinity).</p></dd>


<dt id="arg-double-sided">double.sided<a class="anchor" aria-label="anchor" href="#arg-double-sided"></a></dt>
<dd><p>Logical. Should be the peaks found for both intensity sites
(<code>data.spectr[[Intensity]]</code> &gt; 0 as well as <code>data.spectr[[Intensity]]</code> &lt; 0)?
If <code>lineSpecs.form = "derivative"</code> then <code>double.sided = TRUE</code>, <strong>default</strong>, otherwise,
for the single integrated EPR spectra, it applies <code>double.sided = FALSE</code>.</p></dd>


<dt id="arg-line-color">line.color<a class="anchor" aria-label="anchor" href="#arg-line-color"></a></dt>
<dd><p>Character string, line color to plot the EPR/ENDOR spectrum.
All <a href="https://ggplot2.tidyverse.org/reference/aes_colour_fill_alpha.html" class="external-link"><code>{ggplot2}</code> colors</a>
are available (see also <code><a href="https://ggplot2.tidyverse.org/reference/aes_colour_fill_alpha.html" class="external-link">aes_colour_fill_alpha</a></code>).
<strong>Default</strong>: <code>line.color = "darkviolet"</code>.</p></dd>


<dt id="arg-peak-color">peak.color<a class="anchor" aria-label="anchor" href="#arg-peak-color"></a></dt>
<dd><p>Character string, "point" color to visualize/emphasize the peaks.
Similarly, as for the <code>line.color</code> argument, all <code>{ggplot2}</code> color definitions are available.
<strong>Default</strong>: <code>peak.color = "steelblue"</code>.</p></dd>


<dt id="arg-peak-text-angle">peak.text.angle<a class="anchor" aria-label="anchor" href="#arg-peak-text-angle"></a></dt>
<dd><p>Numeric, setting the angle (in deg) of the peak value (projection onto
the \(x\)-axis) annotation text, presented near the local maximum or minimum, and measured relatively
to the \(x\)-axis (see also <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></code>). <strong>Default</strong>: <code>peak.text.angle = 90</code>.</p></dd>


<dt id="arg-peak-text-size">peak.text.size<a class="anchor" aria-label="anchor" href="#arg-peak-text-size"></a></dt>
<dd><p>Numeric, pointing to peak annotation text size
(in mm, see the <code><a href="https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html" class="external-link">aes_linetype_size_shape</a></code>). <strong>Default</strong>: <code>peak.text.size = 3</code>.</p></dd>


<dt id="arg-peak-point-size">peak.point.size<a class="anchor" aria-label="anchor" href="#arg-peak-point-size"></a></dt>
<dd><p>Numeric, size (in mm) of the peak "point" in graphical representation of the peak picking.
Please consult the <code><a href="https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html" class="external-link">aes_linetype_size_shape</a></code>
<a href="https://ggplot2-book.org/scales-other" class="external-link"><code>{ggplot2}</code> aesthetic arguments</a>. <strong>Default</strong>:
<code>peak.point.size = 2</code>.</p></dd>


<dt id="arg-peak-point-shape">peak.point.shape<a class="anchor" aria-label="anchor" href="#arg-peak-point-shape"></a></dt>
<dd><p>Numeric (integer between 0 and 24), controlling the "point" symbol like square,
triangle, circle, asterisk...etc,
refer to e.g. <a href="https://ggplot2.tidyverse.org/articles/ggplot2-specs.html" class="external-link"><code>{ggplot2}</code>
aesthetic specifications</a>. <strong>Default</strong>: <code>peak.point.shape = 16</code> (filled circle).</p></dd>


<dt id="arg-peak-text-overlap">peak.text.overlap<a class="anchor" aria-label="anchor" href="#arg-peak-text-overlap"></a></dt>
<dd><p>Logical, if <code>TRUE</code>, the overlapping peak text annotation to a previous one,
will be not displayed, for clarity (see also <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></code>).
If <code>peak.text.overlap = FALSE</code> (<strong>default</strong>), all found peaks are presented with their
corresponding values (text annotations).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments specified, please refer to the <code><a href="plot_EPR_Specs.html">plot_EPR_Specs</a></code> function,
in order to customize the graphical output.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List, consisting of following components, will be returned:</p><dl><dt>df</dt>
<dd><p>Data frame, corresponding to the original <code>data.spectr</code>, with all peaks (<code>Intensity</code>
  <em>vs</em> <code>x</code>) found by <code><a href="https://rdrr.io/pkg/gsignal/man/findpeaks.html" class="external-link">findpeaks</a></code> algorithm and the arguments defined above.</p></dd>

  <dt>plot</dt>
<dd><p>Graphical representation of found peaks in the EPR/ENDOR spectrum.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Evaluations:
<code><a href="eval_DeltaXpp_Spec.html">eval_DeltaXpp_Spec</a>()</code>,
<code><a href="eval_FWHMx_Spec.html">eval_FWHMx_Spec</a>()</code>,
<code><a href="eval_extremeX_Spec.html">eval_extremeX_Spec</a>()</code>,
<code><a href="eval_gFactor.html">eval_gFactor</a>()</code>,
<code><a href="eval_gFactor_Spec.html">eval_gFactor_Spec</a>()</code>,
<code><a href="eval_interval_cnfd_tVec.html">eval_interval_cnfd_tVec</a>()</code>,
<code><a href="eval_kinR_Eyring_GHS.html">eval_kinR_Eyring_GHS</a>()</code>,
<code><a href="eval_nu_ENDOR.html">eval_nu_ENDOR</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## loading TMPD built-in example file:</span></span></span>
<span class="r-in"><span><span class="va">tmpd.data.file.path</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="load_data_example.html">load_data_example</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"TMPD_specelchem_accu_b.asc"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## reading data:</span></span></span>
<span class="r-in"><span><span class="va">tmpd.data.file</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="readEPR_Exp_Specs.html">readEPR_Exp_Specs</a></span><span class="op">(</span>path_to_ASC <span class="op">=</span> <span class="va">tmpd.data.file.path</span>,</span></span>
<span class="r-in"><span>                    col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B_G"</span>,</span></span>
<span class="r-in"><span>                                  <span class="st">"dIepr_over_dB"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    qValue <span class="op">=</span> <span class="fl">3500</span>,</span></span>
<span class="r-in"><span>                    norm.vec.add <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>                    origin <span class="op">=</span> <span class="st">"winepr"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## peak picking of only positive (Intensitity &gt; 0)</span></span></span>
<span class="r-in"><span><span class="co">## peaks in the derivative EPR spectrum of TMPD:</span></span></span>
<span class="r-in"><span><span class="va">tmpd.peak.pick.01</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">eval_peakPick_Spec</span><span class="op">(</span>data.spectr <span class="op">=</span> <span class="va">tmpd.data.file</span>,</span></span>
<span class="r-in"><span>                     only.peak.pn <span class="op">=</span> <span class="st">"p"</span>,</span></span>
<span class="r-in"><span>                     min.peak.dist <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## peak picking visualization:</span></span></span>
<span class="r-in"><span><span class="va">tmpd.peak.pick.01</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="eval_peakPick_Spec-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## found peaks data frame preview</span></span></span>
<span class="r-in"><span><span class="va">tmpd.peak.pick.01</span><span class="op">$</span><span class="va">df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       B_mT dIepr_over_dB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  347.252     440.04677</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  347.752     598.15606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  347.947     885.78057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  348.147     592.27811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  348.447     955.23057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  348.642    1429.66263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  348.842     955.70051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  349.147    1245.92903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  349.342    1889.22537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 349.537    1257.70640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 349.847    1440.42926</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 350.042    2171.17074</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 350.242    1424.77269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 350.542    1375.81314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 350.737    2079.57646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 350.937    1359.29303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 351.237     996.85223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 351.432    1538.72091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 351.632    1007.41737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 351.937     570.59091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 352.132     886.42989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 352.327     579.94800</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## peak picking in 'G' (not in default 'mT')</span></span></span>
<span class="r-in"><span><span class="co">## of both positive as well as negative intensities</span></span></span>
<span class="r-in"><span><span class="co">## with the intensity threshold 15% of the maximum,</span></span></span>
<span class="r-in"><span><span class="co">## peaks annotation text angle 60 deg:</span></span></span>
<span class="r-in"><span><span class="va">tmpd.peak.pick.02</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">eval_peakPick_Spec</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data.spectr <span class="op">=</span> <span class="va">tmpd.data.file</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"B_G"</span>,</span></span>
<span class="r-in"><span>    x.unit <span class="op">=</span> <span class="st">"G"</span>,</span></span>
<span class="r-in"><span>    min.peak.height <span class="op">=</span></span></span>
<span class="r-in"><span>      <span class="fl">0.15</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">tmpd.data.file</span><span class="op">$</span><span class="va">dIepr_over_dB</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    peak.text.angle <span class="op">=</span> <span class="fl">60</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## graph/EPR spectrum peaks preview:</span></span></span>
<span class="r-in"><span><span class="va">tmpd.peak.pick.02</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="eval_peakPick_Spec-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ján Tarábek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

