<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Smoothing of the EPR spectra by non-parametric fitting a smoothing spline, ss
  from the npreg package, onto the experimental
  EPR spectrum/spectra."><title>Smoothing and Fitting of an EPR Spectrum by Splines — smooth_EPR_Spec_by_npreg • eprscope</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Smoothing and Fitting of an EPR Spectrum by Splines — smooth_EPR_Spec_by_npreg"><meta property="og:description" content="Smoothing of the EPR spectra by non-parametric fitting a smoothing spline, ss
  from the npreg package, onto the experimental
  EPR spectrum/spectra."><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eprscope</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.15</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/datasets.html">Package Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/firstSteps.html">First Steps with R Language</a></li>
    <li><a class="dropdown-item" href="../articles/functionality.html">Basic Functionality</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jatanrt/eprscope/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Smoothing and Fitting of an EPR Spectrum by Splines</h1>
      <small class="dont-index">Source: <a href="https://github.com/jatanrt/eprscope/blob/v0.1.15/R/smooth_EPR_Spec_by_npreg.R" class="external-link"><code>R/smooth_EPR_Spec_by_npreg.R</code></a></small>
      <div class="d-none name"><code>smooth_EPR_Spec_by_npreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Smoothing of the EPR spectra by non-parametric fitting a smoothing spline, <code><a href="https://rdrr.io/pkg/npreg/man/ss.html" class="external-link">ss</a></code>
  from the <a href="https://cran.r-project.org/web/packages/npreg/npreg.pdf" class="external-link">npreg</a> package, onto the experimental
  EPR spectrum/spectra.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smooth_EPR_Spec_by_npreg</span><span class="op">(</span></span>
<span>  <span class="va">data.spectr</span>,</span>
<span>  B <span class="op">=</span> <span class="st">"B_mT"</span>,</span>
<span>  B.unit <span class="op">=</span> <span class="st">"mT"</span>,</span>
<span>  lineSpecs.form <span class="op">=</span> <span class="st">"derivative"</span>,</span>
<span>  Intensity <span class="op">=</span> <span class="st">"dIepr_over_dB"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"BIC"</span>,</span>
<span>  output.vec <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-spectr">data.spectr<a class="anchor" aria-label="anchor" href="#arg-data-spectr"></a></dt>
<dd><p>Spectrum data frame object where the magnetic flux density (in <code>mT</code> or <code>G</code>
or <code>T</code>) column can be labeled as <code>Field</code> or <code>B_G</code> and that of the derivative intensity
as <code>dIepr_over_dB</code> or single integrated intensity like <code>Integrated_Intensity</code>
(<code>index</code> column might be included as well).</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Character string, pointing to magnetic flux density <code>column</code> of the EPR spectrum data frame
<code>data.spectr</code> either in "millitesla"/"tesla" or in "gauss", that is <code>B = "B_mT"</code> (<strong>default</strong>)
or <code>B = "B_G"</code>/<code>B = "T"</code> or <code>B = "Bsim_G"</code> to include simulated EPR spectra as well.</p></dd>


<dt id="arg-b-unit">B.unit<a class="anchor" aria-label="anchor" href="#arg-b-unit"></a></dt>
<dd><p>Character string, denoting the magnetic flux density unit e.g. <code>B.unit = "G"</code>
(gauss, <strong>default</strong>) or <code>B.unit = "mT"</code>/<code>"T"</code> (millitesla/tesla).</p></dd>


<dt id="arg-linespecs-form">lineSpecs.form<a class="anchor" aria-label="anchor" href="#arg-linespecs-form"></a></dt>
<dd><p>Character string, describing either <code>"derivative"</code> (<strong>default</strong>) or
<code>"integrated"</code> (i.e. <code>"absorption"</code> which can be used as well) line form of the analyzed
EPR spectrum/data.</p></dd>


<dt id="arg-intensity">Intensity<a class="anchor" aria-label="anchor" href="#arg-intensity"></a></dt>
<dd><p>Character string, pointing to <code>intensity column</code> if other than <code>dIepr_over_dB</code>
name/label is used (e.g. for simulated spectra), <strong>default</strong>: <code>Intesity = "dIepr_over_dB"</code></p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character string, corresponding to method in order to fit an EPR spectrum by a smoothing spline
from <code>{npreg}</code> package (see the <code>method</code> argument in <code><a href="https://rdrr.io/pkg/npreg/man/ss.html" class="external-link">ss</a></code>).
The following methods are available (they are shortly described
in <a href="http://users.stat.umn.edu/~helwig/notes/smooth-spline-notes.html" class="external-link">Nathaniel's E. Helwig Introduction</a>
or additional information may be found in <code>References</code>) =&gt;</p><table class="table table"><tr><td><strong>Method</strong></td><td><strong>Short Description</strong></td></tr><tr><td>"GCV"</td><td>Generalized Cross-Validation</td></tr><tr><td>"OCV"</td><td>Ordinary Cross-Validation</td></tr><tr><td>"GACV"</td><td>Generalized Approximate Cross-Validation</td></tr><tr><td>"ACV"</td><td>Approximate Cross-Validation</td></tr><tr><td>"REML"</td><td>Restricted Maximum Likelihood</td></tr><tr><td>"ML"</td><td>Maximum Likelihood</td></tr><tr><td>"AIC"</td><td>Akaike’s Information Criterion</td></tr><tr><td>"BIC"</td><td>Bayesian Information Criterion (<strong>default</strong>)</td></tr></table></dd>


<dt id="arg-output-vec">output.vec<a class="anchor" aria-label="anchor" href="#arg-output-vec"></a></dt>
<dd><p>Logical, whether the function output have to be vectorized, i.e. only the vector
of smoothed EPR intensity is provided. This is especially useful for the EPR spectral (time) series,
which can be handily processed by the <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></code> using the
<code>pipe</code> operators (<code>%&gt;%</code>). <strong>Default</strong>: <code>output.vec = FALSE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to the function (see also the <code><a href="https://rdrr.io/pkg/npreg/man/ss.html" class="external-link">ss</a></code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>output.vec = TRUE</code> the output corresponds to vector of the smoothed EPR intensity
  (either derivative <code>lineSpecs.form = "derivative"</code> or integrated
  <code>lineSpecs.form = "integrated"/"absorption"</code>) with the length of the original <code>Intensity</code>.
  Contrarily, if the <code>output.vec</code> is set to <code>FALSE</code> the following list is returned =&gt;</p><dl><dt>df</dt>
<dd><p>Original data frame with the addition column, corresponding to smoothed EPR intensity
  (derivative or integrated).</p></dd>

  <dt>plot</dt>
<dd><p>Plot object (list) <em>EPR intensity</em> <em>vs.</em> <em>B</em> with the experimental
  data and its corresponding smoothed relation performed by splines.</p></dd>

  <dt>rss</dt>
<dd><p>Weighted (if the optional parameter <code>w</code> is defined) sum of residual squares.</p></dd>

  <dt>degs.freedom</dt>
<dd><p>Equivalent degrees of freedom used.</p></dd>

  <dt>fit</dt>
<dd><p>List with elements to characterize the spline fit (Details see <code>fit</code> value
  in the <code><a href="https://rdrr.io/pkg/npreg/man/ss.html" class="external-link">ss</a></code> function documentation).</p></dd>

  <dt>ra.sd</dt>
<dd><p>Standard deviation of residuals.</p></dd>

  <dt>abic</dt>
<dd><p>Numeric vector/value of Akaike’s Information Criterion (if the <code>method = "AIC"</code>)
  or Bayesian Information Criterion (if the <code>method = "BIC"</code>). These are negative numbers,
  having the largest modulus (deepest down in the negative territory) and therefore, indicating
  the preferred model (the lower, the better, see also <code><a href="eval_ABIC_forFit.html">eval_ABIC_forFit</a></code>.</p></dd>

  <dt>log.lik</dt>
<dd><p>Likelihood logarithm, if the <code>method = "REML"/"ML"</code>. Log likelihood value
  is a measure of goodness of fit for any model. The higher the value, the better the model.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The EPR spectrum is fitted by splines which, by default, correspond to cubic Bernoulli polynomials
  like
  $$I_{\text{EPR}}(B) = B^3 - (3/2)\,B^2 + (1/2)\,B$$
  where \(I_{\text{EPR}}\) equals to general EPR intensity and \(B\) is the magnetic flux density.
  This may be applied to both derivative or single integrated EPR spectrum forms. Also a higher/lower polynomial
  degree may be applied by the <code>method</code> (see the argument description) and by the <code>m</code> optional argument
  (see <code>...</code> additional arguments) which is a penalty order (integer). For the above-mentioned cubic
  spline/polynomial <code>m = 2</code>. Linear polynomial corresponds
  to <code>m = 1</code> and the highest quintic polynomial/spline is referred as <code>m = 3</code>:
  $$I_{\text{EPR}}(B) = B^5 - (5/2)\,B^4 + (5/3)\,B^3 - (1/6)\,B$$
  If the optional argument <code>bernoulli</code> is set to <code>FALSE</code> then "classic" definition
  of a smoothing spline is produced. In such case, the function estimate is a piece-wise polynomial function
  with pieces of degree 2m−1. Additional optional arguments from <code><a href="https://rdrr.io/pkg/npreg/man/ss.html" class="external-link">ss</a></code> like knots
  definition, equivalent degrees of freedom, vector of weights...etc. can be applied as well.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Berry LN, Helwig NE (2021). “Cross-Validation, Information Theory, or Maximum Likelihood?
  A Comparison of Tuning Methods for Penalized Splines.” <em>Stats</em>, <strong>4</strong>(3), 701–724,
  <a href="https://doi.org/10.3390/stats4030042" class="external-link">https://doi.org/10.3390/stats4030042</a>.</p>
<p>Elezović N (2016). “Generalized Bernoulli Polynomials and Numbers, Revisited.”
  <em>Mediterr. J. Math.</em>, <strong>13</strong>(1), 141–151. ISSN 1660-5454,
  <a href="https://doi.org/10.1007/s00009-014-0498-7" class="external-link">https://doi.org/10.1007/s00009-014-0498-7</a>.</p>
<p>Weisstein EW (2023). “Bernoulli Polynomial”,
  <a href="https://mathworld.wolfram.com/BernoulliPolynomial.html" class="external-link">https://mathworld.wolfram.com/BernoulliPolynomial.html</a>, MathWorld–A Wolfram Web Resource.</p>
<p>Helwig NE (2022). "Non-parametric Regression via Smoothing Splines",
  R package version 1.0-9, <a href="https://cran.r-project.org/web/packages/npreg/npreg.pdf" class="external-link">https://cran.r-project.org/web/packages/npreg/npreg.pdf</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Simulations and Optimization:
<code><a href="eval_ABIC_forFit.html">eval_ABIC_forFit</a>()</code>,
<code><a href="eval_sim_EPR_iso.html">eval_sim_EPR_iso</a>()</code>,
<code><a href="eval_sim_EPR_isoFit.html">eval_sim_EPR_isoFit</a>()</code>,
<code><a href="eval_sim_EPR_isoFit_space.html">eval_sim_EPR_isoFit_space</a>()</code>,
<code><a href="eval_sim_EPR_iso_combo.html">eval_sim_EPR_iso_combo</a>()</code>,
<code><a href="optim_for_EPR_fitness.html">optim_for_EPR_fitness</a>()</code>,
<code><a href="plot_eval_RA_forFit.html">plot_eval_RA_forFit</a>()</code>,
<code><a href="quantify_EPR_Sim_series.html">quantify_EPR_Sim_series</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## loading the built-in package example</span></span></span>
<span class="r-in"><span><span class="co">## time series EPR spectra:</span></span></span>
<span class="r-in"><span><span class="va">triarylamine.decay.series.dsc.path</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="fu"><a href="load_data_example.html">load_data_example</a></span><span class="op">(</span>file <span class="op">=</span></span></span>
<span class="r-in"><span>        <span class="st">"Triarylamine_radCat_decay_series.DSC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">triarylamine.decay.series.asc.path</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="fu"><a href="load_data_example.html">load_data_example</a></span><span class="op">(</span>file <span class="op">=</span></span></span>
<span class="r-in"><span>        <span class="st">"Triarylamine_radCat_decay_series.zip"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">triarylamine.decay.series.asc.path</span>,</span></span>
<span class="r-in"><span>      exdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## loading the kinetics:</span></span></span>
<span class="r-in"><span><span class="va">triarylamine.decay.series.data</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="readEPR_Exp_Specs_kin.html">readEPR_Exp_Specs_kin</a></span><span class="op">(</span>name.root <span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="st">"Triarylamine_radCat_decay_series"</span>,</span></span>
<span class="r-in"><span>    dir_ASC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    dir_dsc_par <span class="op">=</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                  package <span class="op">=</span> <span class="st">"eprscope"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## select the first spectrum</span></span></span>
<span class="r-in"><span><span class="va">triarylamine.decay.series.data1st</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>   <span class="va">triarylamine.decay.series.data</span><span class="op">$</span><span class="va">df</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time_s</span> <span class="op">==</span></span></span>
<span class="r-in"><span>       <span class="va">triarylamine.decay.series.data</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## smoothing the 1st EPR spectrum with default</span></span></span>
<span class="r-in"><span><span class="co">## arguments/parameters</span></span></span>
<span class="r-in"><span><span class="va">triarylamine.1st.spec.smooth</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">smooth_EPR_Spec_by_npreg</span><span class="op">(</span>data.spectr <span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="va">triarylamine.decay.series.data1st</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## plot preview</span></span></span>
<span class="r-in"><span><span class="va">triarylamine.1st.spec.smooth</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="smooth_EPR_Spec_by_npreg-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## sum of residual squares preview</span></span></span>
<span class="r-in"><span><span class="va">triarylamine.1st.spec.smooth</span><span class="op">$</span><span class="va">rss</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.2912784e-07</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## estimated standard deviation</span></span></span>
<span class="r-in"><span><span class="va">triarylamine.1st.spec.smooth</span><span class="op">$</span><span class="va">ra.sd</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.5366455e-05</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## Bayesian information criterion (BIC)</span></span></span>
<span class="r-in"><span><span class="va">triarylamine.1st.spec.smooth</span><span class="op">$</span><span class="va">abic</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -45315.035</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## smoothing of all EPR spectra in the series</span></span></span>
<span class="r-in"><span><span class="co">## with default arguments using the data</span></span></span>
<span class="r-in"><span><span class="co">## "pipe" ("%&gt;%") `dplyr` processing</span></span></span>
<span class="r-in"><span><span class="va">triarylamine.all.spec.smooth</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="va">triarylamine.decay.series.data</span><span class="op">$</span><span class="va">df</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">time_s</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>smoothed <span class="op">=</span></span></span>
<span class="r-in"><span>      <span class="fu">smooth_EPR_Spec_by_npreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pick.html" class="external-link">pick</a></span><span class="op">(</span><span class="va">B_mT</span>,<span class="va">dIepr_over_dB</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        output.vec <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>     <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## data frame preview</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">triarylamine.all.spec.smooth</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   time_s [1]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   index    B_G time_s dIepr_over_dB   B_mT      smoothed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 <span style="text-decoration: underline;">3</span>390        6  0.000<span style="text-decoration: underline;">013</span>629  339    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">003</span><span style="color: #BB0000;">740</span><span style="color: #BB0000; text-decoration: underline;">0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>     2 <span style="text-decoration: underline;">3</span>390.1      6 -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">001</span><span style="color: #BB0000;">013</span><span style="color: #BB0000; text-decoration: underline;">4</span> 339.01 -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">003</span><span style="color: #BB0000;">870</span><span style="color: #BB0000; text-decoration: underline;">1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 <span style="text-decoration: underline;">3</span>390.2      6 -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">019</span><span style="color: #BB0000;">795</span>  339.02 -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">004</span><span style="color: #BB0000;">001</span><span style="color: #BB0000; text-decoration: underline;">7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>     4 <span style="text-decoration: underline;">3</span>390.2      6 -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">029</span><span style="color: #BB0000;">827</span>  339.02 -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">004</span><span style="color: #BB0000;">136</span><span style="color: #BB0000; text-decoration: underline;">1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>     5 <span style="text-decoration: underline;">3</span>390.3      6 -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">016</span><span style="color: #BB0000;">871</span>  339.03 -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">004</span><span style="color: #BB0000;">274</span><span style="color: #BB0000; text-decoration: underline;">5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>     6 <span style="text-decoration: underline;">3</span>390.4      6  0.000<span style="text-decoration: underline;">002</span>562<span style="text-decoration: underline;">9</span> 339.04 -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">004</span><span style="color: #BB0000;">417</span><span style="color: #BB0000; text-decoration: underline;">6</span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## plot all smoothed spectra in the series</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_EPR_Specs.html">plot_EPR_Specs</a></span><span class="op">(</span>data.spectra <span class="op">=</span></span></span>
<span class="r-in"><span>          <span class="va">triarylamine.all.spec.smooth</span>,</span></span>
<span class="r-in"><span>  Intensity <span class="op">=</span> <span class="st">"smoothed"</span>,</span></span>
<span class="r-in"><span>  var2nd.series <span class="op">=</span> <span class="st">"time_s"</span>,</span></span>
<span class="r-in"><span>  var2nd.series.slct.by <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  line.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>,</span></span>
<span class="r-in"><span>                  <span class="st">"darkblue"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  legend.title <span class="op">=</span> <span class="st">"Time (s)"</span>,</span></span>
<span class="r-in"><span>  yTicks <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="smooth_EPR_Spec_by_npreg-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ján Tarábek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

