<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Theoretical quantitative kinetic profiles (such as concentration/amount/integral intensity)
  as well as comparison with the experimental data for various predefined model reactions involving
  radical(s) (labeled as "R"). Profiles are evaluated by the numeric solution of rate equations
  by the Ordinary Differential Equations (ODE from
  desolve R package).
  This function is inspired by the
  R-bloggers
  article.'><title>Quantitative EPR Kinetic Model Profiles by Numeric Solution of the ODE. — eval_kinR_ODE_model • eprscope</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Quantitative EPR Kinetic Model Profiles by Numeric Solution of the ODE. — eval_kinR_ODE_model"><meta property="og:description" content='Theoretical quantitative kinetic profiles (such as concentration/amount/integral intensity)
  as well as comparison with the experimental data for various predefined model reactions involving
  radical(s) (labeled as "R"). Profiles are evaluated by the numeric solution of rate equations
  by the Ordinary Differential Equations (ODE from
  desolve R package).
  This function is inspired by the
  R-bloggers
  article.'><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eprscope</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/datasets.html">Package Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/functionality.html">Basic Functionality</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jatanrt/eprscope/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Quantitative EPR Kinetic Model Profiles by Numeric Solution of the ODE.</h1>
      <small class="dont-index">Source: <a href="https://github.com/jatanrt/eprscope/blob/master/R/eval_kinR_ODE_model.R" class="external-link"><code>R/eval_kinR_ODE_model.R</code></a></small>
      <div class="d-none name"><code>eval_kinR_ODE_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Theoretical quantitative kinetic profiles (such as concentration/amount/integral intensity)
  as well as comparison with the experimental data for various predefined model reactions involving
  radical(s) (labeled as "R"). Profiles are evaluated by the numeric solution of rate equations
  by the <strong>O</strong>rdinary <strong>D</strong>ifferential <strong>E</strong>quations (ODE from
  <a href="https://desolve.r-forge.r-project.org/index.html" class="external-link">desolve R package</a>).
  This function is inspired by the
  <a href="https://www.r-bloggers.com/2013/06/learning-r-parameter-fitting-for-models-involving-differential-equations/" class="external-link">R-bloggers
  article</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eval_kinR_ODE_model</span><span class="op">(</span></span>
<span>  model.react <span class="op">=</span> <span class="st">"(r=1)R --&gt; [k1] B"</span>,</span>
<span>  model.expr.diff <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  elementary.react <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  kin.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k1 <span class="op">=</span> <span class="fl">0.001</span>, qvar0R <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>  time.unit <span class="op">=</span> <span class="st">"s"</span>,</span>
<span>  time.Interval.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1800</span><span class="op">)</span>,</span>
<span>  time.Frame.model <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  data.qt.expr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time.expr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qvar.expr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model-react">model.react<a class="anchor" aria-label="anchor" href="#arg-model-react"></a></dt>
<dd><p>Character string, denoting a specific radical (<code>"R"</code>) reaction related to
changes in integral intensities (or any other <strong>q</strong>uantitative <strong>var</strong>iable) in EPR spectral
time series. Arrow shows direction of the reaction (<code>"--&gt;", forward</code> or <code>"&lt;==&gt;", forward + reverse</code>).
Rate constants are indicated by square brackets after the arrows. Following examples of the reaction schemes
are predefined and commonly used to describe the integral intensity and/or radical concentration/amount
changes during the EPR time series experiment (the <code>r,a,b</code> stoichiometric coefficients
may vary, see below).</p><table class="table table"><tr><td><strong>Reaction Scheme</strong></td><td><strong>model.react</strong></td></tr><tr><td>\((r=1)\text{R} \xrightarrow{k_1} \text{B}\)</td><td><code>"(r=1)R --&gt; [k1] B"</code></td></tr><tr><td>\((a=2)\text{A} \xrightarrow{k_1} (r=2)\text{R}\)</td><td><code>"(a=2)A --&gt; [k1] (r=2)R"</code></td></tr><tr><td>\((a=2)\text{A} \xrightleftharpoons[k_4]{k_1} (r=2)\text{R}
 \xrightleftharpoons[k_3]{k_2} (b=1)\text{B}\)</td><td><code>"(a=2)A &lt;==&gt; [k1] [k4] (r=2)R &lt;==&gt; [k2] [k3] (b=1)B"</code></td></tr><tr><td>\((r=1)\text{R} \xrightleftharpoons[k_2]{k_1} (b=1)\text{B}\)</td><td><code>"(r=1)R &lt;==&gt; [k1] [k2] (b=1)B"</code></td></tr><tr><td>\((a=2)\text{A} \xrightleftharpoons[k_2]{k_1} (r=2)\text{R}\)</td><td><code>"(a=2)A &lt;==&gt; [k1] [k2] (r=2)R"</code></td></tr><tr><td>\((a=1)\text{A} + (b=1)\text{B} \xrightarrow{k_1} (r=1)\text{R}\)</td><td><code>"(a=1)A + (b=1)B --&gt; [k1] (r=1)R"</code></td></tr><tr><td>\((a=1)\text{A} + (r=1)\text{R} \xrightarrow{k_1} \text{B}\)</td><td><code>"(a=1)A + (r=1)R --&gt; [k1] B"</code></td></tr></table><p>Couple of examples are also given in <code>Details</code>. The function is relatively flexible and enables
later addition of any other reaction schemes describing the EPR time series experiments
(YOU MAY ASK DEVELOPER(S) via forum/help-channels). The stoichiometric coefficient (such as <code>(r=1)</code>
or <code>(a=1)</code>) can be varied within the <code>model.react</code> character string.
Defined/Allowed values are integers e.g. 1,2,3...etc. The space character within the <code>model.react</code>
string is not fixed and can be skipped for the sake of simplicity.
If <code>elementary.react = FALSE</code> (the model reaction is not considered as an elementary one),
a possible non-integer partial coefficients (e.g. <code>alpha</code>,<code>beta</code> or <code>gamma</code>)
must be included in <code>kin.params</code> (see also <code>kin.params</code> description). For the consecutive model reaction
presented above, it applies only to one part of the mechanism.</p></dd>


<dt id="arg-model-expr-diff">model.expr.diff<a class="anchor" aria-label="anchor" href="#arg-model-expr-diff"></a></dt>
<dd><p>Logical, difference between the integral intensities/areas under the EPR spectra calculated
using the experimental data and those generated by the model. By <strong>default</strong> the argument
is <strong>FALSE</strong> and it is ONLY ACTIVATED (<code>model.expr.diff = TRUE</code>) IN THE CASE WHEN THE KINETIC MODEL
FITTING PROCEDURE (see also <code><a href="eval_kinR_EPR_modelFit.html">eval_kinR_EPR_modelFit</a></code> or examples below) IS PERFORMED.</p></dd>


<dt id="arg-elementary-react">elementary.react<a class="anchor" aria-label="anchor" href="#arg-elementary-react"></a></dt>
<dd><p>Logical, if the model reaction should be considered as the elementary one,
i.e. the stoichiometric coefficients equal to the partial reaction orders. Such reaction proceeds without
identifiable intermediate species forming. <strong>Default</strong>: <code>elementary.react = TRUE</code>.
If <code>elementary.react = FALSE</code>, i.e. the <code>model.react</code> cannot be considered like an elementary one,
one must include the parameterized reaction orders \(\alpha\), \(\beta\) or \(\gamma\) in
the <code>kin.params</code>, e.g <code>kin.params = c(k1 = 0.01, qvar0A = 0.05, alpha = 1.5)</code>. For the consecutive
model reaction presented above, it applies only to one part of the mechanism.</p></dd>


<dt id="arg-kin-params">kin.params<a class="anchor" aria-label="anchor" href="#arg-kin-params"></a></dt>
<dd><p>Named numeric vector, containing rate constants as well as initial radical
or other reactant/product concentration/integral intensities/areas...etc. Therefore, a general
<code>qvar</code> (<strong>q</strong>uantitative <strong>var</strong>iable) was defined which may actually reflect
all above-mentioned quantities. <strong>Default</strong>: <code>kin.params = c(k1 = 0.001,qvar0R = 0.02)</code>.
The initial values are denoted as <code>qvar0X</code> (e.g. qvar0R for radical or qvar0A for the reactant <code>A</code>).
The components of <code>kin.params</code> depend on <code>model.react</code> as well as on the <code>elementary.react</code>.
If <code>elementary.react = FALSE</code> additional parameters like partial reaction orders (<code>alpha</code>
and/or <code>beta</code> and/or <code>gamma</code>) must be defined within the <code>kin.params</code>, like summarized
in the following table:</p><table class="table table"><tr><td><strong>model.react</strong></td><td><strong>Essential kin.params components</strong></td></tr><tr><td><code>"(r=1)R --&gt; [k1] B"</code></td><td><code>k1</code>, <code>qvar0R</code>, (<code>alpha</code>)</td></tr><tr><td><code>"(a=1)A --&gt; [k1] (r=1)R"</code></td><td><code>k1</code>, <code>qvar0A</code>, <code>qvar0R</code>, (<code>alpha</code>)</td></tr><tr><td><code>"(a=1)A &lt;==&gt; [k1] [k4] (r=1)R &lt;==&gt; [k2] [k3] (b=1)B"</code></td><td><code>k1</code>, <code>k2</code>,
<code>k3</code>, <code>k4</code>, <code>qvar0A</code>, <code>qvar0R</code>, <code>qvar0B</code>, (<code>alpha</code>,
<code>beta</code>, <code>gamma</code>)</td></tr><tr><td><code>"(r=1)R &lt;==&gt; [k1] [k2] (b=1)B"</code></td><td><code>k1</code>, <code>k2</code>, <code>qvar0R</code>,
<code>qvar0B</code>, (<code>alpha</code>, <code>beta</code>)</td></tr><tr><td><code>"(a=1)A &lt;==&gt; [k1] [k2] (r=1)R"</code></td><td><code>k1</code>, <code>k2</code>, <code>qvar0A</code>,
<code>qvar0R</code>, (<code>alpha</code>, <code>beta</code>)</td></tr><tr><td><code>"(a=1)A + (b=1)B --&gt; [k1] (r=1)R"</code></td><td><code>k1</code>, <code>qvar0A</code>, <code>qvar0B</code>,
<code>qvar0R</code>, (<code>alpha</code>,<code>beta</code>)</td></tr><tr><td><code>"(a=1)A + (r=1)R --&gt; [k1] B"</code></td><td><code>k1</code>, <code>qvar0A</code>,
<code>qvar0R</code>, (<code>alpha</code>,<code>beta</code>)</td></tr></table></dd>


<dt id="arg-time-unit">time.unit<a class="anchor" aria-label="anchor" href="#arg-time-unit"></a></dt>
<dd><p>Character string, corresponding to time unit like <code>"s"</code> (<strong>default</strong>),
<code>"min"</code> or <code>"h"</code>.</p></dd>


<dt id="arg-time-interval-model">time.Interval.model<a class="anchor" aria-label="anchor" href="#arg-time-interval-model"></a></dt>
<dd><p>Numeric vector, including two values: starting and final time/termination
of the model reaction (e.g. <code>c(0,1800)</code> in seconds, <strong>default</strong>).</p></dd>


<dt id="arg-time-frame-model">time.Frame.model<a class="anchor" aria-label="anchor" href="#arg-time-frame-model"></a></dt>
<dd><p>Numeric value, corresponding to interval time resolution, i.e. the smallest time difference
between two consecutive points. The number of points is thus defined by the <code>time.Interval.model</code> argument:
$$((Interval[2] - Interval[1])\,/\,Frame) + 1$$
This argument is required to numerically solve the kinetic differential equations by the <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></code>.
For the default interval mentioned above, the <strong>default</strong> value reads <code>time.Frame.model = 2</code> (in seconds).</p></dd>


<dt id="arg-data-qt-expr">data.qt.expr<a class="anchor" aria-label="anchor" href="#arg-data-qt-expr"></a></dt>
<dd><p>A data frame object, containing the concentrations/integral intensities/areas under
the EPR spectra calculated using the <strong>experimental data</strong> as well as time column. These two essential
column headers are described by the character strings like those below <code>time.expr</code> and <code>qvar.expr</code>.
The <code>data.qt.expr</code> MUST BE USED ONLY IN SUCH CASE WHEN THE EXPERIMENTAL TIME HAS TO BE INCLUDED
IN THE KINETIC MODEL (e.g. also for THE FITTING of EXPERIMENTAL DATA BY THE KINETIC MODEL).
<strong>Default</strong>: <code>data.qt.expr = NULL</code>.</p></dd>


<dt id="arg-time-expr">time.expr<a class="anchor" aria-label="anchor" href="#arg-time-expr"></a></dt>
<dd><p>Character string, pointing to <code>time</code> column/variable name in the original
<code>data.qt.expr</code> data frame. <strong>Default</strong>: <code>time.expr = NULL</code> (when the experimental
data aren't taken into account). If the time has to be corrected (e.g. in the case of double integrals),
please use <code><a href="correct_time_Exp_Specs.html">correct_time_Exp_Specs</a></code> function prior to kinetic evaluation.</p></dd>


<dt id="arg-qvar-expr">qvar.expr<a class="anchor" aria-label="anchor" href="#arg-qvar-expr"></a></dt>
<dd><p>Character string, pointing to <code>qvar</code> column/variable name in the original
<code>data.qt.expr</code> data frame. <strong>Default</strong>: <code>qvar.expr = NULL</code> (when the experimental
data aren't taken into account).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to the ODE (see also <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If the function <strong>is not used for fitting</strong> of the experimental and processed data,
  the result is <code>list</code> consisting of:</p><dl><dt>df</dt>
<dd><p>Data frame containing <code>time</code> column and <code>qvar</code>, quantitative variable,
  columns corresponding to quantities of different relevant species
  denoted as <code>"R"</code>, <code>"A"</code>, <code>"B"</code> + if <code>data.qt.expr</code> is NOT NULL
  additional experimental quantitative variable is present.</p></dd>

  <dt>plot</dt>
<dd><p>Plot object containing <code>time</code> as \(x\)-axis and <code>qvar</code>
  (see <code>df</code> above) as \(y\)-axis + if <code>data.qt.expr</code> is NOT NULL the experimental
  quantitative variable is presented as well.</p></dd>


</dl><p>Applying function <strong>for the fitting</strong> procedure
  requires <code>model.expr.diff = TRUE</code> and therefore the result is represented by difference between
  the integral intensities/areas, calculated using the experimental data
  and those generated by the model.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>According to IUPAC (2019), see <code>References</code>, the rate of a chemical reaction
  with the radicals (\(\text{R}\)) involved (example see argument <code>model.react</code>)
  $$a\text{A} + r\text{R} \xrightarrow\, b\text{B}$$
  is expressed via time change of extent of the reaction (\(\text{d}\xi/\text{d}t\)):
  $$-(1/r)\,(\text{d}n_{\text{R}}/\text{d}t) = -(1/a)\,(\text{d}n_{\text{A}}/\text{d}t) =
  (1/b)\,(\text{d}n_{\text{B}}/\text{d}t)$$
  where \(a,r,b\) are the stoichiometric coefficients. At constant volume (\(V\)) conditions
  (or if volume changes are negligible) the amount (\(n\) in mole) of reactant/product
  can be replaced by its corresponding concentration (\(c = n/V\)). Such reaction rate
  (expressed in moles per unit volume and per second) is function of temperature (\(T\)),
  pressure (\(p\)) as well as that of concentration of reactants/products.
  For the reaction example shown above it applies (for radical \(\text{R}\)):
  $$\text{d}c_{\text{R}}/\text{d}t = - r\,k(T,p)\,c_{\text{A}}^{\alpha}\,c_{\text{R}}^{\beta}$$
  This is called rate law, where \(k\) is the rate constant and its pressure dependence is usually
  small and therefore can be ignored, in the first approach. Coefficients \(\alpha\) and \(\beta\),
  in general, correspond to fitting parameters, coming from experimental relation of the reaction
  rate and the concentration of reactants/products. These coefficients are called <strong>partial reaction orders</strong>
  or <code>PROs</code> and their <strong>sum</strong> represents <strong>total order of the reaction</strong>. If the kinetic equation
  for the reaction corresponds to its stoichiometry, the reaction is described as the elementary
  one. In EPR Spectroscopy the number of radicals is directly proportional to (double) integral
  of the radical EPR spectrum (see also <code><a href="quantify_EPR_Abs.html">quantify_EPR_Abs</a></code>). Therefore, one can obtain
  the rate constant from the rate law fit onto the experimental EPR spectral time series outputs, i.e. integral
  intensity (area under the spectral curve) of radical ("R") formation and/or decay (see also
  <code><a href="eval_kinR_EPR_modelFit.html">eval_kinR_EPR_modelFit</a></code>). Quantitative kinetic profiles (such as that
  \(\text{d}c_{\text{R}}/\text{d}t\) described above) are not evaluated
  by integration of the kinetic equations/rate laws. However, by numeric solution of the Ordinary
  Differential Equations, <a href="https://desolve.r-forge.r-project.org/index.html" class="external-link">ODE in <code>{desolve}</code> R package</a>.
  Therefore, higher number of models is available than for integrated
  differential equations because for complex mechanisms it's quite often highly demanding to obtain
  the analytical solution by integration. <strong>Several kinetic models for radical reactions</strong> in EPR spectroscopy
  <strong>are predefined and summarized</strong> below (see also <code>model.react</code> function argument).</p><table class="table table"><tr><td><strong>model.react</strong></td><td><strong>Short Description</strong></td></tr><tr><td><code>"(r=1)R --&gt; [k1] B"</code></td><td>Basic forward reaction,
  e.g. irrev. dimerization (if <code>(r=2)</code>).</td></tr><tr><td><code>"(a=1)A --&gt; [k1] (r=1)R"</code></td><td>Basic forward radical formation</td></tr><tr><td><code>"(a=1)A &lt;==&gt; [k1] [k4] (r=1)R &lt;==&gt; [k2] [k3] (b=1)B"</code></td><td>Consecutive reactions,
  e.g. considering comproportionation (for <code>(a=2)</code> and <code>(r=2)</code>) + follow-up reversible
  dimerization (<code>(b=1)</code>).</td></tr><tr><td><code>"(r=1)R &lt;==&gt; [k1] [k2] (b=1)B"</code></td><td>Basic reversible radical quenching,
  e.g. rev. \(\pi-\pi\) dimerization for <code>(r=2)</code> and <code>(b=1)</code>.</td></tr><tr><td><code>"(a=1)A &lt;==&gt; [k1] [k2] (r=1)R"</code></td><td>Basic reversible radical formation,
  e.g. from rev. comproportionation of conjugated thiophene oligomers
  (\(\text{A}^{++} + \text{A}^0 \xrightleftharpoons ~ 2\text{R}^{.+}\), for <code>(a=2)</code> and <code>(r=2)</code>).</td></tr><tr><td><code>"(a=1)A + (b=1)B --&gt; [k1] (r=1)R"</code></td><td>Radical formation by chemical reaction like oxidation,
  reduction or spin trapping (if <code>A</code> refers to transient radical, which is not visible within
  the common EPR time scale).</td></tr><tr><td><code>"(a=1)A + (r=1)R --&gt; [k1] B"</code></td><td>General radical quenching by chemical reaction.</td></tr></table></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>International Union of Pure and Applied Chemistry (IUPAC) (2019). “Rate of Reaction”,
 <a href="https://goldbook.iupac.org/terms/view/R05156" class="external-link">https://goldbook.iupac.org/terms/view/R05156</a>.</p>
<p>Quisenberry KT, Tellinghuisen J (2006). “Textbook Deficiencies: Ambiguities in Chemical Kinetics Rates
 and Rate Constants.” <em>J. Chem. Educ.</em>, <strong>83</strong>(3), 510, <a href="https://doi.org/10.1021/ed083p510" class="external-link">https://doi.org/10.1021/ed083p510</a>.</p>
<p>Levine IN (2009). <em>Physical Chemistry</em>, 6th edition. McGraw-Hill, ISBN 978-0-072-53862-5,
 <a href="https://books.google.cz/books/about/Physical_Chemistry.html?id=L5juAAAAMAAJ&amp;redir_esc=y" class="external-link">https://books.google.cz/books/about/Physical_Chemistry.html?id=L5juAAAAMAAJ&amp;redir_esc=y</a>.</p>
<p>rdabbler (2013). “Learning R: Parameter Fitting for Models Involving Differential Equations”,
 <a href="https://www.r-bloggers.com/2013/06/learning-r-parameter-fitting-for-models-involving-differential-equations/" class="external-link">https://www.r-bloggers.com/2013/06/learning-r-parameter-fitting-for-models-involving-differential-equations/</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Evaluations and Quantification:
<code><a href="eval_integ_EPR_Spec.html">eval_integ_EPR_Spec</a>()</code>,
<code><a href="eval_kinR_EPR_modelFit.html">eval_kinR_EPR_modelFit</a>()</code>,
<code><a href="quantify_EPR_Abs.html">quantify_EPR_Abs</a>()</code>,
<code><a href="quantify_EPR_Norm_const.html">quantify_EPR_Norm_const</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## irreversible dimerization quantitative kinetic profile</span></span></span>
<span class="r-in"><span><span class="co">## table (df) with first 10 observations/rows</span></span></span>
<span class="r-in"><span><span class="va">kin.test.01</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">eval_kinR_ODE_model</span><span class="op">(</span>model.react <span class="op">=</span> <span class="st">"(r=2)R --&gt; [k1] B"</span>,</span></span>
<span class="r-in"><span>                      kin.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k1 <span class="op">=</span> <span class="fl">0.012</span>,</span></span>
<span class="r-in"><span>                                     qvar0R <span class="op">=</span> <span class="fl">0.08</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## preview</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kin.test.01</span><span class="op">$</span><span class="va">df</span>,n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    time           R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     0 0.080000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2 0.079693973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     4 0.079390278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     6 0.079088889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     8 0.078789783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    10 0.078492930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    12 0.078198306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    14 0.077905884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    16 0.077615642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   18 0.077327554</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## consecutive reactions and the corresponding plot</span></span></span>
<span class="r-in"><span><span class="co">## (`model.react` character string without spaces)</span></span></span>
<span class="r-in"><span><span class="va">kin.test.02</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span> <span class="fu">eval_kinR_ODE_model</span><span class="op">(</span></span></span>
<span class="r-in"><span>   model.react <span class="op">=</span> <span class="st">"(a=2)A&lt;==&gt;[k1][k4](r=2)R&lt;==&gt;[k2][k3](b=1)B"</span>,</span></span>
<span class="r-in"><span>   kin.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k1 <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                  k2 <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                  k3 <span class="op">=</span> <span class="fl">2e-4</span>,</span></span>
<span class="r-in"><span>                  k4 <span class="op">=</span> <span class="fl">2e-5</span>,</span></span>
<span class="r-in"><span>                  qvar0A <span class="op">=</span> <span class="fl">0.02</span>,</span></span>
<span class="r-in"><span>                  qvar0R <span class="op">=</span> <span class="fl">0.002</span>,</span></span>
<span class="r-in"><span>                  qvar0B <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## plot preview</span></span></span>
<span class="r-in"><span><span class="va">kin.test.02</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="eval_kinR_ODE_model-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## data frame/table preview</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kin.test.02</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time           A            R             B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    0 0.020000000 0.0020000000 0.0000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    2 0.019841265 0.0021570046 8.6509396e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    4 0.019685030 0.0023112417 1.8639989e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    6 0.019531237 0.0024627557 3.0037259e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    8 0.019379835 0.0026115850 4.2900127e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   10 0.019230760 0.0027577797 5.7300903e-06</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## loading example data (incl. `Area` and `time` variables)</span></span></span>
<span class="r-in"><span><span class="co">## from Xenon: decay of a triarylamine radical cation</span></span></span>
<span class="r-in"><span><span class="co">## after its generation by electrochemical oxidation</span></span></span>
<span class="r-in"><span><span class="va">triaryl_radCat_path</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="load_data_example.html">load_data_example</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"Triarylamine_radCat_decay_a.txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## corresponding data (double integrated</span></span></span>
<span class="r-in"><span><span class="co">## EPR spectrum = `Area` vs `time`)</span></span></span>
<span class="r-in"><span><span class="va">triaryl_radCat_data</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="readEPR_Exp_Specs.html">readEPR_Exp_Specs</a></span><span class="op">(</span><span class="va">triaryl_radCat_path</span>,</span></span>
<span class="r-in"><span>                    header <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                    fill <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                    select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time_s"</span>,<span class="st">"Area"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    x.unit <span class="op">=</span> <span class="st">"s"</span>,</span></span>
<span class="r-in"><span>                    x.id <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                    Intensity.id <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                    qValue <span class="op">=</span> <span class="fl">1700</span>,</span></span>
<span class="r-in"><span>                    data.structure <span class="op">=</span> <span class="st">"others"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## data preview</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">triaryl_radCat_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    time_s        Area</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;num&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:   0.00 0.018741176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:  15.17 0.018117647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:  30.01 0.017617647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:  44.82 0.017194118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:  59.66 0.016511765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:  74.52 0.016347059</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## comparison of the kinetic model with the experimental</span></span></span>
<span class="r-in"><span><span class="co">## data `triaryl_radCat_data`, kinetic parameters were estimated</span></span></span>
<span class="r-in"><span><span class="co">## to be as close as possible to the latter.</span></span></span>
<span class="r-in"><span><span class="va">compar_model_expr_data_01</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">eval_kinR_ODE_model</span><span class="op">(</span>model.react <span class="op">=</span> <span class="st">"(r=2)R --&gt; [k1] B"</span>,</span></span>
<span class="r-in"><span>                      kin.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>qvar0R <span class="op">=</span> <span class="fl">0.019</span>,</span></span>
<span class="r-in"><span>                                     k1 <span class="op">=</span> <span class="fl">0.04</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      time.Interval.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1500</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      data.qt.expr <span class="op">=</span> <span class="va">triaryl_radCat_data</span>,</span></span>
<span class="r-in"><span>                      qvar.expr <span class="op">=</span> <span class="st">"Area"</span>,</span></span>
<span class="r-in"><span>                      time.expr <span class="op">=</span> <span class="st">"time_s"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## plot preview</span></span></span>
<span class="r-in"><span><span class="va">compar_model_expr_data_01</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="eval_kinR_ODE_model-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## previous kinetic model with partial reaction</span></span></span>
<span class="r-in"><span><span class="co">## order ("alpha") corresponding to "R" (radical species).</span></span></span>
<span class="r-in"><span><span class="co">## In such case REACTION is NOT CONSIDERED</span></span></span>
<span class="r-in"><span><span class="co">## as an ELEMENTARY one !</span></span></span>
<span class="r-in"><span><span class="va">compar_model_expr_data_02</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">eval_kinR_ODE_model</span><span class="op">(</span>model.react <span class="op">=</span> <span class="st">"(r=2)R --&gt; [k1] B"</span>,</span></span>
<span class="r-in"><span>                      elementary.react <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                      kin.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>qvar0R <span class="op">=</span> <span class="fl">0.019</span>,</span></span>
<span class="r-in"><span>                                     k1 <span class="op">=</span> <span class="fl">0.04</span>,</span></span>
<span class="r-in"><span>                                     alpha <span class="op">=</span> <span class="fl">1.9</span></span></span>
<span class="r-in"><span>                                    <span class="op">)</span>,</span></span>
<span class="r-in"><span>                      time.Interval.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1500</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      data.qt.expr <span class="op">=</span> <span class="va">triaryl_radCat_data</span>,</span></span>
<span class="r-in"><span>                      qvar.expr <span class="op">=</span> <span class="st">"Area"</span>,</span></span>
<span class="r-in"><span>                      time.expr <span class="op">=</span> <span class="st">"time_s"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## plot preview</span></span></span>
<span class="r-in"><span><span class="va">compar_model_expr_data_02</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="eval_kinR_ODE_model-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ján Tarábek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

