<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Evaluating the linear combination of spectral intensities of components (loaded as ASCII text files corresponding
  to simulated spectra). The related intensity multiplication coefficients
  (please, refer to the optim.params.init argument) are optimized by methods gathered in the
  optim_for_EPR_fitness. The goal is to fit the sum of the simulated components
  onto each experimental spectrum within series. The maximum number of components is set to 10."><title>Quantify (Components) Areas of Series of Simulated EPR Spectra — quantify_EPR_Sim_series • eprscope</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Quantify (Components) Areas of Series of Simulated EPR Spectra — quantify_EPR_Sim_series"><meta property="og:description" content="Evaluating the linear combination of spectral intensities of components (loaded as ASCII text files corresponding
  to simulated spectra). The related intensity multiplication coefficients
  (please, refer to the optim.params.init argument) are optimized by methods gathered in the
  optim_for_EPR_fitness. The goal is to fit the sum of the simulated components
  onto each experimental spectrum within series. The maximum number of components is set to 10."><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eprscope</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.13</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/datasets.html">Package Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/functionality.html">Basic Functionality</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jatanrt/eprscope/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Quantify (Components) Areas of Series of Simulated EPR Spectra</h1>
      <small class="dont-index">Source: <a href="https://github.com/jatanrt/eprscope/blob/master/R/quantify_EPR_Sim_series.R" class="external-link"><code>R/quantify_EPR_Sim_series.R</code></a></small>
      <div class="d-none name"><code>quantify_EPR_Sim_series.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Evaluating the linear combination of spectral intensities of components (loaded as ASCII text files corresponding
  to simulated spectra). The related intensity multiplication coefficients
  (please, refer to the <code>optim.params.init</code> argument) are optimized by methods gathered in the
  <code><a href="optim_for_EPR_fitness.html">optim_for_EPR_fitness</a></code>. The goal is to fit the sum of the simulated components
  onto each experimental spectrum within series. The maximum number of components is set to 10.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">quantify_EPR_Sim_series</span><span class="op">(</span></span>
<span>  <span class="va">data.spectra.series</span>,</span>
<span>  <span class="va">dir_ASC_sim</span>,</span>
<span>  <span class="va">name.pattern.sim</span>,</span>
<span>  sim.origin <span class="op">=</span> <span class="st">"easyspin"</span>,</span>
<span>  var2nd.series <span class="op">=</span> <span class="st">"time_s"</span>,</span>
<span>  B.unit <span class="op">=</span> <span class="st">"G"</span>,</span>
<span>  Intensity.expr <span class="op">=</span> <span class="st">"dIepr_over_dB"</span>,</span>
<span>  Intensity.sim <span class="op">=</span> <span class="st">"dIeprSim_over_dB"</span>,</span>
<span>  optim.method <span class="op">=</span> <span class="st">"sbplx"</span>,</span>
<span>  <span class="va">optim.params.init</span>,</span>
<span>  optim.params.lower <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  optim.params.upper <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Nmax.evals <span class="op">=</span> <span class="fl">512</span>,</span>
<span>  tol.step <span class="op">=</span> <span class="fl">5e-07</span>,</span>
<span>  pswarm.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pswarm.diameter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pswarm.type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  single.integ <span class="op">=</span> <span class="st">"single_IntegSim"</span>,</span>
<span>  double.integ <span class="op">=</span> <span class="st">"double_IntegSim"</span>,</span>
<span>  msg.optim.progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  output.area.stat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-spectra-series">data.spectra.series<a class="anchor" aria-label="anchor" href="#arg-data-spectra-series"></a></dt>
<dd><p>Spectrum data frame/table object containing magnetic flux density
as <code>x</code> variable. They can be labeled as <code>Field</code>, <code>B_mT</code>
in mT (or <code>B_G</code> in gauss). The <code>y/Intensity</code> variable
can be labeled as <code>dIepr_over_dB</code>, in case of derivative intensity, or if
integrated spectral intensities are present, they can be labeled accordingly.
See also <code>Intensity.expr</code> parameter/argument. A second independent variable
<code>var2nd.series</code> column (e.g. <code>var2nd.series = "time_s"</code>) must be available. In such case,
the entire <code>data.spectra</code> must be present in the form of
<a href="https://r4ds.had.co.nz/tidy-data.html" class="external-link">tidy/long table format</a>
(see also the parameter/argument <code>var2nd.series</code>). Such data frame can be created, e.g.
by the <code><a href="readEPR_Exp_Specs_kin.html">readEPR_Exp_Specs_kin</a></code> or the <code><a href="readEPR_Exp_Specs_multif.html">readEPR_Exp_Specs_multif</a></code> function.</p></dd>


<dt id="arg-dir-asc-sim">dir_ASC_sim<a class="anchor" aria-label="anchor" href="#arg-dir-asc-sim"></a></dt>
<dd><p>Character string, pointing to folder where the simulated EPR spectra (data files) of all
components are stored. Path can be alternatively specified by the <code><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></code> function.</p></dd>


<dt id="arg-name-pattern-sim">name.pattern.sim<a class="anchor" aria-label="anchor" href="#arg-name-pattern-sim"></a></dt>
<dd><p>Character string pattern from file names related to simulated EPR spectral data
like <code>name.pattern.sim = "DHMB0_1st_04_SimA"</code>
or <code>name.pattern.sim = "DHMB0_1st_04_Sim[[:upper:]]"</code> (for the file names <code>..._SimA</code>,
<code>..._SimB</code>,...etc). It assumes, those files must have similar names and this pattern appears
at the beginning of the file name. One may also consult
how to <a href="https://r4ds.hadley.nz/regexps" class="external-link">use regular expressions in R</a>.</p></dd>


<dt id="arg-sim-origin">sim.origin<a class="anchor" aria-label="anchor" href="#arg-sim-origin"></a></dt>
<dd><p>Character string, referring to "origin" of the simulated ASCII data.
There are four possibilities \(\Rightarrow\) <code>sim.orimgin = "easyspin"</code> (<strong>default</strong>),
<code>"xenon"</code>, <code>"simfonia"</code> as well as universal <code>"csv"</code>.</p></dd>


<dt id="arg-var-nd-series">var2nd.series<a class="anchor" aria-label="anchor" href="#arg-var-nd-series"></a></dt>
<dd><p>Character string referred to name of the second independent variable/quantity
column in the original <code>data.spectra.series</code> (such as time, temperature, electrochemical potential,
Microwave Power) altered during individual experiments as a second variable.
Data must be available in tidy/long table format.
<strong>Default</strong>: <code>var2nd.series = "time_s"</code>.</p></dd>


<dt id="arg-b-unit">B.unit<a class="anchor" aria-label="anchor" href="#arg-b-unit"></a></dt>
<dd><p>Character string, pointing to unit of magnetic flux density
like <code>"G"</code> (Gauss) or <code>"mT"</code> (millitesla), <strong>default</strong>: <code>B.unit = "G"</code>.
THE UNIT MUST BE SHARED ACROSS ALL RELEVANT B-ARGUMENTS/DATAFRAMES.</p></dd>


<dt id="arg-intensity-expr">Intensity.expr<a class="anchor" aria-label="anchor" href="#arg-intensity-expr"></a></dt>
<dd><p>Character string, pointing to column name of the experimental EPR intensity within
the original <code>data.spectra.series</code>. <strong>Default</strong>: <code>dIepr_over_dB</code>.</p></dd>


<dt id="arg-intensity-sim">Intensity.sim<a class="anchor" aria-label="anchor" href="#arg-intensity-sim"></a></dt>
<dd><p>Character string pointing to column name of the simulated EPR intensity within the related
data frames (check the simulated spectral data for all components).
<strong>Default</strong>: <code>Intensity.sim = "dIeprSim_over_dB"</code>.</p></dd>


<dt id="arg-optim-method">optim.method<a class="anchor" aria-label="anchor" href="#arg-optim-method"></a></dt>
<dd><p>Character string, pointing to applied optimization method/algorithm.
One may choose <strong>one</strong> from those listed in <code><a href="optim_for_EPR_fitness.html">optim_for_EPR_fitness</a></code>, <strong>default</strong>:
<code>method = "sbplx"</code>, setting up
the <a href="https://nlopt.readthedocs.io/en/latest/NLopt_Algorithms/#sbplx-based-on-subplex" class="external-link">"Subplex" method</a>.</p></dd>


<dt id="arg-optim-params-init">optim.params.init<a class="anchor" aria-label="anchor" href="#arg-optim-params-init"></a></dt>
<dd><p>Numeric vector with the elements: baseline constant/intercept
followed by simulated intensity multiplication coefficient for each EPR spectral component.
Therefore, the length of this vector is equal to number of components + 1.</p></dd>


<dt id="arg-optim-params-lower">optim.params.lower<a class="anchor" aria-label="anchor" href="#arg-optim-params-lower"></a></dt>
<dd><p>Numeric vector with the length of <code>optim.params.init</code> and the lower
bound constraints. <strong>Default</strong>: <code>optim.params.init = NULL</code>, actually corresponding
to vector with all <code>0</code> value elements.</p></dd>


<dt id="arg-optim-params-upper">optim.params.upper<a class="anchor" aria-label="anchor" href="#arg-optim-params-upper"></a></dt>
<dd><p>Numeric vector with the length of <code>optim.params.init</code>) and the upper
bound constraints. <strong>Default</strong>: <code>optim.params.init = NULL</code>, actually corresponding
to vector with all <code>0.9</code> value elements.</p></dd>


<dt id="arg-nmax-evals">Nmax.evals<a class="anchor" aria-label="anchor" href="#arg-nmax-evals"></a></dt>
<dd><p>Numeric value, maximum number of function evaluations and/or iterations.
The only one method, limited by this argument, is <code><a href="https://rdrr.io/pkg/minpack.lm/man/nls.lm.html" class="external-link">nls.lm</a></code>, where
<code>Nmax.evals = 1024</code>. Higher <code>Nmax.evals</code> may extremely extend the optimization
time, therefore the <strong>default</strong> value reads <code>Nmax.evals = 512</code>. However, the <code>"pswarm"</code>
method requires at least the default or even higher values.</p></dd>


<dt id="arg-tol-step">tol.step<a class="anchor" aria-label="anchor" href="#arg-tol-step"></a></dt>
<dd><p>Numeric, the smallest optimization step (relative change) between
2 iterations to stop the optimization procedure. For the <code>optim.method = "pswarm"</code>
(particle swarm optimization procedure) it actually corresponds to tolerance for restarting.
Once the maximum distance between the "best" particle and all the others is less
than <code>tol.step</code> * <code>pswarm.diameter</code>) the algorithm restarts.
See also <code><a href="https://rdrr.io/pkg/pso/man/psoptim.html" class="external-link">psoptim</a></code>. <strong>Default</strong>: <code>tol.step = 5e-7</code>.</p></dd>


<dt id="arg-pswarm-size">pswarm.size<a class="anchor" aria-label="anchor" href="#arg-pswarm-size"></a></dt>
<dd><p>Numeric value equal to particle swarm size (i.e. number of particles),
if <code>optim.method = "pswarm"</code>. The <strong>default</strong> value (<code>pswarm.size = NULL</code>) actually
corresponds to <code>floor(10+2*sqrt(length(optim.params.init)))</code> (for <code>SPSO2007</code>,
see the <code>pswarm.type</code> argument), e.g. to optimize 3 components, number of particles = 14.
For the <code>SPSO2011</code> the default number of particles equals to <code>40</code>.</p></dd>


<dt id="arg-pswarm-diameter">pswarm.diameter<a class="anchor" aria-label="anchor" href="#arg-pswarm-diameter"></a></dt>
<dd><p>Numeric value, corresponding to diameter of the particle swarm search space
(in case when <code>optim.method = "pswarm"</code>). The <strong>default</strong> value (<code>pswarm.diameter = NULL</code>)
refers to the Euclidean distance, defined as:
$$\sqrt{\sum_k\,(\text{optim.params.upper}[k] - \text{optim.params.lower}[k])^2}$$</p></dd>


<dt id="arg-pswarm-type">pswarm.type<a class="anchor" aria-label="anchor" href="#arg-pswarm-type"></a></dt>
<dd><p>Character string, setting the type/version of particle swarm algorithm
if <code>method = "pswarm"</code>. There are two types available: <code>pswarm.type = "SPSO2007"</code>
and <code>pswarm.type = "SPSO2011"</code>. The latter introduced an adaptive random topology,
which allows the swarm to dynamically adjust its communication structure.
This helps in maintaining diversity in the swarm and improves the algorithm's ability
to escape local optima. This type generally offers better performance on larger multidimensional spaces
than the <code>pswarm.type = "SPSO2007"</code>, which uses a more static topology. Details may be found
in the <code>References</code> of the <code><a href="optim_for_EPR_fitness.html">optim_for_EPR_fitness</a></code>.
<strong>Default</strong>: <code>pswarm.type = NULL</code> (actually corresponding to <code>"SPSO2007"</code>,
that performs slightly better on smaller scales such as common simulations of EPR spectra
with lower number of parameters like hyperfine coupling constants).</p></dd>


<dt id="arg-single-integ">single.integ<a class="anchor" aria-label="anchor" href="#arg-single-integ"></a></dt>
<dd><p>Character string, setting up the column/variable name related to single-integrated spectrum
within the output data frame, <strong>default</strong>: <code>single.integ = "single_IntegSim"</code>.</p></dd>


<dt id="arg-double-integ">double.integ<a class="anchor" aria-label="anchor" href="#arg-double-integ"></a></dt>
<dd><p>Character string, setting up the column/variable name related to double-integrated spectrum
within the output data frame, <strong>default</strong>: <code>double.integ = "double_IntegSim"</code>.
If <code>double.integ = NULL</code>, only single integrals are calculated/returned (e.g. in the case of
single integrated spectral data).</p></dd>


<dt id="arg-msg-optim-progress">msg.optim.progress<a class="anchor" aria-label="anchor" href="#arg-msg-optim-progress"></a></dt>
<dd><p>Logical, whether to display message (in the R console) about progress of the <code>optim.method</code>
during the optimization/fitting procedure, e.g.
<code>Intensities of simulated EPR spectral component(s) are currently being evaluated/optimized</code>
<code>by  NELDERMEAD  method  (4 Component(s))</code> and at the end it shows the elapsed time.
<strong>Default</strong>: <code>msg.optim.progress = TRUE</code>. If <code>FALSE</code>, no message
is displayed. This argument can be combined with the optional <code>eval.optim.progress</code>
(see below or described in the <code><a href="optim_for_EPR_fitness.html">optim_for_EPR_fitness</a></code>).</p></dd>


<dt id="arg-output-area-stat">output.area.stat<a class="anchor" aria-label="anchor" href="#arg-output-area-stat"></a></dt>
<dd><p>Logical, whether to summarize all fitted EPR spectral components, in columns,
for each time/temperature/...etc. point in row. Additional optimization measures are presented as well
(see <code>Value</code>).<strong>Default</strong>: <code>output.area.stat = TRUE</code>. Otherwise, tidy/long format
table is returned, including all EPR spectra and their corresponding integrals.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments specified, see also <code><a href="optim_for_EPR_fitness.html">optim_for_EPR_fitness</a></code>,
like <code>eval.optim.progress = TRUE</code> (which is <code>FALSE</code> by <strong>default</strong>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function provides data frame object, depending on the <code>output.area.stat</code> argument,
  as listed below:</p><ol><li><p>If <code>output.area.stat = TRUE</code> (<strong>default</strong>), the resulting data frame consists
  of columns/variables like integrals/areas for each simulated and fitted EPR spectrum, where
  the components are denoted by the uppercase letters (<code>Area_Sim_A</code>, <code>Area_Sim_B</code>,...etc.);
  best fitted/optimized coefficients to multiply the intensities (<code>Optim_CoeffInt_Sim_A</code>,
  <code>Optim_CoeffInt_Sim_B</code>,...etc); best fitted/optimized intercept (or baseline constant,
  <code>Optim_intercept</code>); minimum sum of residual squares (<code>min_RSS</code>); number
  of evaluations/iterations (<code>N_evals</code>) and finally convergence information/number (<code>N_converg</code>,
  like already described in the <code><a href="optim_for_EPR_fitness.html">optim_for_EPR_fitness</a></code>). These variables are presented for each
  <code>var2nd.series</code> (e.g. time) point like example for one EPR spectral component:</p><table class="table table"><tr><td><strong>time_s</strong></td><td><strong>Area_Sim_A</strong></td><td><strong>Optim_CoeffInt_Sim_A</strong></td><td><strong>Optim_intercept</strong></td><td><strong>min_RSS</strong></td><td><strong>N_evals</strong></td><td><strong>N_converg</strong></td></tr><tr><td>6</td><td>0.020624473</td><td>0.052843937</td><td>5.508809e-10</td><td>2.289953e-07</td><td>198</td><td>4</td></tr><tr><td>21</td><td>0.020217930</td><td>0.051802287</td><td>5.401823e-10</td><td>2.438172e-07</td><td>177</td><td>4</td></tr><tr><td>36</td><td>0.018836579</td><td>0.048263010</td><td>5.029705e-10</td><td>2.662651e-07</td><td>201</td><td>4</td></tr></table></li>
<li><p>If <code>output.area.stat = FALSE</code> Tidy/long table format of the original <code>data.spectra.series</code>
  with additional columns/variables (best fitted simulated intensities and their corresponding integrals)
  for all spectral components: A, B, C, ...etc.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Analyzed EPR spectra may consists of several components (see also the <code><a href="eval_sim_EPR_iso_combo.html">eval_sim_EPR_iso_combo</a></code>
  function), like the overlapped EPR spectra of several radicals. In order to follow the concentration/amount
  variations of each individual radical during the kinetic/temperature/...series, one must figure out,
  how those individual spectral components are actually changed. In the first approximation, it means
  to follow the corresponding EPR intensities/integrals, whereas the component positions (\(g\)-values)
  are assumed to be fixed (or those changes can be neglected). Therefore, the actual function takes the linear
  combination of the spectral intensities of components (simulated spectra) and optimizes
  the related multiplication coefficients. Additional analysis, where the positions of spectral
  components (simulated spectra) are not fixed and can be optimized as well, is under development.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Simulations and Optimization:
<code><a href="eval_sim_EPR_iso.html">eval_sim_EPR_iso</a>()</code>,
<code><a href="eval_sim_EPR_isoFit.html">eval_sim_EPR_isoFit</a>()</code>,
<code><a href="eval_sim_EPR_iso_combo.html">eval_sim_EPR_iso_combo</a>()</code>,
<code><a href="optim_for_EPR_fitness.html">optim_for_EPR_fitness</a>()</code>,
<code><a href="smooth_EPR_Spec_by_npreg.html">smooth_EPR_Spec_by_npreg</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## example with default arguments corresponding</span></span></span>
<span class="r-in"><span><span class="co">## to one simulated spectral component,</span></span></span>
<span class="r-in"><span><span class="co">## `optim.params.init` has the length</span></span></span>
<span class="r-in"><span><span class="co">## of =&gt; number of components + 1,</span></span></span>
<span class="r-in"><span><span class="co">## because of included intercept/baseline constant</span></span></span>
<span class="r-in"><span><span class="va">quant.data.sim.test.a</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">quantify_EPR_Sim_series</span><span class="op">(</span><span class="va">data.spectra.series</span>,</span></span>
<span class="r-in"><span>     dir_ASC_sim <span class="op">=</span> <span class="st">"./"</span>,</span></span>
<span class="r-in"><span>     optim.method <span class="op">=</span> <span class="st">"pswarm"</span>,</span></span>
<span class="r-in"><span>     name.pattern.sim <span class="op">=</span> <span class="st">"DHMB0_1st_04_SimA"</span>,</span></span>
<span class="r-in"><span>     optim.params.init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     output.area.stat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## similar example with two components</span></span></span>
<span class="r-in"><span><span class="co">## (simulated spectra) and tidy data frame</span></span></span>
<span class="r-in"><span><span class="co">## output (not the summarized one) with all spectra</span></span></span>
<span class="r-in"><span><span class="co">## and their corresponding integrals, additionally,</span></span></span>
<span class="r-in"><span><span class="co">## display of the iteration progress for each EPR</span></span></span>
<span class="r-in"><span><span class="co">## spectrum within the series is activated</span></span></span>
<span class="r-in"><span><span class="va">quant.data.sim.test.b</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">quantify_EPR_Sim_series</span><span class="op">(</span><span class="va">data.spectra.series</span>,</span></span>
<span class="r-in"><span>     dir_ASC_sim <span class="op">=</span> <span class="st">"./"</span>,</span></span>
<span class="r-in"><span>     optim.method <span class="op">=</span> <span class="st">"sbplx"</span>,</span></span>
<span class="r-in"><span>     name.pattern.sim <span class="op">=</span> <span class="st">"DHMB0_1st_04_Sim[[:upper:]]"</span>,</span></span>
<span class="r-in"><span>     optim.params.init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.8</span>,<span class="fl">0.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     output.area.stat <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>     eval.optim.progress <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>     <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ján Tarábek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

