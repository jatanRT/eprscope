<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Three visual diagnostic tools (based on the {ggplot2}
  and the {qqplotr} packages) and one metric (standard
  deviation of residuals) are applied to evaluate the accuracy and appropriateness as well as to compare
  different models/fits. 1. The first plot represents the Residuals vs Fitted/Simulated Values relation.
  For a decent model/fit, it will exhibit randomly scattered values around 0 and displays a similar
  variance over all predicted/fitted values. 2. Sample Quantiles vs Theoretical Quantiles (Q-Q plot)
  shows, whether the "appearence" of residuals can be described by the normal probability distribution.
  3. The latter is combined with a more detailed information about the distribution of residuals
  by the histogram (geom_histogram) as well as by the probability density
  (geom_densityincluding the residuals mean value, and median which in ideal case equal to 0).'><title>General Diagnostics for Models/Fits by Simple Residual Analysis — plot_eval_RA_forFit • eprscope</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="General Diagnostics for Models/Fits by Simple Residual Analysis — plot_eval_RA_forFit"><meta property="og:description" content='Three visual diagnostic tools (based on the {ggplot2}
  and the {qqplotr} packages) and one metric (standard
  deviation of residuals) are applied to evaluate the accuracy and appropriateness as well as to compare
  different models/fits. 1. The first plot represents the Residuals vs Fitted/Simulated Values relation.
  For a decent model/fit, it will exhibit randomly scattered values around 0 and displays a similar
  variance over all predicted/fitted values. 2. Sample Quantiles vs Theoretical Quantiles (Q-Q plot)
  shows, whether the "appearence" of residuals can be described by the normal probability distribution.
  3. The latter is combined with a more detailed information about the distribution of residuals
  by the histogram (geom_histogram) as well as by the probability density
  (geom_densityincluding the residuals mean value, and median which in ideal case equal to 0).'><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eprscope</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/datasets.html">Package Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/firstSteps.html">First Steps with R Language</a></li>
    <li><a class="dropdown-item" href="../articles/functionality.html">Basic Functionality</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jatanrt/eprscope/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>General Diagnostics for Models/Fits by Simple Residual Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/jatanrt/eprscope/blob/master/R/plot_eval_RA_forFit.R" class="external-link"><code>R/plot_eval_RA_forFit.R</code></a></small>
      <div class="d-none name"><code>plot_eval_RA_forFit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Three visual diagnostic tools (based on the <a href="https://ggplot2.tidyverse.org/" class="external-link"><code>{ggplot2}</code></a>
  and the <a href="https://aloy.github.io/qqplotr/" class="external-link"><code>{qqplotr}</code></a> packages) and one metric (standard
  deviation of residuals) are applied to evaluate the accuracy and appropriateness as well as to compare
  different models/fits. 1. The first plot represents the Residuals <em>vs</em> Fitted/Simulated Values relation.
  For a decent model/fit, it will exhibit randomly scattered values around <code>0</code> and displays a similar
  variance over all predicted/fitted values. 2. <em>Sample Quantiles vs Theoretical Quantiles</em> (Q-Q plot)
  shows, whether the "appearence" of residuals can be described by the normal probability distribution.
  3. The latter is combined with a more detailed information about the distribution of residuals
  by the <strong>histogram</strong> (<code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></code>) as well as by the <strong>probability density</strong>
  (<code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></code>including the residuals mean value, and median which in ideal case equal to <code>0</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_eval_RA_forFit</span><span class="op">(</span></span>
<span>  <span class="va">data.fit</span>,</span>
<span>  residuals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fitted <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  resid.method.smooth <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>  resid.xlab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">k</span>,</span>
<span>  level.cnfd <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-fit">data.fit<a class="anchor" aria-label="anchor" href="#arg-data-fit"></a></dt>
<dd><p>Data frame object, usually containing variables/columns like <code>experiment</code>,
<code>fit(ted)</code>/<code>predicted</code> as well as <code>residuals</code>/<code>errors</code>. If the latter is missing
(see the argument <code>residuals</code> below) one can easily create/calculate the variable/column
as a difference between the experimental and fitted/predicted values.</p></dd>


<dt id="arg-residuals">residuals<a class="anchor" aria-label="anchor" href="#arg-residuals"></a></dt>
<dd><p>Character string, pointing to variable/column header with residuals/errors, depending
on the <code>data.fit</code> argument (usually <code>residuals = "Residuals"</code> or <code>residuals = "errors"</code>).
<strong>Default</strong>: <code>residuals = NULL</code>.</p></dd>


<dt id="arg-fitted">fitted<a class="anchor" aria-label="anchor" href="#arg-fitted"></a></dt>
<dd><p>Character string, pointing to variable/column header with (model) fitted/predicted values, depending
on the <code>data.fit</code> argument (usually <code>fitted = "fit(ted)"</code>, <code>fitted = "predicted"</code>
or <code>fitted = "theory"</code>). <strong>Default</strong>: <code>fitted = NULL</code>.</p></dd>


<dt id="arg-resid-method-smooth">resid.method.smooth<a class="anchor" aria-label="anchor" href="#arg-resid-method-smooth"></a></dt>
<dd><p>Character string, corresponding to smoothing method (function) to follow
the trends of residual plot (Residuals <em>vs</em> Fitted/Predicted values).
<strong>Default</strong>: <code>resid.method.smooth = "loess"</code> ("local regression" or "locally estimated
scatter plot smoothing"). Additional methods like <code>"lm"</code> (linear method/model)
or <code>"glm"</code> can be applied as well. For details and if <code>resid.method = NULL</code> (related to automatic
method selection, based on number of points), please consult the <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></code> for documentation.</p></dd>


<dt id="arg-resid-xlab">resid.xlab<a class="anchor" aria-label="anchor" href="#arg-resid-xlab"></a></dt>
<dd><p>Character string, pointing to \(x\)-axis label for residual plot
(Residuals <em>vs</em> Fitted/Predicted values). <strong>Default</strong>: <code>resid.xlab = NULL</code>, actually
corresponding to <code>"Fitted or Simulated Values"</code>. Customized labels like <code>"Kinetic Model Fit (qvar)"</code>
or <code>"Quantity (unit)"</code> can be applied as well.</p></dd>


<dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>Logical ("standard error", <strong>default</strong>: <code>se = TRUE</code>), whether to display the confidence
interval (CI) around the smooth (inherited from the <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></code>).
The CI level is controlled by the <code>level.cnfd</code> argument.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Numeric value identical to number of parameters used for the model/fit
(see e.g. <code>Examples</code> in the <code><a href="eval_kinR_EPR_modelFit.html">eval_kinR_EPR_modelFit</a></code> where <code>k = 2</code>).</p></dd>


<dt id="arg-level-cnfd">level.cnfd<a class="anchor" aria-label="anchor" href="#arg-level-cnfd"></a></dt>
<dd><p>Numeric value, identical with the level of applied confidence interval
(see also the <code>se</code> argument). <strong>Default</strong>: <code>level.cnfd = 0.95</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A List, consisting of the following elements is returned:</p><dl><dt>df</dt>
<dd><p>Original <code>data.fit</code> data frame object, if additional processing/analysis
  is required (see the <code>Details</code> or to perform Residuals <em>vs</em> Observation Order to verify
  the assumption that the residuals are independent from one another).</p></dd>

  <dt>plot.rqq</dt>
<dd><p>Ggplot2 object related to visual <strong>r</strong>esidual
  <strong>a</strong>nalysis), with two main plots: Residuals <em>vs</em> Predicted/Fitted Values from
  the model/fit or simulation, and the Q-Q plot (Sample Quantiles <em>vs</em> Theoretical Quantiles,
  where the theoretical ones correspond to normal distribution).</p></dd>

  <dt>plot.histDens</dt>
<dd><p>Ggplot2 object, showing the <strong>hist</strong>ogram
  and the scaled probability <strong>dens</strong>ity function for residuals. The corresponding residuals
  mean value and the median are identified by vertical lines.</p></dd>

  <dt>sd</dt>
<dd><p><strong>S</strong>tandard <strong>d</strong>eviation of residuals (or residual standard error (RSE))
  for the model/fit defined as:
  $$\sqrt{\sum_i (y_i - y_{i,\text{fit/model}})^2\,/\,(N - k - 1)}$$
  where \(N\) is the number of observations/points (see the <code>data.fit</code> argument) and \(k\)
  is the number of optimized parameters (see the argument <code>k</code>). Therefore, the smaller
  the <code>sd</code>, the better the fit, when comparing different models/fits.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Analysis of residuals is a powerful statistical technique to check whether the model/fit has adequately
  captured the information in the data (please, also refer to the <code><a href="eval_ABIC_forFit.html">eval_ABIC_forFit</a></code>).
  The \(i\)-th residual/error (in the series) is defined as the difference between the \(i\)-th observed response
  value (\(y_i\)) and that of the predicted/fitted by the model (\(\hat{y}_i\) or \(y_{\text{fit/model}}\)):
  $$e_i = y_i - \hat{y}_i = y_i - y_{\text{fit/model}}$$
  One might think of residuals as "leftovers", i.e. these are the issues/items which are unexplained,
  after the model/fit has been applied. The residual analysis therefore helps us to to determine whether
  our model/fit missed an important pattern or not at all (see Chugani (2025) in the <code>References</code>).
  Residuals are also used in least square fitting/optimization procedures where the sum of their squares
  is to be minimized throughout the iterations (see e.g. <code><a href="eval_sim_EPR_isoFit.html">eval_sim_EPR_isoFit</a></code>
  or <code><a href="eval_kinR_EPR_modelFit.html">eval_kinR_EPR_modelFit</a></code>).</p>
<p>In addition to the original "raw" residuals defined above, one may come across other types,
  like <a href="https://bookdown.org/mike/data_analysis/generalized-linear-models.html" class="external-link">"Pearson" (or "scaled")</a>,
  <strong>"standardized" or "studentized"</strong>. <strong>The latter two are helpful to identify outliers</strong>,
  which are data points that are significantly different from the rest of the data
  (though, they can be also identified by the Q-Q plot and histogram-probability density).
  For such reason the "raw" residuals (\(e_i\)) are divided by their standard
  deviation (\(sd\) see the <code>Value</code> below), including the the effect of leverage.
  Thus, the formula for standardized residual reads: \(r_i = e_i\,/\,(sd\,\sqrt{1 - h_{ii}})\),
  where the \(h_{ii}\) stands for the diagonal element of the "leverage" \(\hat{H}\) matrix
  (see e.g. last three <code>References</code>). The simple explanation of the leverage phenomenon is following
  (see e.g. Speegle D, Clair B (2021) or The Pennsylvania State University (2018) in the <code>References</code>).
  The fit or the regression line goes through the center of mass of the (experimental) data (\(x\),\(y\)).
  Lets assume two points \(A\) and \(B\), where the \(A\) \(x\)-coordinate is close to the mean value
  of predictors (\(mean(x)\)) and the \(B\) possesses an extreme \(x\) (far from the mean value).
  Therefore, changing the \(A\,(y)\) will induce a small effect (low leverage) on the fit/regression line,
  whereas the \(B\,(y)\) change will dramatically influence the fit (high leverage).
  <strong>Both standardized and studentized residuals can be automatically calculated for linear models</strong> like
  <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> and <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code>, using
  the <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">stats::rstandard</a></code>
  and <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">stats::rstudent</a></code>. A very detailed analysis for linear models is provided
  by the <a href="https://goodekat.github.io/ggResidpanel/" class="external-link"><code>{ggResidpanel}</code></a> package. Additionally, a series
  of diagnostic plots can be also created in the base <em>R</em>, just by <code>plot(var)</code>, where the <code>var</code>
  represents the variable/object of the linear model. On the other hand, <strong>all these diagnostics are not
  available for non-linear models</strong> like <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></code>. Accordingly, <strong>such type of calculations
  can be provided by other packages</strong>
  (see e.g. <a href="https://cran.r-project.org/web/packages/nlstools/vignettes/vignetteJSS.pdf" class="external-link"><code>{nlstools}</code></a>)
  <strong>or must be performed "manually", evaluating the numerical approximation of the gradient</strong>
  (please, refer to the <a href="https://r-forge.r-universe.dev/numDeriv/doc/manual.html#jacobian" class="external-link">jacobian</a>)
  as reported elsewhere (see Nguyen M (2020) in the <code>References</code>). Consequently, the calculations of standardized
  and studentized residuals are not involved in this general <code>plot_eval_RA_forFit</code> function. Nevertheless, users are advised
  to apply above-described options to obtain the desired residuals or diagnostic plots for a specific model/fit
  (also refer to the <code>Value</code>/<code>df</code>).</p>
<p><strong>Considerations to support or exclude model/fit based on the residual plot.</strong> If the residuals exhibit
  no clear pattern, like they are randomly scattered around the <code>0</code> with no systematic increase or decrease
  in variance, we may trust our fit with the optimized parameters. Such pattern is <strong>homoscedastic</strong>.
  However, if one recognizes curved ((inverted-)U shape, see e.g. <code>Examples</code>
  in the <code><a href="eval_kinR_EPR_modelFit.html">eval_kinR_EPR_modelFit</a></code>), wave or systematic increase (so called "fanning")
  or decrease ("funelling"), the model/fit is untrustworthy and one would probably search for a different (better) one.
  In particular, the curved pattern in the residual plot may indicate that a model does a poor job of fitting
  and likely, we need additional parameter(s) to describe our data properly. In the case if residuals suffer
  from unequal variance at different levels of the fitted values, the residuals are referred
  to as <strong>heteroscedastic</strong>.</p>
<p><strong>Considerations to support or exclude model/fit based on the Q-Q plot, histogram and probability density.</strong>
  If the residuals are assumed to be normally distributed, one can use a normal Q-Q (Quantile-Quantile) plot
  to check this assumption or its violation. Quantiles are often referred to as "percentiles". These are actually
  the data points below which a certain portion of the data fall or in other words, they divide the distribution
  into equal portions. For instance, for a 0.5 quantile (or the 2nd quartile), half of the data lie below this
  point and half of them above. This quantile is also referred to as <strong>median</strong>. Similarly, the 0.25 quantile
  (or the 1st quartile) would mean, that \(25\,\%\) of the data fall below this point. The Q-Q plot is actually
  presenting the quantiles from our sample related to the theoretical ones calculated for the normal distribution.
  If the points follow the diagonal line (or are not far from this line), we may assume a normal
  distribution. Additionally, this assumption can be also supported either by the Shapiro-Wilk
  (<code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></code>) or by the Kolmogorov-Smirnov (<code><a href="https://rdrr.io/r/stats/ks.test.html" class="external-link">ks.test</a></code>) tests in the base R.
  Deviations from the diagonal line are also nicely reflected in the histogram and probability density
  function/graph (PDF, providing the chances that the value of a random continuous variable will
  occur within a specific range of values). For the normal symmetric distribution it is represented by the bell-shaped
  curve with the maximum at the <strong>mean</strong> (for residuals \(= 0\), median = mean). Thus, the PDF basically
  corresponds to histogram with "extremely" high number of bins, having "extremely" small widths.
  A Q-Q plot may exhibit several basic
  <a href="https://stats.libretexts.org/Bookshelves/Advanced_Statistics/Intermediate_Statistics_with_R_(Greenwood)/03%3A_One-Way_ANOVA/3.04%3A_ANOVA_model_diagnostics_including_QQ-plots" class="external-link">deviations</a>.
  It can display a U-shaped pattern, which actually mirrors
  the situation with the right skewed (or positively skewed, mean &gt; median) PDF. Therefore, we find the extreme
  values far from the peak on the high end more frequently than on the lower one (see e.g. <code>Example</code> in
  <code><a href="eval_kinR_Eyring_GHS.html">eval_kinR_Eyring_GHS</a></code>). Contrary, if the Q-Q plot shows
  "hill" shape, the opposite situation is observed and the extreme values (outliers) far from the peak
  on the low end appear more frequently than on the higher one (PDF is left skewed, mean &lt; median).
  The Q-Q plot with so-called light tails, displays extreme values above and below residual minima and maxima,
  respectively. This pattern is relatively harmless and one can proceed with methods that assume normality.
  However, the heavy-tailed Q-Q plot with extreme residuals below and above minima and maxima of the diagonal line,
  respectively, is somewhat problematic for normal distributions of residuals with outliers on both sides.
  On the other hand, such kind of normality violation can be successfully described by Student's t-distribution
  with lower degrees of freedom (see e.g. <code>Examples</code> in the <code><a href="eval_sim_EPR_isoFit.html">eval_sim_EPR_isoFit</a></code>
  as well as <code><a href="eval_ABIC_forFit.html">eval_ABIC_forFit</a></code>). Nevertheless, if the residuals, in the latter case,
  do not exhibit heteroscedasticity, such model/fit is not necessarily untrustworthy.
  In a very extreme case the heavy-tailed Q-Q plot may be transformed into situation where only a couple
  of points around the "middle" quantile can be found on the diagonal line and the remaining points are represented
  by the noticeable S-curve. This is reflected as bimodal behavior in the PDF and it might be the sign of value clustering.</p>
<p>All the above-mentioned violations of the residuals (normal) distribution can disfavor our considered model/fit.
  However, one has to perform different diagnostic methods and tests to analyze the residuals in order to compare
  several models/fits and select the "best" one. Even in such case, this should be a compromise between
  the fit accuracy (fitting the data as well as possible, including the physico-chemical reality of the system)
  and the parsimony (using a simple and replicable model/fit, Kabacoff RI (2022) in the <code>References</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kabacoff RI (2022). <em>R in Action</em>, 3rd edition, Manning Publications Co., ISBN 978-1-617-29605-5,
  <a href="https://www.manning.com/books/r-in-action-third-edition" class="external-link">https://www.manning.com/books/r-in-action-third-edition</a>.</p>
<p>Svetunkov I (2022). <em>Statistics for Business Analytics</em>, Version 2025,
  <a href="https://openforecast.org/sba/" class="external-link">https://openforecast.org/sba/</a>.</p>
<p>Hyndman RJ, Athanasopoulos G (2021). <em>Forecasting: Principles and Practise</em>, 3rd edition,
  O Texts, ISBN 978-0-987-50713-6, <a href="https://otexts.com/fpp3/" class="external-link">https://otexts.com/fpp3/</a>.</p>
<p>Chugani V (2025). "The Concise Guide to Residual Analysis",
  <a href="https://www.statology.org/concise-guide-residual-analysis/" class="external-link">https://www.statology.org/concise-guide-residual-analysis/</a>.</p>
<p>Boehmke B, Greenwell B (2020). <em>Hand on Machine Learning with R</em>, 1st edition, Chapman and Hall/CRC,
  ISBN 978-1-138-49568-5, <a href="https://bradleyboehmke.github.io/HOML/" class="external-link">https://bradleyboehmke.github.io/HOML/</a>.</p>
<p>Kuhn M, Silge J (2023). <em>Tidy Modelling with R</em>, 1st edition (Version 1.0.0), O'Reilly Media,
  ISBN 978-1-492-09648-1, <a href="https://www.tmwr.org/" class="external-link">https://www.tmwr.org/</a>.</p>
<p>Belzile L (2019). "lineaRmodels", <a href="https://lbelzile.github.io/lineaRmodels/" class="external-link">https://lbelzile.github.io/lineaRmodels/</a></p>
<p>James G, Witten D, Hastie T, Tibshirani R (2021). <em>An Introduction to Statistical Learning:
  with Applications in R</em>, 2nd edition, Springer, ISBN 978-1-071-61417-4,
  <a href="https://www.statlearning.com/" class="external-link">https://www.statlearning.com/</a>.</p>
<p>Speegle D, Clair B (2021). <em>Probability, Statistics and Data: A Fresh Approach Using R</em>,
  1st edition (Version 2024), Chapman and Hall/CRC, ISBN 978-0-367-43667-4,
  <a href="https://probstatsdata.com/" class="external-link">https://probstatsdata.com/</a>.</p>
<p>The Pennsylvania State University (2018). "STAT 462 Applied Regression Analysis, Lesson 9: Influential Points",
  <a href="https://online.stat.psu.edu/stat462/node/87/" class="external-link">https://online.stat.psu.edu/stat462/node/87/</a>.</p>
<p>Nguyen M (2020). "A Guide on Data Analysis", <a href="https://bookdown.org/mike/data_analysis/" class="external-link">https://bookdown.org/mike/data_analysis/</a>.</p>
<p>Gray JB, Woodal WH (1994). "The Maximum Size of Standardized and Internally Studentized Residuals in Regression Analysis",
  <em>Am. Stat.</em>, <strong>48</strong>(2), 111-113, <a href="https://www.jstor.org/stable/2684258" class="external-link">https://www.jstor.org/stable/2684258</a></p>
<p>Frost J (2025). "Statistics by Jim: Making Statistics Intuitive", <a href="https://statisticsbyjim.com/" class="external-link">https://statisticsbyjim.com/</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Simulations and Optimization:
<code><a href="eval_ABIC_forFit.html">eval_ABIC_forFit</a>()</code>,
<code><a href="eval_sim_EPR_iso.html">eval_sim_EPR_iso</a>()</code>,
<code><a href="eval_sim_EPR_isoFit.html">eval_sim_EPR_isoFit</a>()</code>,
<code><a href="eval_sim_EPR_isoFit_space.html">eval_sim_EPR_isoFit_space</a>()</code>,
<code><a href="eval_sim_EPR_iso_combo.html">eval_sim_EPR_iso_combo</a>()</code>,
<code><a href="optim_for_EPR_fitness.html">optim_for_EPR_fitness</a>()</code>,
<code><a href="quantify_EPR_Sim_series.html">quantify_EPR_Sim_series</a>()</code>,
<code><a href="smooth_EPR_Spec_by_npreg.html">smooth_EPR_Spec_by_npreg</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## application example for an EPR simulation fit</span></span></span>
<span class="r-in"><span><span class="va">list.test</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_eval_RA_forFit</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data.fit <span class="op">=</span> <span class="va">data.sim.expr</span>,</span></span>
<span class="r-in"><span>    residuals <span class="op">=</span> <span class="st">"Residuals"</span>,</span></span>
<span class="r-in"><span>    fitted <span class="op">=</span> <span class="st">"Simulation"</span>,</span></span>
<span class="r-in"><span>    resid.xlab <span class="op">=</span> <span class="st">"Simulation"</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">optim.params.init</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    level.cnfd <span class="op">=</span> <span class="fl">0.99999999</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## residual and the normal Q-Q plot</span></span></span>
<span class="r-in"><span><span class="va">list.test</span><span class="op">$</span><span class="va">plot.rqq</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## histogram and probability density</span></span></span>
<span class="r-in"><span><span class="va">list.test</span><span class="op">$</span><span class="va">plot.histDens</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## standard deviation of residuals</span></span></span>
<span class="r-in"><span><span class="va">list.test</span><span class="op">$</span><span class="va">sd</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## from the data, quickly create the residuals vs</span></span></span>
<span class="r-in"><span><span class="co">## observation order plot (assuming, there</span></span></span>
<span class="r-in"><span><span class="co">## is no index column in the data frame)</span></span></span>
<span class="r-in"><span><span class="va">dataframe</span> <span class="op">&lt;-</span> <span class="va">list.test</span><span class="op">$</span><span class="va">df</span></span></span>
<span class="r-in"><span><span class="va">dataframe</span><span class="op">[[</span><span class="st">"index"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dataframe</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">dataframe</span><span class="op">$</span><span class="va">index</span>,</span></span>
<span class="r-in"><span>  <span class="va">dataframe</span><span class="op">$</span><span class="va">Residuals</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Observation Order"</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">"Residuals"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## for additional applications, please,</span></span></span>
<span class="r-in"><span><span class="co">## refer to the `eval_sim_EPR_isoFit`</span></span></span>
<span class="r-in"><span><span class="co">## or `eval_kinR_EPR_modelFit`</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ján Tarábek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

