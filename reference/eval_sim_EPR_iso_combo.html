<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='This is an extension of the "basic" EPR simulation provided by the eval_sim_EPR_iso function,
  where one can combine several simulated EPR spectra (components), even with (partial) overlay,
  into one spectrum corresponding to sum of all those components. Such processing might be useful for the simulation
  of EPR spectra with satellites, especially of those consisted of naturally occurring
  isotopes, like the one presented in Examples.'><title>Simulation of Isotropic EPR Spectra Consisting of Several Components — eval_sim_EPR_iso_combo • eprscope</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Simulation of Isotropic EPR Spectra Consisting of Several Components — eval_sim_EPR_iso_combo"><meta property="og:description" content='This is an extension of the "basic" EPR simulation provided by the eval_sim_EPR_iso function,
  where one can combine several simulated EPR spectra (components), even with (partial) overlay,
  into one spectrum corresponding to sum of all those components. Such processing might be useful for the simulation
  of EPR spectra with satellites, especially of those consisted of naturally occurring
  isotopes, like the one presented in Examples.'><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eprscope</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.15</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/datasets.html">Package Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/firstSteps.html">First Steps with R Language</a></li>
    <li><a class="dropdown-item" href="../articles/functionality.html">Basic Functionality</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jatanrt/eprscope/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulation of Isotropic EPR Spectra Consisting of Several Components</h1>
      <small class="dont-index">Source: <a href="https://github.com/jatanrt/eprscope/blob/master/R/eval_sim_EPR_iso_combo.R" class="external-link"><code>R/eval_sim_EPR_iso_combo.R</code></a></small>
      <div class="d-none name"><code>eval_sim_EPR_iso_combo.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is an extension of the "basic" EPR simulation provided by the <code><a href="eval_sim_EPR_iso.html">eval_sim_EPR_iso</a></code> function,
  where one can combine several simulated EPR spectra (components), even with (partial) overlay,
  into one spectrum corresponding to sum of all those components. Such processing might be useful for the simulation
  of EPR spectra with satellites, especially of those consisted of naturally occurring
  isotopes, like the one presented in <code>Examples</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eval_sim_EPR_iso_combo</span><span class="op">(</span></span>
<span>  <span class="va">g.iso.vec</span>,</span>
<span>  instrum.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Bcf <span class="op">=</span> <span class="fl">3500</span>, Bsw <span class="op">=</span> <span class="fl">200</span>, Npoints <span class="op">=</span> <span class="fl">2048</span>, mwGHz <span class="op">=</span> <span class="fl">9.8</span><span class="op">)</span>,</span>
<span>  B.unit <span class="op">=</span> <span class="st">"G"</span>,</span>
<span>  path_to_dsc_par <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  origin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">nuclear.system</span>,</span>
<span>  <span class="va">natur.abund.vec</span>,</span>
<span>  lineSpecs.form <span class="op">=</span> <span class="st">"derivative"</span>,</span>
<span>  <span class="va">lineGL.DeltaB</span>,</span>
<span>  <span class="va">lineG.content.vec</span>,</span>
<span>  Intensity.sim <span class="op">=</span> <span class="st">"dIeprSim_over_dB"</span>,</span>
<span>  <span class="va">Intensity.sim.coeffs.vec</span>,</span>
<span>  plot.sim.interact <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-g-iso-vec">g.iso.vec<a class="anchor" aria-label="anchor" href="#arg-g-iso-vec"></a></dt>
<dd><p>Numeric vector with all \(g_{\text{iso}}\) values fro each component.</p></dd>


<dt id="arg-instrum-params">instrum.params<a class="anchor" aria-label="anchor" href="#arg-instrum-params"></a></dt>
<dd><p>Named numeric vector, containing instrumental parameters required
for the simulation =&gt;</p><table class="table table"><tr><td><code>Bcf</code></td><td>"central field" (magnetic flux density, \(B_{\text{CF}}\))</td></tr><tr><td><code>Bsw</code></td><td>"sweep width" (magnetic flux density recording region,
\(B_{\text{SW}}\))</td></tr><tr><td><code>Npoints</code></td><td>number of spectral points (corresponding to resolution) within
the "sweep width"</td></tr><tr><td><code>mwGHz</code></td><td>applied microwave frequency in <code>GHz</code> to record the continuous wave (CW)
EPR spectrum</td></tr></table><p><strong>Default</strong> values are chosen to cover the EPR spectra of common organic radicals.
If <code>instrum.params = NULL</code> then parameters must be provided by the <code>path_to_dsc_par</code>
as well as by <code>origin</code> arguments.</p></dd>


<dt id="arg-b-unit">B.unit<a class="anchor" aria-label="anchor" href="#arg-b-unit"></a></dt>
<dd><p>Character string, pointing to unit of magnetic flux density which is to be presented
on \(B\)-axis of the EPR spectrum, like <code>"G"</code> (Gauss), <code>"mT"</code> (millitesla) or <code>"T"</code> (tesla),
<strong>default</strong>: <code>B.unit = "G"</code>. THE UNIT MUST BE SHARED ACROSS ALL RELEVANT B-ARGUMENTS
like <code>cf</code> and <code>sw</code> within the <code>instrum.params</code> AS WELL AS within THOSE IN <code>lineGL.DeltaB</code> !</p></dd>


<dt id="arg-path-to-dsc-par">path_to_dsc_par<a class="anchor" aria-label="anchor" href="#arg-path-to-dsc-par"></a></dt>
<dd><p>Character string, path (can be also acquired by the <code><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></code>)
to <code>.DSC/.dsc</code> or <code>.par</code> (depending on the OS, see <code>origin</code> argument)
<code>text</code> files including all instrumental parameters from the EPR machine.
<strong>Default</strong>: <code>path_to_dsc_par = NULL</code> in case if the <code>instrum.params</code>
is already defined. IF the <code>instrum.params = NULL</code> then BOTH the <code>path_to_dsc_par</code>
AS WELL AS the <code>origin</code> MUST BE DEFINED !</p></dd>


<dt id="arg-origin">origin<a class="anchor" aria-label="anchor" href="#arg-origin"></a></dt>
<dd><p>Character string, corresponding to software which was used to obtain the EPR spectra
on spectrometers, because the files are slightly different, whether they
were recorded by the "WinEpr" (<code>origin = "winepr"</code>) or by the "Xenon".
<strong>Default</strong>: <code>origin = NULL</code> in case no file is used to extract
the parameters (i.e. exactly if <code>path_to_dsc_par = NULL</code>).</p></dd>


<dt id="arg-nuclear-system">nuclear.system<a class="anchor" aria-label="anchor" href="#arg-nuclear-system"></a></dt>
<dd><p>Nested list with the elements corresponding to considered interacting nuclei for each EPR
spectral component. For example, the <code>list(list("1H",2,24),NULL,list(list("14N",1,45),list("1H",4,15)))</code>
refers to the following components: 1. \(2\times A(\text{1H}) = 24\,\text{MHz}\), 2. single line spectrum
without HF structure, 3. \(1\times A(\text{14N}) = 45\,\text{MHz} + 4\times A(\text{1H}) = 15\,\text{MHz}\).</p></dd>


<dt id="arg-natur-abund-vec">natur.abund.vec<a class="anchor" aria-label="anchor" href="#arg-natur-abund-vec"></a></dt>
<dd><p>Logical vector, whether to consider natural abundance of the interacting nuclei within
the components (see also <code>Examples</code>) like <code>c(TRUE,FALSE,TRUE)</code>.</p></dd>


<dt id="arg-linespecs-form">lineSpecs.form<a class="anchor" aria-label="anchor" href="#arg-linespecs-form"></a></dt>
<dd><p>Character string, describing either <code>"derivative"</code> (<strong>default</strong>)
or <code>"integrated"</code> (i.e. <code>"absorption"</code> which can be used as well) line form
of the analyzed EPR spectrum/data.</p></dd>


<dt id="arg-linegl-deltab">lineGL.DeltaB<a class="anchor" aria-label="anchor" href="#arg-linegl-deltab"></a></dt>
<dd><p>Nested list of the Gaussian and Lorentzian linewidths for all individual components
like <code>list(list(1,NULL),list(3,NULL),list(1,NULL))</code>.</p></dd>


<dt id="arg-lineg-content-vec">lineG.content.vec<a class="anchor" aria-label="anchor" href="#arg-lineg-content-vec"></a></dt>
<dd><p>Numeric vector, corresponding to Gaussian line content for all individual components
of the EPR spectrum like <code>1,1,1</code> (all spectral components are described by the pure Gaussian line).</p></dd>


<dt id="arg-intensity-sim">Intensity.sim<a class="anchor" aria-label="anchor" href="#arg-intensity-sim"></a></dt>
<dd><p>Character string, pointing to column of simulated EPR intensity within the related output
data frame. <strong>Default</strong>: <code>Intensity.sim = "dIeprSim_over_dB"</code>.</p></dd>


<dt id="arg-intensity-sim-coeffs-vec">Intensity.sim.coeffs.vec<a class="anchor" aria-label="anchor" href="#arg-intensity-sim-coeffs-vec"></a></dt>
<dd><p>Numeric vector of multiplication coefficients related to EPR component intensities
like <code>c(2,10,0.2)</code>.</p></dd>


<dt id="arg-plot-sim-interact">plot.sim.interact<a class="anchor" aria-label="anchor" href="#arg-plot-sim-interact"></a></dt>
<dd><p>Character string, indicating the interactive plot outputs, to visualize either individual
<code>"components"</code> or <code>"sum"</code> of all components. As <strong>default</strong>, the interactive plot is switched
off (<code>plot.sim.interact = NULL</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List of the following data frames and plots in case of
  <code>plot.sim.interact = NULL</code> =&gt;</p><dl><dt>df</dt>
<dd><p>Long-format data frame with the simulated EPR spectral components A, B, C, ...
    (e.g. representing the individual radicals) as a categorical variable
    + magnetic flux density, intensity as well as their sigmoid integral
    column/variable.</p></dd>

    <dt>df.areas</dt>
<dd><p>Data frame with simulation components A, B, C ...and their
    corresponding double/single integrals (or <code>areas</code>) and their relative ratios
    to overall integral sum (<code>weighted_areas</code>).</p></dd>

    <dt>df.sum</dt>
<dd><p>Data frame with the overall intensity (+ magnetic flux density)
    as well as integral sum from all simulation components.</p></dd>

    <dt>plot.comps</dt>
<dd><p>Overlay plot object with all simulated components with their
    corresponding intensities defined by <code>Intensity.sim.coeffs.vec</code>.</p></dd>

    <dt>plot.sum</dt>
<dd><p>Plot object displaying the sum of all simulation components.</p></dd>


</dl><p>If <code>plot.sim.interact</code> is activated (i.e. possesses either <code>"components"</code>
  or <code>"sum"</code> values) interactive plots (based on <code>plotly</code>) are presented either with
  all individual components or with the overall simulated EPR spectrum sum, respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Simulations and Optimization:
<code><a href="eval_ABIC_forFit.html">eval_ABIC_forFit()</a></code>,
<code><a href="eval_sim_EPR_iso.html">eval_sim_EPR_iso()</a></code>,
<code><a href="eval_sim_EPR_isoFit.html">eval_sim_EPR_isoFit()</a></code>,
<code><a href="eval_sim_EPR_isoFit_space.html">eval_sim_EPR_isoFit_space()</a></code>,
<code><a href="optim_for_EPR_fitness.html">optim_for_EPR_fitness()</a></code>,
<code><a href="plot_eval_EPRtheo_mltiplet.html">plot_eval_EPRtheo_mltiplet()</a></code>,
<code><a href="plot_eval_RA_forFit.html">plot_eval_RA_forFit()</a></code>,
<code><a href="quantify_EPR_Sim_series.html">quantify_EPR_Sim_series()</a></code>,
<code><a href="smooth_EPR_Spec_by_npreg.html">smooth_EPR_Spec_by_npreg()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Simulation of EPR spectrum of TEMPO (aminoxyl)</span></span></span>
<span class="r-in"><span><span class="co">## radical with 13C satellites and hyperfine coupling</span></span></span>
<span class="r-in"><span><span class="co">## constants A(1 x 14N) = 48 MHz, A(1 x 13C) = 18.2 MHz,</span></span></span>
<span class="r-in"><span><span class="co">## the latter 13C may appear on 4 different</span></span></span>
<span class="r-in"><span><span class="co">## positions (methyl carbons) =&gt; therefore the overall</span></span></span>
<span class="r-in"><span><span class="co">## probability to find it at any position is</span></span></span>
<span class="r-in"><span><span class="co">## approx. 4,4% (1.1% per one 13C), the additional</span></span></span>
<span class="r-in"><span><span class="co">## two quaternary α-Carbons are not considered</span></span></span>
<span class="r-in"><span><span class="co">## see e.g. https://doi.org/10.1016/j.mencom.2014.09.018</span></span></span>
<span class="r-in"><span><span class="va">sim.tempo.13c</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="fu">eval_sim_EPR_iso_combo</span><span class="op">(</span></span></span>
<span class="r-in"><span>  g.iso.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.0059</span>,<span class="fl">2.0059</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  nuclear.system <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"14N"</span>,<span class="fl">1</span>,<span class="fl">48</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"14N"</span>,<span class="fl">1</span>,<span class="fl">48</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"13C"</span>,<span class="fl">1</span>,<span class="fl">18.2</span><span class="op">)</span></span></span>
<span class="r-in"><span>                            <span class="op">)</span></span></span>
<span class="r-in"><span>                       <span class="op">)</span>,</span></span>
<span class="r-in"><span>  natur.abund.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lineGL.DeltaB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1.3</span>,<span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1.3</span>,<span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span>                      <span class="op">)</span>,</span></span>
<span class="r-in"><span>  lineG.content.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Intensity.sim.coeffs.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.956</span><span class="op">/</span><span class="fl">3</span>,<span class="fl">0.044</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## simulated spectrum/plot:</span></span></span>
<span class="r-in"><span><span class="va">sim.tempo.13c</span><span class="op">$</span><span class="va">plot.sum</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3425</span>,<span class="fl">3550</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="eval_sim_EPR_iso_combo-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## ...and the corresponding data frame:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>pillar.sigfig <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co">## prevent rounding</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">tempo.df.sum</span> <span class="op">&lt;-</span> <span class="va">sim.tempo.13c</span><span class="op">$</span><span class="va">df.sum</span></span></span>
<span class="r-in"><span><span class="va">tempo.df.sum</span><span class="op">[</span><span class="fl">1000</span><span class="op">:</span><span class="fl">1005</span>, <span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Bsim_mT Bsim_G Sim_sigmoid_Integ dIeprSim_over_dB_Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  349.76 <span style="text-decoration: underline;">3</span>497.6            2.045<span style="text-decoration: underline;">0</span>          -<span style="color: #BB0000;">4.310</span><span style="color: #BB0000; text-decoration: underline;">4</span><span style="color: #949494;">e</span><span style="color: #BB0000;">- 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>  349.77 <span style="text-decoration: underline;">3</span>497.7            2.045<span style="text-decoration: underline;">0</span>          -<span style="color: #BB0000;">1.806</span><span style="color: #BB0000; text-decoration: underline;">4</span><span style="color: #949494;">e</span><span style="color: #BB0000;">- 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>  349.78 <span style="text-decoration: underline;">3</span>497.8            2.045<span style="text-decoration: underline;">0</span>          -<span style="color: #BB0000;">7.395</span><span style="color: #BB0000; text-decoration: underline;">2</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>  349.79 <span style="text-decoration: underline;">3</span>497.9            2.045<span style="text-decoration: underline;">0</span>          -<span style="color: #BB0000;">2.985</span><span style="color: #BB0000; text-decoration: underline;">9</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>  349.80 <span style="text-decoration: underline;">3</span>498.0            2.045<span style="text-decoration: underline;">0</span>          -<span style="color: #BB0000;">1.167</span><span style="color: #BB0000; text-decoration: underline;">0</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>  349.81 <span style="text-decoration: underline;">3</span>498.1            2.045<span style="text-decoration: underline;">0</span>          -<span style="color: #BB0000;">4.456</span><span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## data frame with all components:</span></span></span>
<span class="r-in"><span><span class="va">sim.tempo.13c</span><span class="op">$</span><span class="va">df</span><span class="op">[</span><span class="fl">1000</span><span class="op">:</span><span class="fl">1005</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   Sim_Components [1]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sim_Components Bsim_G Bsim_mT  Bsim_T dIeprSim_over_dB Sim_sigmoid_Integs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> A              <span style="text-decoration: underline;">3</span>497.6  349.76 0.349<span style="text-decoration: underline;">76</span>      -<span style="color: #BB0000;">3.718</span><span style="color: #BB0000; text-decoration: underline;">0</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-25</span>             1.955<span style="text-decoration: underline;">0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> A              <span style="text-decoration: underline;">3</span>497.7  349.77 0.349<span style="text-decoration: underline;">77</span>      -<span style="color: #BB0000;">7.291</span><span style="color: #BB0000; text-decoration: underline;">4</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-26</span>             1.955<span style="text-decoration: underline;">0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> A              <span style="text-decoration: underline;">3</span>497.8  349.78 0.349<span style="text-decoration: underline;">78</span>      -<span style="color: #BB0000;">1.397</span><span style="color: #BB0000; text-decoration: underline;">5</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-26</span>             1.955<span style="text-decoration: underline;">0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> A              <span style="text-decoration: underline;">3</span>497.9  349.79 0.349<span style="text-decoration: underline;">79</span>      -<span style="color: #BB0000;">2.663</span><span style="color: #BB0000; text-decoration: underline;">3</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-27</span>             1.955<span style="text-decoration: underline;">0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> A              <span style="text-decoration: underline;">3</span>498.0  349.80 0.349<span style="text-decoration: underline;">80</span>      -<span style="color: #BB0000;">4.877</span><span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-28</span>             1.955<span style="text-decoration: underline;">0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> A              <span style="text-decoration: underline;">3</span>498.1  349.81 0.349<span style="text-decoration: underline;">81</span>      -<span style="color: #BB0000;">8.728</span><span style="color: #BB0000; text-decoration: underline;">9</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-29</span>             1.955<span style="text-decoration: underline;">0</span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## areas/integrals</span></span></span>
<span class="r-in"><span><span class="va">sim.tempo.13c</span><span class="op">$</span><span class="va">df.areas</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sim_Components Sim_areas weighted_Sim_areas</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> A                2.932<span style="text-decoration: underline;">7</span>            0.956<span style="text-decoration: underline;">00</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> B                0.134<span style="text-decoration: underline;">97</span>           0.043<span style="text-decoration: underline;">999</span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## Simulation of BMPO spin trap *OH radical</span></span></span>
<span class="r-in"><span><span class="co">## adduct consisting of two diasteromers (A,B),</span></span></span>
<span class="r-in"><span><span class="co">## see at https://doi.org/10.1016/S0891-5849(01)00619-0</span></span></span>
<span class="r-in"><span><span class="va">sim.hobmpo.spec</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">eval_sim_EPR_iso_combo</span><span class="op">(</span></span></span>
<span class="r-in"><span>    g.iso.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.005</span>,<span class="fl">2.005</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    nuclear.system <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"14N"</span>,<span class="fl">1</span>,<span class="fl">38.06</span><span class="op">)</span>,<span class="co"># 13.6 G )</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"1H"</span>,<span class="fl">1</span>,<span class="fl">34.52</span><span class="op">)</span>, <span class="co"># 12.3 G  &gt; DIASTEROMER A, 81.6 %</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"1H"</span>,<span class="fl">1</span>,<span class="fl">1.85</span><span class="op">)</span>   <span class="co"># 0.70 G )</span></span></span>
<span class="r-in"><span>      <span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"14N"</span>,<span class="fl">1</span>,<span class="fl">37.8</span><span class="op">)</span>,<span class="co"># 13.5 G )</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"1H"</span>,<span class="fl">1</span>,<span class="fl">42.96</span><span class="op">)</span>,<span class="co"># 15.3 G  &gt; DIASTEROMER B, 18.4 %</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"1H"</span>,<span class="fl">1</span>,<span class="fl">1.74</span><span class="op">)</span>  <span class="co"># 0.60 G )</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    natur.abund.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    lineGL.DeltaB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1.05</span>,<span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1.05</span>,<span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    lineG.content.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Intensity.sim.coeffs.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.816</span>,<span class="fl">0.184</span><span class="op">)</span> <span class="co"># 81.6 % + 18.4 %</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## preview of both components and the overall EPR simulation,</span></span></span>
<span class="r-in"><span><span class="co">## using the `{patchwork}` R package,</span></span></span>
<span class="r-in"><span><span class="co">## see also at https://patchwork.data-imaginist.com/</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">sim.hobmpo.spec</span><span class="op">$</span><span class="va">plot.sum</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3420</span>,<span class="fl">3560</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">sim.hobmpo.spec</span><span class="op">$</span><span class="va">plot.comps</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3420</span>,<span class="fl">3560</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">+</span> <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span>,axis_titles <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="eval_sim_EPR_iso_combo-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">## ...and the corresponding areas/integrals</span></span></span>
<span class="r-in"><span><span class="va">sim.hobmpo.spec</span><span class="op">$</span><span class="va">df.areas</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sim_Components Sim_areas weighted_Sim_areas</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> A                0.812<span style="text-decoration: underline;">83</span>            0.816<span style="text-decoration: underline;">00</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> B                0.183<span style="text-decoration: underline;">28</span>            0.184<span style="text-decoration: underline;">00</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ján Tarábek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

